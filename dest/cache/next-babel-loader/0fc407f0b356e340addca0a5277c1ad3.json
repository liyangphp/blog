{"ast":null,"code":"import _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _message from \"antd/lib/message\";\nimport _Menu from \"antd/lib/menu\";\nimport _Layout from \"antd/lib/layout\";\nvar __jsx = React.createElement;\nimport React, { useEffect, useState } from 'react';\nimport BaseView from '../components/BaseView';\nimport Security from '../components/Security';\nimport axios from \"axios\";\nimport BindingView from \"../components/BindingView\";\nvar Content = _Layout.Content;\nvar Item = _Menu.Item;\n\nvar Set = function Set() {\n  var _useState = useState(),\n      user = _useState[0],\n      setUser = _useState[1];\n\n  var _useState2 = useState(true),\n      isLoading = _useState2[0],\n      setIsLoading = _useState2[1];\n\n  var menuMap = {\n    base: \"基本设置\",\n    security: \"安全设置\",\n    binding: \"账号绑定\",\n    notification: \"消息通知\"\n  }; //获取会员数据\n\n  var checkLogin = function checkLogin(token) {\n    var CancelToken = axios.CancelToken;\n    var source = CancelToken.source();\n\n    if (token) {\n      axios({\n        method: 'get',\n        url: servicePath.getUserInfo,\n        headers: {\n          'Authorization': 'Bearer ' + token\n        },\n        withCredentials: false,\n        cancelToken: source.token,\n        transformResponse: function transformResponse(data) {\n          console.log('data', data);\n\n          if (data.indexOf('errors') != -1) {\n            data = JSON.parse(data);\n\n            for (var item in data.errors) {\n              _message.error(data.errors[item][0]);\n            }\n          } else if (data.indexOf('Unauthenticated') != -1) {\n            localStorage.removeItem('token');\n            localStorage.removeItem('user_id');\n\n            _message.error('登录已过期，请重新登录');\n\n            Router.push('/login');\n          } else {\n            return data;\n          }\n        }\n      }).then(function (res) {\n        source.cancel('方法被取消');\n        setIsLoading(false);\n        console.log('user123', res.data);\n        res.data = eval('(' + res.data + ')');\n        console.log('user1', res.data.data);\n\n        if (!localStorage.getItem('user_id') || localStorage.getItem('user_id') != res.data.data.id) {\n          Router.push('/login');\n        } else {\n          setUser(res.data.data);\n        }\n      })[\"catch\"](function (error) {\n        console.log(error);\n      });\n    } else {\n      console.log('asasdas3');\n    }\n  };\n\n  var mode = 'inline';\n\n  var _useState3 = useState('base'),\n      selectKey = _useState3[0],\n      setSelectKey = _useState3[1];\n\n  var getRightTitle = function getRightTitle() {\n    return menuMap[selectKey];\n  };\n\n  var renderChildren = function renderChildren() {\n    switch (selectKey) {\n      case 'base':\n        return __jsx(BaseView, null);\n\n      case 'security':\n        return __jsx(Security, null);\n\n      case 'binding':\n        return __jsx(BindingView, null);\n\n      default:\n        break;\n    }\n\n    return null;\n  };\n\n  var getMenu = function getMenu() {\n    return _Object$keys(menuMap).map(function (item) {\n      return __jsx(Item, {\n        key: item\n      }, menuMap[item]);\n    });\n  };\n\n  useEffect(function () {\n    checkLogin(localStorage.getItem('token'));\n  }, []);\n  return __jsx(Content, {\n    className: \"main\",\n    style: {\n      margin: '2rem auto'\n    }\n  }, __jsx(\"div\", {\n    className: \"leftMenu\"\n  }, __jsx(_Menu, {\n    mode: mode,\n    selectedKeys: [selectKey],\n    onClick: function onClick(_ref) {\n      var key = _ref.key;\n      return setSelectKey(key);\n    }\n  }, getMenu())), __jsx(\"div\", {\n    className: \"right\"\n  }, __jsx(\"div\", {\n    className: \"title\"\n  }, getRightTitle()), renderChildren()));\n};\n\nexport default Set;","map":{"version":3,"sources":["/Users/mac/Desktop/liy-blog/pages/set.js"],"names":["React","useEffect","useState","BaseView","Security","axios","BindingView","Content","Item","Set","user","setUser","isLoading","setIsLoading","menuMap","base","security","binding","notification","checkLogin","token","CancelToken","source","method","url","servicePath","getUserInfo","headers","withCredentials","cancelToken","transformResponse","data","console","log","indexOf","JSON","parse","item","errors","error","localStorage","removeItem","Router","push","then","res","cancel","eval","getItem","id","mode","selectKey","setSelectKey","getRightTitle","renderChildren","getMenu","map","margin","key"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { Layout, Menu, message, Row } from 'antd';\nimport BaseView from '../components/BaseView'\nimport Security from '../components/Security'\nimport axios from \"axios\";\nimport BindingView from \"../components/BindingView\";\nconst { Content } = Layout;\nconst { Item } = Menu;\n\nconst Set = () => {\n    const [user, setUser] = useState()\n    const [isLoading, setIsLoading] = useState(true)\n    const menuMap = {\n        base: \"基本设置\",\n        security: \"安全设置\",\n        binding: \"账号绑定\",\n        notification: \"消息通知\",\n    };\n\n    //获取会员数据\n    const checkLogin = (token) => {\n        const CancelToken = axios.CancelToken;\n        const source = CancelToken.source();\n        if (token) {\n            axios({\n                method: 'get',\n                url: servicePath.getUserInfo,\n                headers: {\n                    'Authorization': 'Bearer ' + token,\n                },\n                withCredentials: false,\n                cancelToken: source.token,\n                transformResponse: function (data) {\n                    console.log('data', data)\n                    if (data.indexOf('errors') != -1) {\n                        data = JSON.parse(data);\n                        for (var item in data.errors) {\n                            message.error(data.errors[item][0]);\n                        }\n                    } else if (data.indexOf('Unauthenticated') != -1) {\n                        localStorage.removeItem('token')\n                        localStorage.removeItem('user_id')\n                        message.error('登录已过期，请重新登录');\n                        Router.push('/login')\n                    } else {\n                        return data;\n                    }\n                }\n            }).then(\n                res => {\n                    source.cancel('方法被取消');\n                    setIsLoading(false)\n                    console.log('user123', res.data)\n                    res.data = eval('(' + res.data + ')');\n                    console.log('user1', res.data.data)\n                    if (!localStorage.getItem('user_id') || localStorage.getItem('user_id') != res.data.data.id) {\n                        Router.push('/login');\n                    } else {\n                        setUser(res.data.data);\n                    }\n\n                }\n            ).catch(function (error) {\n                console.log(error)\n            });\n        } else {\n            console.log('asasdas3')\n        }\n    }\n\n\n    const mode = 'inline';\n\n    const [selectKey, setSelectKey] = useState('base');\n\n    const getRightTitle = () => {\n        return menuMap[selectKey];\n    };\n\n    const renderChildren = () => {\n        switch (selectKey) {\n            case 'base':\n                return <BaseView />;\n            case 'security':\n                return <Security />;\n            case 'binding':\n                return <BindingView />;\n            default:\n                break;\n        }\n        return null;\n    };\n\n    const getMenu = () => {\n        return Object.keys(menuMap).map(item => <Item key={item}>{menuMap[item]}</Item>);\n    };\n\n    useEffect(() => {\n        checkLogin(localStorage.getItem('token'))\n    },[])\n\n\n    return (\n        <Content className=\"main\" style={{ margin: '2rem auto' }}>\n            <div className=\"leftMenu\">\n                <Menu\n                    mode={mode}\n                    selectedKeys={[selectKey]}\n                    onClick={({ key }) => setSelectKey(key)}>\n                    {getMenu()}\n                </Menu>\n            </div>\n            <div className=\"right\">\n                <div className=\"title\">{getRightTitle()}</div>\n                {renderChildren()}\n            </div>\n        </Content>\n    )\n}\n\n\nexport default Set\n"]},"metadata":{},"sourceType":"module"}