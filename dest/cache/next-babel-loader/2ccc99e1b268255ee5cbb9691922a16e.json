{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _Modal from \"antd/lib/modal\";\nimport _Icon from \"antd/lib/icon\";\nimport _BackTop from \"antd/lib/back-top\";\nimport _Button from \"antd/lib/button\";\nimport _Row from \"antd/lib/row\";\nimport _Col from \"antd/lib/col\";\nimport _message from \"antd/lib/message\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _Input from \"antd/lib/input\";\nimport _Select from \"antd/lib/select\";\nimport _Layout from \"antd/lib/layout\";\nimport _Upload from \"antd/lib/upload\";\nvar __jsx = React.createElement;\n// import dynamic from 'next/dynamic'\n// const Createoredit = dynamic(\n//     import('../components/createoredit'),\n//     {\n//         ssr: false   //这个要加上,禁止使用 SSR\n//     }\n// )\n// export default () => <Createoredit />\nimport React, { useState, useEffect, createContext, useMemo } from 'react';\nimport marked from 'marked';\nimport axios from 'axios';\nimport \"easymde/dist/easymde.min.css\";\nimport Head from 'next/head';\nimport servicePath from '../config/apiUrl';\nimport Router from 'next/router';\nimport dynamic from 'next/dynamic';\nexport var FmtContext = createContext({});\nvar Dragger = _Upload.Dragger;\nvar UploadImage = dynamic(function () {\n  return import(\"../components/UploadImage\");\n}, {\n  ssr: false //这个要加上,禁止使用 SSR\n  ,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak(\"../components/UploadImage\")];\n    },\n    modules: [\"../components/UploadImage\"]\n  }\n});\nvar SimpleMDE = dynamic(function () {\n  return import(\"react-simplemde-editor\");\n}, {\n  ssr: false //这个要加上,禁止使用 SSR\n  ,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak(\"react-simplemde-editor\")];\n    },\n    modules: [\"react-simplemde-editor\"]\n  }\n});\nvar progressText = '![Uploading file {uid}...]()';\nvar urlText = '![file]({filename})';\nvar Content = _Layout.Content;\nvar Option = _Select.Option;\nvar TextArea = _Input.TextArea;\n\nvar Create = function Create(props) {\n  console.log('id2', props.id);\n\n  var _useState = useState(),\n      simplemde = _useState[0],\n      setSimplemde = _useState[1];\n\n  var _useState2 = useState(_JSON$stringify(props) != \"{}\" && props.id ? props.id : null),\n      id = _useState2[0],\n      setId = _useState2[1];\n\n  var _useState3 = useState(),\n      token = _useState3[0],\n      setToken = _useState3[1];\n\n  var _useState4 = useState(false),\n      visible = _useState4[0],\n      setVisible = _useState4[1];\n\n  var _useState5 = useState(),\n      articleTitle = _useState5[0],\n      setArticleTitle = _useState5[1];\n\n  var _useState6 = useState(),\n      introducemd = _useState6[0],\n      setIntroducemd = _useState6[1];\n\n  var _useState7 = useState('等待编辑'),\n      introducehtml = _useState7[0],\n      setIntroducehtml = _useState7[1];\n\n  var _useState8 = useState(1),\n      selectedType = _useState8[0],\n      setSelectType = _useState8[1];\n\n  var _useState9 = useState([]),\n      options = _useState9[0],\n      setOptions = _useState9[1];\n\n  var _useState10 = useState(true),\n      isLoading = _useState10[0],\n      setIsLoading = _useState10[1];\n\n  var _useState11 = useState(),\n      coin = _useState11[0],\n      setCoin = _useState11[1];\n\n  var _useState12 = useState(),\n      baiduurl = _useState12[0],\n      setBaiduurl = _useState12[1];\n\n  var _useState13 = useState(),\n      baidupwd = _useState13[0],\n      setBaidupwd = _useState13[1];\n\n  var _useState14 = useState(),\n      count = _useState14[0],\n      setCount = _useState14[1];\n\n  var _useState15 = useState(),\n      fmt = _useState15[0],\n      setFmt = _useState15[1];\n\n  var _useState16 = useState([]),\n      children = _useState16[0],\n      setChildren = _useState16[1];\n\n  var _useState17 = useState(false),\n      zancun = _useState17[0],\n      setZancun = _useState17[1];\n\n  var _useState18 = useState(''),\n      mdeValue = _useState18[0],\n      setMdeValue = _useState18[1]; //文章文章内容\n\n\n  var _useState19 = useState(),\n      labValue = _useState19[0],\n      setLabValue = _useState19[1];\n\n  var handleChange = function handleChange(value) {\n    console.log('value', value);\n    setMdeValue(value);\n  };\n\n  var showModal = function showModal() {\n    setVisible(true);\n  };\n\n  var checkLogin = function checkLogin(token) {\n    var CancelToken = axios.CancelToken;\n    var source = CancelToken.source();\n\n    if (token != null) {\n      axios({\n        method: 'get',\n        url: servicePath.getUserInfo,\n        headers: {\n          'Authorization': 'Bearer ' + token\n        },\n        withCredentials: false,\n        cancelToken: source.token,\n        transformResponse: function transformResponse(data) {\n          console.log('user', data);\n\n          if (data.indexOf('errors') != -1) {\n            data = JSON.parse(data);\n\n            for (var item in data.errors) {\n              _message.error(data.errors[item][0]);\n            }\n          } else if (data.indexOf('Unauthenticated') != -1) {\n            localStorage.removeItem('token');\n            localStorage.removeItem('user_id');\n\n            _message.error('登录已过期，请重新登录');\n\n            Router.push('/login');\n          } else {\n            return data;\n          }\n        }\n      }).then(function (res) {\n        source.cancel('方法被取消');\n        setDataLoading(false);\n        res.data = eval('(' + res.data + ')');\n\n        if (!localStorage.getItem('user_id') || localStorage.getItem('user_id') != res.data.data.id) {\n          Router.push('/login');\n        }\n      })[\"catch\"](function (error) {\n        console.log(error);\n      });\n    } else {\n      Router.push('/login');\n    }\n  };\n\n  var getdetail = function getdetail(id) {\n    var CancelToken = axios.CancelToken;\n    var source = CancelToken.source();\n    axios({\n      method: 'get',\n      url: servicePath.getArticleDetail + id,\n      withCredentials: false,\n      cancelToken: source.token\n    }).then(function (res) {\n      console.log('id1', id);\n      source.cancel('方法被取消');\n      setArticleTitle(res.data.data.title);\n      setIntroducemd(res.data.data.desc);\n      setIntroducehtml(res.data.data.desc);\n      setSelectType(res.data.data.category_id);\n      setCoin(res.data.data.coin);\n      setBaidupwd(res.data.data.baiduyu_pwd);\n      setBaiduurl(res.data.data.baiduyu_url);\n      setCount(res.data.data.count);\n      setFmt(res.data.data.fmt);\n      setMdeValue(res.data.data.content);\n      console.log('tags', res.data.data.tags);\n      setLabValue(res.data.data.tags);\n    })[\"catch\"](function (error) {\n      console.log(error);\n    });\n  };\n\n  var getlabs = function getlabs(selectedType) {\n    var CancelToken = axios.CancelToken;\n    var source = CancelToken.source();\n    axios({\n      method: 'get',\n      url: servicePath.getLabs + '?id=' + selectedType,\n      cancelToken: source.token,\n      transformResponse: function transformResponse(data) {\n        console.log(data);\n\n        if (data.indexOf('Unauthenticated') != -1) {\n          source.cancel('方法被取消');\n          window.location.href = '/';\n        } else {\n          return data;\n        }\n      }\n    }).then(function (res) {\n      setIsLoading(false);\n      res.data = eval('(' + res.data + ')');\n      source.cancel('方法被取消');\n      var labs = [];\n\n      for (var item in res.data.data) {\n        labs.push(__jsx(Option, {\n          key: item,\n          value: res.data.data[item].label\n        }, res.data.data[item].label));\n      }\n\n      setChildren(labs);\n    })[\"catch\"](function (error) {\n      console.log(error);\n    });\n  };\n\n  var stopSave = function stopSave() {\n    //localStorage.setItem('zancun', !zancun)\n    setZancun(!zancun);\n  };\n\n  var onSubmit = function onSubmit() {\n    if (!articleTitle) {\n      _message.error('文章标题不能为空');\n\n      return false;\n    } else if (!introducehtml) {\n      _message.error('文章简介不能为空');\n\n      return false;\n    } else if (!selectedType) {\n      _message.error('文章类型不能为空');\n\n      return false;\n    }\n\n    if (_JSON$stringify(props) != \"{}\" && props.id) {\n      var values = labValue.join(',');\n      var dataProps = {\n        'id': props.id,\n        'title': articleTitle,\n        'desc': introducehtml,\n        'category_id': selectedType,\n        'content': mdeValue,\n        'coin': coin,\n        'fmt': fmt,\n        'user_id': localStorage.getItem('user_id'),\n        'biaoqian': values,\n        'baiduyu_url': baiduurl,\n        'baiduyu_pwd': baidupwd,\n        'count': count,\n        'status': localStorage.getItem('user_id') == 1 ? 1 : 0\n      };\n      axios({\n        method: 'patch',\n        url: servicePath.getArticleDetail + props.id,\n        data: dataProps,\n        headers: {\n          'Authorization': 'Bearer ' + localStorage.getItem('token')\n        },\n        transformResponse: function transformResponse(data) {\n          if (data.indexOf('errors') != -1) {\n            data = JSON.parse(data);\n\n            for (var item in data.errors) {\n              _message.error(data.errors[item][0]);\n            }\n          } else if (data.indexOf('Unauthenticated') != -1) {\n            Router.push('/');\n          } else {\n            return data;\n          }\n        }\n      }).then(function (res) {\n        console.log(res);\n        Router.push('/');\n      })[\"catch\"](function (error) {\n        console.log(error);\n      });\n    } else {\n      var _dataProps = {\n        'title': articleTitle,\n        'desc': introducehtml,\n        'category_id': selectedType,\n        'content': mdeValue,\n        'coin': coin,\n        'fmt': fmt,\n        'user_id': localStorage.getItem('user_id'),\n        'biaoqian': labValue,\n        'baiduyu_url': baiduurl,\n        'baiduyu_pwd': baidupwd,\n        'count': count,\n        'status': localStorage.getItem('user_id') == 1 ? 1 : 0\n      };\n      axios({\n        method: 'post',\n        url: servicePath.addArticle,\n        data: _dataProps,\n        headers: {\n          'Authorization': 'Bearer ' + localStorage.getItem('token')\n        },\n        transformResponse: function transformResponse(data) {\n          if (data.indexOf('errors') != -1) {\n            data = JSON.parse(data);\n\n            for (var item in data.errors) {\n              _message.error(data.errors[item][0]);\n            }\n          } else if (data.indexOf('Unauthenticated') != -1) {\n            Router.push('/');\n          } else {\n            return data;\n          }\n        }\n      }).then(function (res) {\n        console.log(res);\n        Router.push('/');\n      })[\"catch\"](function (error) {\n        console.log(error);\n      });\n    }\n  };\n\n  var getcategory = function getcategory() {\n    var CancelToken = axios.CancelToken;\n    var source = CancelToken.source();\n    axios({\n      method: 'get',\n      url: servicePath.getCategories,\n      cancelToken: source.token\n    }).then(function (res) {\n      source.cancel('方法被取消');\n      var options = [];\n\n      for (var i = 0; i < res.data.length; i++) {\n        options.push(__jsx(Option, {\n          key: res.data[i].id,\n          value: res.data[i].id.toString(36)\n        }, res.data[i].category_name));\n      }\n\n      setOptions(options);\n    })[\"catch\"](function (error) {\n      console.log(error);\n    });\n  };\n\n  function handleChange2(value) {\n    getlabs(value);\n    setSelectType(value);\n  }\n\n  var handleCancel = function handleCancel(e) {\n    setVisible(false);\n  };\n\n  marked.setOptions({\n    renderer: new marked.Renderer(),\n    gfm: true,\n    pedantic: false,\n    sanitize: false,\n    tables: true,\n    breaks: false,\n    smartLists: true,\n    smartypants: false\n  });\n\n  var handleChange1 = function handleChange1(value) {\n    setLabValue(value);\n  };\n\n  var changeIntroduce = function changeIntroduce(e) {\n    setIntroducemd(e.target.value);\n    var html = marked(e.target.value);\n    setIntroducehtml(html);\n  };\n\n  var pr = {\n    name: 'file',\n    supportServerRender: true,\n    action: servicePath.uploadArticleImage,\n    beforeUpload: function beforeUpload(file) {\n      var text = progressText.replace('{uid}', file.uid);\n      simplemde.codemirror.replaceSelection(text);\n      file.insertText = text;\n    },\n    headers: {\n      'Authorization': 'Bearer ' + token\n    },\n    onChange: function onChange(_ref) {\n      var file = _ref.file;\n      console.log(file);\n\n      if (file.status === 'done') {\n        console.log('simplemde', simplemde);\n        var response = file.response,\n            originFileObj = file.originFileObj;\n        var file_path = response.file_path;\n        var cursor = simplemde.codemirror.getCursor();\n        var newValue = urlText.replace('{filename}', file_path);\n        var text = simplemde.codemirror.getValue().replace(originFileObj.insertText, newValue);\n        simplemde.codemirror.setValue(text);\n        cursor.ch += newValue.length - progressText.length;\n        simplemde.codemirror.setCursor(cursor);\n        simplemde.codemirror.focus();\n        originFileObj.insertText = newValue;\n      } else if (file.status === 'error') {\n        _message.error(\"\".concat(file.name, \" file upload failed.\"));\n      }\n\n      setVisible(false);\n    }\n  };\n\n  var getInsance = function getInsance(instance) {\n    setSimplemde(instance);\n  };\n\n  var detail = useMemo(function () {\n    return getdetail(id);\n  }, [id]);\n  useEffect(function () {\n    if (isLoading) {\n      {\n        detail;\n      }\n      getcategory();\n      getlabs(selectedType);\n\n      if (localStorage.getItem('token')) {\n        checkLogin(localStorage.getItem('token'));\n        setToken(localStorage.getItem('token'));\n      } else {\n        Router.push('/login');\n      }\n    }\n  });\n  return __jsx(_Layout, {\n    className: \"ly\"\n  }, __jsx(Head, null, __jsx(\"title\", null, \"\\u535A\\u4EBA\\u5802 -- \\u7F16\\u8F91\\u6587\\u7AE0\")), __jsx(Content, {\n    className: \"content\"\n  }, __jsx(_Row, {\n    gutter: 5\n  }, __jsx(_Col, {\n    span: 18\n  }, __jsx(_Row, {\n    gutter: 10\n  }, __jsx(_Col, {\n    span: 20\n  }, __jsx(_Input, {\n    value: articleTitle,\n    onChange: function onChange(e) {\n      setArticleTitle(e.target.value);\n    },\n    placeholder: \"\\u6807\\u9898\",\n    size: \"large\"\n  })), __jsx(_Col, {\n    span: 4\n  }, \"\\xA0\", __jsx(_Select, {\n    onChange: handleChange2,\n    defaultValue: selectedType + '',\n    size: \"large\"\n  }, options))), __jsx(\"br\", null), __jsx(_Row, {\n    gutter: 10\n  }, __jsx(_Col, {\n    span: 24\n  }, __jsx(SimpleMDE, {\n    getMdeInstance: getInsance,\n    options: {\n      autofocus: true,\n      autosave: {\n        enabled: false,\n        uniqueId: \"MyUniqueID\",\n        delay: 1000\n      },\n      toolbar: ['bold', 'italic', 'heading', \"code\", \"table\", \"clean-block\", 'quote', 'horizontal-rule', 'unordered-list', 'ordered-list', 'link', {\n        name: 'image',\n        action: function action() {\n          showModal();\n        },\n        className: 'fa fa-file-image-o',\n        title: '上传'\n      }, 'preview', 'side-by-side', 'fullscreen'],\n      spellChecker: false\n    },\n    onChange: handleChange,\n    value: mdeValue\n  })))), __jsx(_Col, {\n    span: 6\n  }, __jsx(_Row, null, __jsx(_Col, {\n    span: 24\n  }, __jsx(_Button, {\n    type: zancun ? 'primary' : 'default',\n    size: \"large\",\n    onClick: stopSave\n  }, \"\\u6682\\u5B58\\u6587\\u7AE0\"), \"\\xA0\", __jsx(_Button, {\n    onClick: onSubmit,\n    type: \"primary\",\n    size: \"large\"\n  }, \"\\u53D1\\u5E03\"), __jsx(\"br\", null)), __jsx(_Col, {\n    span: 24\n  }, __jsx(\"br\", null), __jsx(TextArea, {\n    rows: 4,\n    style: {\n      height: 154\n    },\n    value: introducemd,\n    onChange: changeIntroduce,\n    onPressEnter: changeIntroduce,\n    placeholder: \"\\u7B80\\u4ECB\"\n  }), __jsx(\"br\", null), __jsx(\"br\", null), __jsx(\"div\", {\n    className: \"introduce-html\",\n    dangerouslySetInnerHTML: {\n      __html: '简介：' + introducehtml\n    }\n  })), __jsx(_Col, {\n    span: 24,\n    style: {\n      marginTop: '20px'\n    }\n  }, __jsx(FmtContext.Provider, {\n    value: {\n      fmt: fmt,\n      setFmt: setFmt\n    }\n  }, __jsx(UploadImage, null)), fmt && __jsx(\"img\", {\n    src: fmt,\n    style: {\n      width: '100%',\n      marginTop: 10\n    }\n  })), __jsx(_Col, {\n    span: 24,\n    style: {\n      marginTop: '20px'\n    }\n  }, __jsx(_Select, {\n    mode: \"tags\",\n    type: {\n      isSelectOptGroup: false\n    },\n    style: {\n      width: '100%'\n    },\n    placeholder: \"\\u6807\\u7B7E\",\n    value: labValue,\n    onChange: handleChange1\n  }, children)), __jsx(_Col, {\n    span: 24,\n    style: {\n      marginTop: '20px'\n    }\n  }, __jsx(_Input, {\n    value: coin,\n    onChange: function onChange(e) {\n      setCoin(e.target.value);\n    },\n    placeholder: \"\\u652F\\u4ED8\\u79EF\\u5206\"\n  })), __jsx(_Col, {\n    span: 17,\n    style: {\n      marginTop: '20px'\n    }\n  }, __jsx(_Input, {\n    value: baiduurl,\n    onChange: function onChange(e) {\n      setBaiduurl(e.target.value);\n    },\n    placeholder: \"\\u767E\\u5EA6\\u4E91\\u76D8\\u7684\\u94FE\\u63A5\\u5730\\u5740\"\n  })), __jsx(_Col, {\n    span: 1,\n    style: {\n      marginTop: '20px'\n    }\n  }), __jsx(_Col, {\n    span: 6,\n    style: {\n      marginTop: '20px'\n    }\n  }, __jsx(_Input, {\n    value: baidupwd,\n    onChange: function onChange(e) {\n      setBaidupwd(e.target.value);\n    },\n    placeholder: \"\\u5BC6\\u7801\"\n  })), __jsx(_Col, {\n    span: 24,\n    style: {\n      marginTop: '20px'\n    }\n  }, __jsx(_Input, {\n    value: count,\n    onChange: function onChange(e) {\n      setCount(e.target.value);\n    },\n    placeholder: \"\\u8BFE\\u7A0B\\u6570/\\u8D44\\u6E90\\u5927\\u5C0F\"\n  })))))), __jsx(_BackTop, null), __jsx(_Modal, {\n    footer: null,\n    title: \"\\u4E0A\\u4F20\\u56FE\\u7247\",\n    visible: visible,\n    onCancel: handleCancel\n  }, __jsx(Dragger, pr, __jsx(\"p\", {\n    className: \"ant-upload-drag-icon\"\n  }, __jsx(_Icon, {\n    type: \"inbox\"\n  })), __jsx(\"p\", {\n    className: \"ant-upload-text\"\n  }, \"\\u70B9\\u51FB\\u6216\\u62D6\\u62FD\\u4E0A\\u4F20\\u56FE\\u7247\"), __jsx(\"p\", {\n    className: \"ant-upload-hint\"\n  }, \"\\u652F\\u6301\\u5355\\u6B21\\u6216\\u6279\\u91CF\\u4E0A\\u4F20\\u3002\\u652F\\u6301\\u56FE\\u7247\\u683C\\u5F0F\\u6587\\u4EF6\"))));\n};\n\nCreate.getInitialProps = function _callee(context) {\n  var id, promise;\n  return _regeneratorRuntime.async(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          id = context.ctx.query.id;\n          console.log('id', typeof id != \"undefined\");\n\n          if (!(_JSON$stringify(context.ctx.query) != \"{}\" && typeof id != \"undefined\")) {\n            _context.next = 9;\n            break;\n          }\n\n          promise = new _Promise(function (resolve) {\n            resolve({\n              id: id\n            });\n          });\n          _context.next = 6;\n          return _regeneratorRuntime.awrap(promise);\n\n        case 6:\n          return _context.abrupt(\"return\", _context.sent);\n\n        case 9:\n          _context.next = 11;\n          return _regeneratorRuntime.awrap(new _Promise(function (resolve) {\n            resolve({});\n          }));\n\n        case 11:\n          return _context.abrupt(\"return\", _context.sent);\n\n        case 12:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  });\n};\n\nexport default Create;","map":{"version":3,"sources":["/Users/mac/Desktop/liy-blog/pages/create.js"],"names":["React","useState","useEffect","createContext","useMemo","marked","axios","Head","servicePath","Router","dynamic","FmtContext","Dragger","UploadImage","ssr","SimpleMDE","progressText","urlText","Content","Option","TextArea","Create","props","console","log","id","simplemde","setSimplemde","setId","token","setToken","visible","setVisible","articleTitle","setArticleTitle","introducemd","setIntroducemd","introducehtml","setIntroducehtml","selectedType","setSelectType","options","setOptions","isLoading","setIsLoading","coin","setCoin","baiduurl","setBaiduurl","baidupwd","setBaidupwd","count","setCount","fmt","setFmt","children","setChildren","zancun","setZancun","mdeValue","setMdeValue","labValue","setLabValue","handleChange","value","showModal","checkLogin","CancelToken","source","method","url","getUserInfo","headers","withCredentials","cancelToken","transformResponse","data","indexOf","JSON","parse","item","errors","error","localStorage","removeItem","push","then","res","cancel","setDataLoading","eval","getItem","getdetail","getArticleDetail","title","desc","category_id","baiduyu_pwd","baiduyu_url","content","tags","getlabs","getLabs","window","location","href","labs","label","stopSave","onSubmit","values","join","dataProps","addArticle","getcategory","getCategories","i","length","toString","category_name","handleChange2","handleCancel","e","renderer","Renderer","gfm","pedantic","sanitize","tables","breaks","smartLists","smartypants","handleChange1","changeIntroduce","target","html","pr","name","supportServerRender","action","uploadArticleImage","beforeUpload","file","text","replace","uid","codemirror","replaceSelection","insertText","onChange","status","response","originFileObj","file_path","cursor","getCursor","newValue","getValue","setValue","ch","setCursor","focus","getInsance","instance","detail","autofocus","autosave","enabled","uniqueId","delay","toolbar","className","spellChecker","height","__html","marginTop","width","isSelectOptGroup","getInitialProps","context","ctx","query","promise","resolve"],"mappings":"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","sourcesContent":["// import dynamic from 'next/dynamic'\n// const Createoredit = dynamic(\n//     import('../components/createoredit'),\n//     {\n//         ssr: false   //这个要加上,禁止使用 SSR\n//     }\n// )\n\n// export default () => <Createoredit />\n\nimport React, { useState, useEffect, createContext, useMemo } from 'react';\nimport marked from 'marked'\nimport axios from 'axios'\nimport \"easymde/dist/easymde.min.css\";\nimport { Layout, Row, Col, Input, Select, Button, Upload, Modal, Icon, message, BackTop } from 'antd'\nimport Head from 'next/head'\nimport servicePath from '../config/apiUrl';\nimport Router from 'next/router'\nimport dynamic from 'next/dynamic'\nexport const FmtContext = createContext({})\nconst { Dragger } = Upload;\nconst UploadImage = dynamic(\n    import(\"../components/UploadImage\"),\n    {\n        ssr: false   //这个要加上,禁止使用 SSR\n    }\n)\n\nconst SimpleMDE = dynamic(\n    import(\"react-simplemde-editor\"),\n    {\n        ssr: false   //这个要加上,禁止使用 SSR\n    }\n)\n\nconst progressText = '![Uploading file {uid}...]()';\n\nconst urlText = '![file]({filename})';\n\nconst { Content } = Layout;\nconst Option = Select.Option;\nconst { TextArea } = Input\n\n\n\nconst Create = (props) => {\n    console.log('id2', props.id)\n    const [simplemde, setSimplemde] = useState()\n    const [id, setId] = useState(JSON.stringify(props) != \"{}\" && props.id ? props.id : null)\n    const [token, setToken] = useState()\n    const [visible, setVisible] = useState(false)\n    const [articleTitle, setArticleTitle] = useState()\n    const [introducemd, setIntroducemd] = useState()\n    const [introducehtml, setIntroducehtml] = useState('等待编辑')\n    const [selectedType, setSelectType] = useState(1)\n    const [options, setOptions] = useState([])\n    const [isLoading, setIsLoading] = useState(true)\n    const [coin, setCoin] = useState()\n    const [baiduurl, setBaiduurl] = useState()\n    const [baidupwd, setBaidupwd] = useState()\n    const [count, setCount] = useState()\n    const [fmt, setFmt] = useState()\n    const [children, setChildren] = useState([])\n    const [zancun, setZancun] = useState(false)\n    const [mdeValue, setMdeValue] = useState('')//文章文章内容\n    const [labValue, setLabValue] = useState()\n    const handleChange = value => {\n        console.log('value', value)\n        setMdeValue(value)\n    };\n    const showModal = () => {\n        setVisible(true)\n    };\n\n    const checkLogin = (token) => {\n        const CancelToken = axios.CancelToken;\n        const source = CancelToken.source();\n\n\n        if (token != null) {\n            axios({\n                method: 'get',\n                url: servicePath.getUserInfo,\n                headers: {\n                    'Authorization': 'Bearer ' + token,\n                },\n                withCredentials: false,\n                cancelToken: source.token,\n                transformResponse: function (data) {\n                    console.log('user', data)\n                    if (data.indexOf('errors') != -1) {\n                        data = JSON.parse(data);\n                        for (var item in data.errors) {\n                            message.error(data.errors[item][0]);\n                        }\n                    } else if (data.indexOf('Unauthenticated') != -1) {\n                        localStorage.removeItem('token')\n                        localStorage.removeItem('user_id')\n                        message.error('登录已过期，请重新登录');\n                        Router.push('/login')\n                    } else {\n                        return data;\n                    }\n                }\n            }).then(\n                res => {\n                    source.cancel('方法被取消');\n                    setDataLoading(false)\n                    res.data = eval('(' + res.data + ')');\n                    if (!localStorage.getItem('user_id') ||\n                        localStorage.getItem('user_id') != res.data.data.id) {\n                            Router.push('/login')\n                    }\n\n                }\n            ).catch(function (error) {\n                console.log(error)\n            });\n        } else {\n            Router.push('/login')\n        }\n    }\n\n    const getdetail = (id) => {\n        const CancelToken = axios.CancelToken;\n        const source = CancelToken.source();\n        axios({\n            method: 'get',\n            url: servicePath.getArticleDetail + id,\n            withCredentials: false,\n            cancelToken: source.token,\n        }).then(\n            res => {\n                console.log('id1', id)\n                source.cancel('方法被取消');\n                setArticleTitle(res.data.data.title);\n                setIntroducemd(res.data.data.desc);\n                setIntroducehtml(res.data.data.desc);\n                setSelectType(res.data.data.category_id)\n                setCoin(res.data.data.coin)\n                setBaidupwd(res.data.data.baiduyu_pwd)\n                setBaiduurl(res.data.data.baiduyu_url)\n                setCount(res.data.data.count)\n                setFmt(res.data.data.fmt);\n                setMdeValue(res.data.data.content)\n                console.log('tags', res.data.data.tags)\n                setLabValue(res.data.data.tags)\n            }\n        ).catch(function (error) {\n            console.log(error)\n        });\n    };\n\n\n    const getlabs = (selectedType) => {\n        const CancelToken = axios.CancelToken;\n        const source = CancelToken.source();\n        axios({\n            method: 'get',\n            url: servicePath.getLabs + '?id=' + selectedType,\n            cancelToken: source.token,\n            transformResponse: function (data) {\n                console.log(data)\n                if (data.indexOf('Unauthenticated') != -1) {\n                    source.cancel('方法被取消');\n                    window.location.href = '/'\n                } else {\n                    return data;\n                }\n            }\n        }).then(\n            res => {\n                setIsLoading(false)\n                res.data = eval('(' + res.data + ')');\n                source.cancel('方法被取消');\n                let labs = [];\n                for (let item in res.data.data) {\n                    labs.push(<Option key={item} value={res.data.data[item].label}>{res.data.data[item].label}</Option>)\n                }\n\n                setChildren(labs)\n            }\n        ).catch(function (error) {\n            console.log(error)\n        });\n    }\n\n\n\n    const stopSave = () => {\n        //localStorage.setItem('zancun', !zancun)\n        setZancun(!zancun)\n    }\n\n    const onSubmit = () => {\n        if (!articleTitle) {\n            message.error('文章标题不能为空')\n            return false\n        } else if (!introducehtml) {\n            message.error('文章简介不能为空')\n            return false\n        } else if (!selectedType) {\n            message.error('文章类型不能为空')\n            return false\n        }\n\n        if (JSON.stringify(props) != \"{}\" && props.id) {\n            let values = labValue.join(',')\n            let dataProps = {\n                'id': props.id,\n                'title': articleTitle,\n                'desc': introducehtml,\n                'category_id': selectedType,\n                'content': mdeValue,\n                'coin': coin,\n                'fmt': fmt,\n                'user_id': localStorage.getItem('user_id'),\n                'biaoqian': values,\n                'baiduyu_url': baiduurl,\n                'baiduyu_pwd': baidupwd,\n                'count': count,\n                'status': localStorage.getItem('user_id') == 1 ? 1 : 0,\n            }\n\n\n\n            axios({\n                method: 'patch',\n                url: servicePath.getArticleDetail + props.id,\n                data: dataProps,\n                headers: {\n                    'Authorization': 'Bearer ' + localStorage.getItem('token'),\n                }, transformResponse: function (data) {\n                    if (data.indexOf('errors') != -1) {\n                        data = JSON.parse(data);\n                        for (var item in data.errors) {\n                            message.error(data.errors[item][0]);\n                        }\n                    } else if (data.indexOf('Unauthenticated') != -1) {\n                        Router.push('/')\n                    } else {\n                        return data;\n                    }\n                }\n            }).then(\n                res => {\n                    console.log(res)\n                    Router.push('/')\n                }\n            ).catch(function (error) {\n                console.log(error)\n            });\n\n        } else {\n            let dataProps = {\n                'title': articleTitle,\n                'desc': introducehtml,\n                'category_id': selectedType,\n                'content': mdeValue,\n                'coin': coin,\n                'fmt': fmt,\n                'user_id': localStorage.getItem('user_id'),\n                'biaoqian': labValue,\n                'baiduyu_url': baiduurl,\n                'baiduyu_pwd': baidupwd,\n                'count': count,\n                'status': localStorage.getItem('user_id') == 1 ? 1 : 0,\n            }\n\n            axios({\n                method: 'post',\n                url: servicePath.addArticle,\n                data: dataProps,\n                headers: {\n                    'Authorization': 'Bearer ' + localStorage.getItem('token'),\n                }, transformResponse: function (data) {\n                    if (data.indexOf('errors') != -1) {\n                        data = JSON.parse(data);\n                        for (var item in data.errors) {\n                            message.error(data.errors[item][0]);\n                        }\n                    } else if (data.indexOf('Unauthenticated') != -1) {\n                        Router.push('/')\n                    } else {\n                        return data;\n                    }\n                }\n            }).then(\n                res => {\n                    console.log(res)\n                    Router.push('/')\n                }\n            ).catch(function (error) {\n                console.log(error)\n            });\n        }\n    }\n\n    const getcategory = () => {\n        const CancelToken = axios.CancelToken;\n        const source = CancelToken.source();\n        axios({\n            method: 'get',\n            url: servicePath.getCategories,\n            cancelToken: source.token,\n        }).then(\n            res => {\n                source.cancel('方法被取消');\n                let options = [];\n                for (let i = 0; i < res.data.length; i++) {\n                    options.push(<Option key={res.data[i].id} value={res.data[i].id.toString(36)}>{res.data[i].category_name}</Option>)\n                }\n                setOptions(options)\n            }\n        ).catch(function (error) {\n            console.log(error)\n        });\n    }\n\n    function handleChange2(value) {\n        getlabs(value)\n        setSelectType(value)\n    }\n    const handleCancel = e => {\n        setVisible(false)\n    };\n\n\n\n    marked.setOptions({\n        renderer: new marked.Renderer(),\n        gfm: true,\n        pedantic: false,\n        sanitize: false,\n        tables: true,\n        breaks: false,\n        smartLists: true,\n        smartypants: false,\n    });\n\n\n\n    const handleChange1 = value => {\n        setLabValue(value)\n    }\n\n\n\n    const changeIntroduce = (e) => {\n        setIntroducemd(e.target.value)\n        let html = marked(e.target.value)\n        setIntroducehtml(html)\n    }\n\n    const pr = {\n        name: 'file',\n        supportServerRender: true,\n        action: servicePath.uploadArticleImage,\n        beforeUpload: file => {\n            const text = progressText.replace('{uid}', file.uid);\n            simplemde.codemirror.replaceSelection(text);\n            file.insertText = text;\n        },\n        headers: {\n            'Authorization': 'Bearer ' + token,\n        },\n        onChange({ file }) {\n            console.log(file)\n            if (file.status === 'done') {\n                console.log('simplemde', simplemde)\n                const { response, originFileObj } = file;\n                const { file_path } = response;\n                const cursor = simplemde.codemirror.getCursor();\n                const newValue = urlText.replace('{filename}', file_path);\n                const text = simplemde.codemirror.getValue().replace(originFileObj.insertText, newValue);\n                simplemde.codemirror.setValue(text);\n\n                cursor.ch += newValue.length - progressText.length;\n                simplemde.codemirror.setCursor(cursor);\n                simplemde.codemirror.focus();\n                originFileObj.insertText = newValue;\n            } else if (file.status === 'error') {\n                message.error(`${file.name} file upload failed.`);\n            }\n\n            setVisible(false)\n        },\n    };\n\n    const getInsance = instance => {\n        setSimplemde(instance)\n    };\n\n    const detail = useMemo(() => getdetail(id), [id])\n\n    useEffect(() => {\n        \n        if (isLoading) {\n            { detail }\n            getcategory()\n            getlabs(selectedType)\n            if (localStorage.getItem('token')) {\n                checkLogin(localStorage.getItem('token'))\n                setToken(localStorage.getItem('token'))\n            } else {\n                Router.push('/login')\n            }\n        }\n    })\n\n\n\n\n\n\n\n    return (\n        <Layout className=\"ly\">\n            <Head>\n                <title>博人堂 -- 编辑文章</title>\n            </Head>\n            <Content className=\"content\">\n                <Row gutter={5}>\n                    <Col span={18}>\n                        <Row gutter={10} >\n                            <Col span={20}>\n                                <Input\n                                    value={articleTitle}\n                                    onChange={(e) => { setArticleTitle(e.target.value) }}\n                                    placeholder=\"标题\"\n                                    size=\"large\" />\n                            </Col>\n                            <Col span={4}>\n                                &nbsp;\n                                <Select\n                                    onChange={handleChange2}\n                                    defaultValue={selectedType + ''}\n                                    size=\"large\">\n                                    {options}\n                                </Select>\n                            </Col>\n                        </Row>\n                        <br />\n                        <Row gutter={10} >\n                            <Col span={24}>\n                                <SimpleMDE\n                                    getMdeInstance={getInsance}\n                                    options={{\n                                        autofocus: true,\n                                        autosave: { enabled: false, uniqueId: \"MyUniqueID\", delay: 1000, },\n                                        toolbar: ['bold', 'italic', 'heading',\n                                            \"code\", \"table\", \"clean-block\", 'quote',\n                                            'horizontal-rule', 'unordered-list',\n                                            'ordered-list', 'link',\n                                            {\n                                                name: 'image',\n                                                action: () => {\n                                                    showModal()\n                                                },\n                                                className: 'fa fa-file-image-o',\n                                                title: '上传',\n                                            }, 'preview',\n                                            'side-by-side', 'fullscreen'],\n                                        spellChecker: false\n                                    }}\n                                    onChange={handleChange}\n                                    value={mdeValue}\n                                />\n                            </Col>\n                        </Row>\n\n                    </Col>\n\n                    <Col span={6}>\n                        <Row>\n                            <Col span={24}>\n                                <Button type={zancun ? 'primary' : 'default'} size=\"large\" onClick={stopSave}>暂存文章</Button>&nbsp;\n                                <Button onClick={onSubmit} type=\"primary\" size=\"large\" >发布</Button>\n                                <br />\n                            </Col>\n\n                            <Col span={24}>\n                                <br />\n                                <TextArea\n                                    rows={4}\n                                    style={{ height: 154 }}\n                                    value={introducemd}\n                                    onChange={changeIntroduce}\n                                    onPressEnter={changeIntroduce}\n                                    placeholder=\"简介\"\n                                />\n                                <br /><br />\n                                <div\n                                    className=\"introduce-html\"\n                                    dangerouslySetInnerHTML={{ __html: '简介：' + introducehtml }} >\n                                </div>\n                            </Col>\n\n                            <Col span={24} style={{ marginTop: '20px' }}>\n                                <FmtContext.Provider value={{ fmt, setFmt }}>\n                                    <UploadImage />\n                                </FmtContext.Provider>\n                                {fmt && <img src={fmt} style={{ width: '100%', marginTop: 10 }} />}\n                            </Col>\n\n                            <Col span={24} style={{ marginTop: '20px' }}>\n                                <Select\n                                    mode=\"tags\"\n                                    type={{ isSelectOptGroup: false }}\n                                    style={{ width: '100%' }}\n                                    placeholder=\"标签\"\n                                    value={labValue}\n                                    onChange={handleChange1}\n                                >\n                                    {children}\n                                </Select>\n                            </Col>\n\n                            <Col span={24} style={{ marginTop: '20px' }}>\n                                <Input\n                                    value={coin}\n                                    onChange={(e) => { setCoin(e.target.value) }}\n                                    placeholder=\"支付积分\" />\n                            </Col>\n\n                            <Col span={17} style={{ marginTop: '20px' }}>\n                                <Input\n                                    value={baiduurl}\n                                    onChange={(e) => { setBaiduurl(e.target.value) }}\n                                    placeholder=\"百度云盘的链接地址\" />\n                            </Col>\n\n                            <Col span={1} style={{ marginTop: '20px' }}>\n                            </Col>\n\n\n                            <Col span={6} style={{ marginTop: '20px' }}>\n                                <Input\n                                    value={baidupwd}\n                                    onChange={(e) => { setBaidupwd(e.target.value) }}\n                                    placeholder=\"密码\" />\n                            </Col>\n\n                            <Col span={24} style={{ marginTop: '20px' }}>\n                                <Input\n                                    value={count}\n                                    onChange={(e) => { setCount(e.target.value) }}\n                                    placeholder=\"课程数/资源大小\" />\n                            </Col>\n                        </Row>\n                    </Col>\n                </Row>\n            </Content>\n            <BackTop />\n            <Modal\n                footer={null}\n                title=\"上传图片\"\n                visible={visible} onCancel={handleCancel}>\n\n                <Dragger {...pr}>\n                    <p className=\"ant-upload-drag-icon\">\n                        <Icon type=\"inbox\" />\n                    </p>\n                    <p className=\"ant-upload-text\">点击或拖拽上传图片</p>\n                    <p className=\"ant-upload-hint\">\n                        支持单次或批量上传。支持图片格式文件\n                    </p>\n                </Dragger>\n            </Modal>\n        </Layout>\n    )\n}\n\nCreate.getInitialProps = async (context) => {\n    let id = context.ctx.query.id\n    console.log('id', typeof id != \"undefined\")\n    if (JSON.stringify(context.ctx.query) != \"{}\" && typeof id != \"undefined\") {\n        const promise = new Promise((resolve) => {\n            resolve({ id: id })\n        })\n        return await promise\n    } else {\n        return await new Promise(resolve => {\n            resolve({})\n        })\n    }\n}\n\nexport default Create"]},"metadata":{},"sourceType":"module"}