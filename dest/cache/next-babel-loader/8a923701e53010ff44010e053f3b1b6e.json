{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _Modal from \"antd/lib/modal\";\nimport _Icon from \"antd/lib/icon\";\nimport _BackTop from \"antd/lib/back-top\";\nimport _Button from \"antd/lib/button\";\nimport _Row from \"antd/lib/row\";\nimport _Col from \"antd/lib/col\";\nimport _message from \"antd/lib/message\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _Input from \"antd/lib/input\";\nimport _Select from \"antd/lib/select\";\nimport _Layout from \"antd/lib/layout\";\nimport _Upload from \"antd/lib/upload\";\nvar __jsx = React.createElement;\n// import dynamic from 'next/dynamic'\n// const Createoredit = dynamic(\n//     import('../components/createoredit'),\n//     {\n//         ssr: false   //这个要加上,禁止使用 SSR\n//     }\n// )\n// export default () => <Createoredit />\nimport React, { useState, useEffect, createContext, useMemo, memo } from 'react';\nimport marked from 'marked';\nimport axios from 'axios';\nimport \"easymde/dist/easymde.min.css\";\nimport Head from 'next/head';\nimport servicePath from '../config/apiUrl';\nimport Router from 'next/router';\nimport dynamic from 'next/dynamic';\nexport var FmtContext = createContext({});\nvar Dragger = _Upload.Dragger;\nvar UploadImage = dynamic(function () {\n  return import(\"../components/UploadImage\");\n}, {\n  ssr: false //这个要加上,禁止使用 SSR\n  ,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak(\"../components/UploadImage\")];\n    },\n    modules: [\"../components/UploadImage\"]\n  }\n});\nvar SimpleMDE = dynamic(function () {\n  return import(\"react-simplemde-editor\");\n}, {\n  ssr: false //这个要加上,禁止使用 SSR\n  ,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak(\"react-simplemde-editor\")];\n    },\n    modules: [\"react-simplemde-editor\"]\n  }\n});\nvar Content = _Layout.Content;\nvar Option = _Select.Option;\nvar TextArea = _Input.TextArea;\nvar Create = useMemo(function () {\n  (function (props) {\n    console.log('id', props.id);\n\n    var _useState = useState(_JSON$stringify(props) != \"{}\" && props.id ? props.id : null),\n        id = _useState[0],\n        setId = _useState[1];\n\n    var _useState2 = useState(),\n        token = _useState2[0],\n        setToken = _useState2[1];\n\n    var _useState3 = useState(false),\n        visible = _useState3[0],\n        setVisible = _useState3[1];\n\n    var _useState4 = useState(),\n        articleTitle = _useState4[0],\n        setArticleTitle = _useState4[1];\n\n    var _useState5 = useState(),\n        introducemd = _useState5[0],\n        setIntroducemd = _useState5[1];\n\n    var _useState6 = useState('等待编辑'),\n        introducehtml = _useState6[0],\n        setIntroducehtml = _useState6[1];\n\n    var _useState7 = useState(1),\n        selectedType = _useState7[0],\n        setSelectType = _useState7[1];\n\n    var _useState8 = useState([]),\n        options = _useState8[0],\n        setOptions = _useState8[1];\n\n    var _useState9 = useState(true),\n        isLoading = _useState9[0],\n        setIsLoading = _useState9[1];\n\n    var _useState10 = useState(),\n        coin = _useState10[0],\n        setCoin = _useState10[1];\n\n    var _useState11 = useState(),\n        baiduurl = _useState11[0],\n        setBaiduurl = _useState11[1];\n\n    var _useState12 = useState(),\n        baidupwd = _useState12[0],\n        setBaidupwd = _useState12[1];\n\n    var _useState13 = useState(),\n        count = _useState13[0],\n        setCount = _useState13[1];\n\n    var _useState14 = useState(),\n        fmt = _useState14[0],\n        setFmt = _useState14[1];\n\n    var _useState15 = useState([]),\n        children = _useState15[0],\n        setChildren = _useState15[1];\n\n    var _useState16 = useState(false),\n        zancun = _useState16[0],\n        setZancun = _useState16[1];\n\n    var _useState17 = useState(),\n        mdeValue = _useState17[0],\n        setMdeValue = _useState17[1]; //文章文章内容\n\n\n    var _useState18 = useState(),\n        labValue = _useState18[0],\n        setLabValue = _useState18[1]; //文章文章内容\n\n\n    var handleChange = function handleChange(value) {\n      setMdeValue(value);\n    };\n\n    var showModal = function showModal() {\n      setVisible(true);\n    };\n\n    var getdetail = function getdetail(id) {\n      var CancelToken = axios.CancelToken;\n      var source = CancelToken.source();\n      axios({\n        method: 'get',\n        url: servicePath.getArticleDetail + id,\n        withCredentials: false,\n        cancelToken: source.token\n      }).then(function (res) {\n        console.log('meiyou', 'meiyou');\n        source.cancel('方法被取消');\n        setArticleTitle(res.data.data.title);\n        setIntroducemd(res.data.data.desc);\n        setIntroducehtml(res.data.data.desc);\n        setSelectType(res.data.data.category_id);\n        setCoin(res.data.data.coin);\n        setBaidupwd(res.data.data.baiduyu_pwd);\n        setBaiduurl(res.data.data.baiduyu_url);\n        setCount(res.data.data.count);\n        setFmt(res.data.data.fmt);\n        setMdeValue(res.data.data.content);\n        console.log('tags', res.data.data.tags);\n        setLabValue(res.data.data.tags);\n        getcategory();\n        getlabs(res.data.data.category_id);\n      })[\"catch\"](function (error) {\n        console.log(error);\n      });\n    };\n\n    var getlabs = function getlabs(selectedType) {\n      var CancelToken = axios.CancelToken;\n      var source = CancelToken.source();\n      axios({\n        method: 'get',\n        url: servicePath.getLabs + '?id=' + selectedType,\n        cancelToken: source.token,\n        transformResponse: function transformResponse(data) {\n          console.log(data);\n\n          if (data.indexOf('Unauthenticated') != -1) {\n            source.cancel('方法被取消');\n            window.location.href = '/';\n          } else {\n            return data;\n          }\n        }\n      }).then(function (res) {\n        setIsLoading(false);\n        res.data = eval('(' + res.data + ')');\n        source.cancel('方法被取消');\n        var labs = [];\n\n        for (var item in res.data.data) {\n          labs.push(__jsx(Option, {\n            key: item,\n            value: res.data.data[item].label\n          }, res.data.data[item].label));\n        }\n\n        setChildren(labs);\n      })[\"catch\"](function (error) {\n        console.log(error);\n      });\n    };\n\n    var stopSave = function stopSave() {\n      //localStorage.setItem('zancun', !zancun)\n      setZancun(!zancun);\n    };\n\n    var onSubmit = function onSubmit() {\n      if (!articleTitle) {\n        _message.error('文章标题不能为空');\n\n        return false;\n      } else if (!introducehtml) {\n        _message.error('文章简介不能为空');\n\n        return false;\n      } else if (!selectedType) {\n        _message.error('文章类型不能为空');\n\n        return false;\n      }\n\n      if (_JSON$stringify(props) != \"{}\" && props.id) {\n        var values = labValue.join(',');\n        var dataProps = {\n          'id': props.id,\n          'title': articleTitle,\n          'desc': introducehtml,\n          'category_id': selectedType,\n          'content': mdeValue,\n          'coin': coin,\n          'fmt': fmt,\n          'user_id': localStorage.getItem('user_id'),\n          'biaoqian': values,\n          'baiduyu_url': baiduurl,\n          'baiduyu_pwd': baidupwd,\n          'count': count,\n          'status': localStorage.getItem('user_id') == 1 ? 1 : 0\n        };\n        axios({\n          method: 'patch',\n          url: servicePath.getArticleDetail + props.id,\n          data: dataProps,\n          headers: {\n            'Authorization': 'Bearer ' + localStorage.getItem('token')\n          },\n          transformResponse: function transformResponse(data) {\n            if (data.indexOf('errors') != -1) {\n              data = JSON.parse(data);\n\n              for (var item in data.errors) {\n                _message.error(data.errors[item][0]);\n              }\n            } else if (data.indexOf('Unauthenticated') != -1) {\n              Router.push('/');\n            } else {\n              return data;\n            }\n          }\n        }).then(function (res) {\n          console.log(res);\n          Router.push('/');\n        })[\"catch\"](function (error) {\n          console.log(error);\n        });\n      } else {\n        var _dataProps = {\n          'title': articleTitle,\n          'desc': introducehtml,\n          'category_id': selectedType,\n          'content': mdeValue,\n          'coin': coin,\n          'fmt': fmt,\n          'user_id': localStorage.getItem('user_id'),\n          'biaoqian': labValue,\n          'baiduyu_url': baiduurl,\n          'baiduyu_pwd': baidupwd,\n          'count': count,\n          'status': localStorage.getItem('user_id') == 1 ? 1 : 0\n        };\n        axios({\n          method: 'post',\n          url: servicePath.addArticle,\n          data: _dataProps,\n          headers: {\n            'Authorization': 'Bearer ' + localStorage.getItem('token')\n          },\n          transformResponse: function transformResponse(data) {\n            if (data.indexOf('errors') != -1) {\n              data = JSON.parse(data);\n\n              for (var item in data.errors) {\n                _message.error(data.errors[item][0]);\n              }\n            } else if (data.indexOf('Unauthenticated') != -1) {\n              Router.push('/');\n            } else {\n              return data;\n            }\n          }\n        }).then(function (res) {\n          console.log(res);\n          Router.push('/');\n        })[\"catch\"](function (error) {\n          console.log(error);\n        });\n      }\n    };\n\n    var getcategory = function getcategory() {\n      var CancelToken = axios.CancelToken;\n      var source = CancelToken.source();\n      axios({\n        method: 'get',\n        url: servicePath.getCategories,\n        cancelToken: source.token\n      }).then(function (res) {\n        source.cancel('方法被取消');\n        var options = [];\n\n        for (var i = 0; i < res.data.length; i++) {\n          options.push(__jsx(Option, {\n            key: res.data[i].id,\n            value: res.data[i].id.toString(36)\n          }, res.data[i].category_name));\n        }\n\n        setOptions(options);\n      })[\"catch\"](function (error) {\n        console.log(error);\n      });\n    };\n\n    function handleChange2(value) {\n      getlabs(value);\n      setSelectType(value);\n    }\n\n    var handleCancel = function handleCancel(e) {\n      setVisible(false);\n    };\n\n    marked.setOptions({\n      renderer: new marked.Renderer(),\n      gfm: true,\n      pedantic: false,\n      sanitize: false,\n      tables: true,\n      breaks: false,\n      smartLists: true,\n      smartypants: false\n    });\n\n    var handleChange1 = function handleChange1(value) {\n      setLabValue(value);\n    };\n\n    var changeIntroduce = function changeIntroduce(e) {\n      setIntroducemd(e.target.value);\n      var html = marked(e.target.value);\n      setIntroducehtml(html);\n    };\n\n    var pr = {\n      uid: '-1',\n      name: 'file',\n      multiple: false,\n      action: servicePath.uploadArticleImage,\n      headers: {\n        'Authorization': 'Bearer ' + token\n      },\n      onChange: function onChange(info) {\n        console.log('info', info);\n        var status = info.file.status;\n\n        if (status !== 'uploading') {\n          console.log(info.file, info.fileList);\n        }\n\n        if (status === 'done') {\n          var valuefile = mdeValue + \"![file](\".concat(info.file.response.file_path, \")\");\n          console.log(valuefile);\n          setMdeValue(valuefile);\n          setVisible(false);\n\n          _message.success(\"\".concat(info.file.name, \" \\u4E0A\\u4F20\\u6210\\u529F.\"));\n        } else if (status === 'error') {\n          _message.error(\"\".concat(info.file.name, \" file upload failed.\"));\n        }\n      }\n    };\n    var detail = useMemo(function () {\n      return getdetail(id);\n    }, [id]);\n    useEffect(function () {\n      setToken(localStorage.getItem('token'));\n\n      if (isLoading) {\n        {\n          detail;\n        }\n      }\n    }, [mdeValue, isLoading]);\n    return __jsx(_Layout, {\n      className: \"ly\"\n    }, __jsx(Head, null, __jsx(\"title\", null, \"\\u535A\\u4EBA\\u5802 -- \\u7F16\\u8F91\\u6587\\u7AE0\")), __jsx(Content, {\n      className: \"content\"\n    }, __jsx(_Row, {\n      gutter: 5\n    }, __jsx(_Col, {\n      span: 18\n    }, __jsx(_Row, {\n      gutter: 10\n    }, __jsx(_Col, {\n      span: 20\n    }, __jsx(_Input, {\n      value: articleTitle,\n      onChange: function onChange(e) {\n        setArticleTitle(e.target.value);\n      },\n      placeholder: \"\\u6807\\u9898\",\n      size: \"large\"\n    })), __jsx(_Col, {\n      span: 4\n    }, \"\\xA0\", __jsx(_Select, {\n      onChange: handleChange2,\n      defaultValue: selectedType + '',\n      size: \"large\"\n    }, options))), __jsx(\"br\", null), __jsx(_Row, {\n      gutter: 10\n    }, __jsx(_Col, {\n      span: 24\n    }, __jsx(SimpleMDE, {\n      options: {\n        autofocus: true,\n        autosave: {\n          enabled: zancun,\n          uniqueId: \"MyUniqueID\",\n          delay: 1000\n        },\n        toolbar: ['bold', 'italic', 'heading', \"code\", \"table\", \"clean-block\", 'quote', 'horizontal-rule', 'unordered-list', 'ordered-list', 'link', {\n          name: 'image',\n          action: function action() {\n            showModal();\n          },\n          className: 'fa fa-file-image-o',\n          title: '上传'\n        }, 'preview', 'side-by-side', 'fullscreen'],\n        spellChecker: false\n      },\n      onChange: handleChange,\n      value: mdeValue\n    })))), __jsx(_Col, {\n      span: 6\n    }, __jsx(_Row, null, __jsx(_Col, {\n      span: 24\n    }, __jsx(_Button, {\n      type: zancun ? 'primary' : 'default',\n      size: \"large\",\n      onClick: stopSave\n    }, \"\\u6682\\u5B58\\u6587\\u7AE0\"), \"\\xA0\", __jsx(_Button, {\n      onClick: onSubmit,\n      type: \"primary\",\n      size: \"large\"\n    }, \"\\u53D1\\u5E03\"), __jsx(\"br\", null)), __jsx(_Col, {\n      span: 24\n    }, __jsx(\"br\", null), __jsx(TextArea, {\n      rows: 4,\n      style: {\n        height: 154\n      },\n      value: introducemd,\n      onChange: changeIntroduce,\n      onPressEnter: changeIntroduce,\n      placeholder: \"\\u7B80\\u4ECB\"\n    }), __jsx(\"br\", null), __jsx(\"br\", null), __jsx(\"div\", {\n      className: \"introduce-html\",\n      dangerouslySetInnerHTML: {\n        __html: '简介：' + introducehtml\n      }\n    })), __jsx(_Col, {\n      span: 24,\n      style: {\n        marginTop: '20px'\n      }\n    }, __jsx(FmtContext.Provider, {\n      value: {\n        fmt: fmt,\n        setFmt: setFmt\n      }\n    }, __jsx(UploadImage, null)), fmt && __jsx(\"img\", {\n      src: fmt,\n      style: {\n        width: '100%',\n        marginTop: 10\n      }\n    })), __jsx(_Col, {\n      span: 24,\n      style: {\n        marginTop: '20px'\n      }\n    }, __jsx(_Select, {\n      mode: \"tags\",\n      type: {\n        isSelectOptGroup: false\n      },\n      style: {\n        width: '100%'\n      },\n      placeholder: \"\\u6807\\u7B7E\",\n      value: labValue,\n      onChange: handleChange1\n    }, children)), __jsx(_Col, {\n      span: 24,\n      style: {\n        marginTop: '20px'\n      }\n    }, __jsx(_Input, {\n      value: coin,\n      onChange: function onChange(e) {\n        setCoin(e.target.value);\n      },\n      placeholder: \"\\u652F\\u4ED8\\u79EF\\u5206\"\n    })), __jsx(_Col, {\n      span: 17,\n      style: {\n        marginTop: '20px'\n      }\n    }, __jsx(_Input, {\n      value: baiduurl,\n      onChange: function onChange(e) {\n        setBaiduurl(e.target.value);\n      },\n      placeholder: \"\\u767E\\u5EA6\\u4E91\\u76D8\\u7684\\u94FE\\u63A5\\u5730\\u5740\"\n    })), __jsx(_Col, {\n      span: 1,\n      style: {\n        marginTop: '20px'\n      }\n    }), __jsx(_Col, {\n      span: 6,\n      style: {\n        marginTop: '20px'\n      }\n    }, __jsx(_Input, {\n      value: baidupwd,\n      onChange: function onChange(e) {\n        setBaidupwd(e.target.value);\n      },\n      placeholder: \"\\u5BC6\\u7801\"\n    })), __jsx(_Col, {\n      span: 24,\n      style: {\n        marginTop: '20px'\n      }\n    }, __jsx(_Input, {\n      value: count,\n      onChange: function onChange(e) {\n        setCount(e.target.value);\n      },\n      placeholder: \"\\u8BFE\\u7A0B\\u6570/\\u8D44\\u6E90\\u5927\\u5C0F\"\n    })))))), __jsx(_BackTop, null), __jsx(_Modal, {\n      footer: null,\n      title: \"\\u4E0A\\u4F20\\u56FE\\u7247\",\n      visible: visible,\n      onCancel: handleCancel\n    }, __jsx(Dragger, pr, __jsx(\"p\", {\n      className: \"ant-upload-drag-icon\"\n    }, __jsx(_Icon, {\n      type: \"inbox\"\n    })), __jsx(\"p\", {\n      className: \"ant-upload-text\"\n    }, \"\\u70B9\\u51FB\\u6216\\u62D6\\u62FD\\u4E0A\\u4F20\\u56FE\\u7247\"), __jsx(\"p\", {\n      className: \"ant-upload-hint\"\n    }, \"\\u652F\\u6301\\u5355\\u6B21\\u6216\\u6279\\u91CF\\u4E0A\\u4F20\\u3002\\u652F\\u6301\\u56FE\\u7247\\u683C\\u5F0F\\u6587\\u4EF6\"))));\n  }), [];\n});\n\nCreate.getInitialProps = function _callee(context) {\n  var id, promise;\n  return _regeneratorRuntime.async(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          id = context.ctx.query.id;\n          console.log('id', typeof id != \"undefined\");\n\n          if (!(_JSON$stringify(context.ctx.query) != \"{}\" && typeof id != \"undefined\")) {\n            _context.next = 9;\n            break;\n          }\n\n          promise = new _Promise(function (resolve) {\n            resolve({\n              id: id\n            });\n          });\n          _context.next = 6;\n          return _regeneratorRuntime.awrap(promise);\n\n        case 6:\n          return _context.abrupt(\"return\", _context.sent);\n\n        case 9:\n          _context.next = 11;\n          return _regeneratorRuntime.awrap(new _Promise(function (resolve) {\n            resolve({});\n          }));\n\n        case 11:\n          return _context.abrupt(\"return\", _context.sent);\n\n        case 12:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  });\n};\n\nexport default Create;","map":{"version":3,"sources":["/Users/mac/Desktop/liy-blog/pages/create.js"],"names":["React","useState","useEffect","createContext","useMemo","memo","marked","axios","Head","servicePath","Router","dynamic","FmtContext","Dragger","UploadImage","ssr","SimpleMDE","Content","Option","TextArea","Create","props","console","log","id","setId","token","setToken","visible","setVisible","articleTitle","setArticleTitle","introducemd","setIntroducemd","introducehtml","setIntroducehtml","selectedType","setSelectType","options","setOptions","isLoading","setIsLoading","coin","setCoin","baiduurl","setBaiduurl","baidupwd","setBaidupwd","count","setCount","fmt","setFmt","children","setChildren","zancun","setZancun","mdeValue","setMdeValue","labValue","setLabValue","handleChange","value","showModal","getdetail","CancelToken","source","method","url","getArticleDetail","withCredentials","cancelToken","then","res","cancel","data","title","desc","category_id","baiduyu_pwd","baiduyu_url","content","tags","getcategory","getlabs","error","getLabs","transformResponse","indexOf","window","location","href","eval","labs","item","push","label","stopSave","onSubmit","values","join","dataProps","localStorage","getItem","headers","JSON","parse","errors","addArticle","getCategories","i","length","toString","category_name","handleChange2","handleCancel","e","renderer","Renderer","gfm","pedantic","sanitize","tables","breaks","smartLists","smartypants","handleChange1","changeIntroduce","target","html","pr","uid","name","multiple","action","uploadArticleImage","onChange","info","status","file","fileList","valuefile","response","file_path","success","detail","autofocus","autosave","enabled","uniqueId","delay","toolbar","className","spellChecker","height","__html","marginTop","width","isSelectOptGroup","getInitialProps","context","ctx","query","promise","resolve"],"mappings":"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","sourcesContent":["// import dynamic from 'next/dynamic'\n// const Createoredit = dynamic(\n//     import('../components/createoredit'),\n//     {\n//         ssr: false   //这个要加上,禁止使用 SSR\n//     }\n// )\n\n// export default () => <Createoredit />\n\nimport React, { useState, useEffect, createContext, useMemo, memo } from 'react';\nimport marked from 'marked'\nimport axios from 'axios'\nimport \"easymde/dist/easymde.min.css\";\nimport { Layout, Row, Col, Input, Select, Button, Upload, Modal, Icon, message, BackTop } from 'antd'\nimport Head from 'next/head'\nimport servicePath from '../config/apiUrl';\nimport Router from 'next/router'\nimport dynamic from 'next/dynamic'\nexport const FmtContext = createContext({})\nconst { Dragger } = Upload;\nconst UploadImage = dynamic(\n    import(\"../components/UploadImage\"),\n    {\n        ssr: false   //这个要加上,禁止使用 SSR\n    }\n)\n\nconst SimpleMDE = dynamic(\n    import(\"react-simplemde-editor\"),\n    {\n        ssr: false   //这个要加上,禁止使用 SSR\n    }\n)\n\n\n\nconst { Content } = Layout;\nconst Option = Select.Option;\nconst { TextArea } = Input\n\n\n\nconst Create = useMemo(()=>{(props) => {\n    console.log('id', props.id)\n    const [id, setId] = useState(JSON.stringify(props) != \"{}\" && props.id?props.id:null)\n    const [token, setToken] = useState()\n    const [visible, setVisible] = useState(false)\n    const [articleTitle, setArticleTitle] = useState()\n    const [introducemd, setIntroducemd] = useState()\n    const [introducehtml, setIntroducehtml] = useState('等待编辑')\n    const [selectedType, setSelectType] = useState(1)\n    const [options, setOptions] = useState([])\n    const [isLoading, setIsLoading] = useState(true)\n    const [coin, setCoin] = useState()\n    const [baiduurl, setBaiduurl] = useState()\n    const [baidupwd, setBaidupwd] = useState()\n    const [count, setCount] = useState()\n    const [fmt, setFmt] = useState()\n    const [children, setChildren] = useState([])\n    const [zancun, setZancun] = useState(false)\n    const [mdeValue, setMdeValue] = useState()//文章文章内容\n    const [labValue, setLabValue] = useState()//文章文章内容\n    const handleChange = value => {\n        setMdeValue(value)\n    };\n    const showModal = () => {\n        setVisible(true)\n    };\n\n    const getdetail = (id) => {\n        const CancelToken = axios.CancelToken;\n        const source = CancelToken.source();\n        axios({\n            method: 'get',\n            url: servicePath.getArticleDetail + id,\n            withCredentials: false,\n            cancelToken: source.token,\n        }).then(\n            res => {\n                console.log('meiyou','meiyou')\n                source.cancel('方法被取消');\n                setArticleTitle(res.data.data.title);\n                setIntroducemd(res.data.data.desc);\n                setIntroducehtml(res.data.data.desc);\n                setSelectType(res.data.data.category_id)\n                setCoin(res.data.data.coin)\n                setBaidupwd(res.data.data.baiduyu_pwd)\n                setBaiduurl(res.data.data.baiduyu_url)\n                setCount(res.data.data.count)\n                setFmt(res.data.data.fmt);\n                setMdeValue(res.data.data.content)\n                console.log('tags',res.data.data.tags)\n                setLabValue(res.data.data.tags)\n                getcategory()\n                getlabs(res.data.data.category_id)\n            }\n        ).catch(function (error) {\n            console.log(error)\n        });\n    };\n\n\n    const getlabs = (selectedType) => {\n        const CancelToken = axios.CancelToken;\n        const source = CancelToken.source();\n        axios({\n            method: 'get',\n            url: servicePath.getLabs + '?id=' + selectedType,\n            cancelToken: source.token,\n            transformResponse: function (data) {\n                console.log(data)\n                if (data.indexOf('Unauthenticated') != -1) {\n                    source.cancel('方法被取消');\n                    window.location.href = '/'\n                } else {\n                    return data;\n                }\n            }\n        }).then(\n            res => {\n                setIsLoading(false)\n                res.data = eval('(' + res.data + ')');\n                source.cancel('方法被取消');\n                let labs = [];\n                for (let item in res.data.data) {\n                    labs.push(<Option key={item} value={res.data.data[item].label}>{res.data.data[item].label}</Option>)\n                }\n\n                setChildren(labs)\n            }\n        ).catch(function (error) {\n            console.log(error)\n        });\n    }\n\n\n\n    const stopSave = () => {\n        //localStorage.setItem('zancun', !zancun)\n        setZancun(!zancun)\n    }\n\n    const onSubmit = () => {\n        if (!articleTitle) {\n            message.error('文章标题不能为空')\n            return false\n        } else if (!introducehtml) {\n            message.error('文章简介不能为空')\n            return false\n        } else if (!selectedType) {\n            message.error('文章类型不能为空')\n            return false\n        }\n\n        if (JSON.stringify(props) != \"{}\" && props.id) {\n            let values = labValue.join(',')\n            let dataProps = {\n                'id': props.id,\n                'title': articleTitle,\n                'desc': introducehtml,\n                'category_id': selectedType,\n                'content': mdeValue,\n                'coin': coin,\n                'fmt': fmt,\n                'user_id': localStorage.getItem('user_id'),\n                'biaoqian': values,\n                'baiduyu_url': baiduurl,\n                'baiduyu_pwd': baidupwd,\n                'count': count,\n                'status': localStorage.getItem('user_id') == 1 ? 1 : 0,\n            }\n\n\n\n            axios({\n                method: 'patch',\n                url: servicePath.getArticleDetail + props.id,\n                data: dataProps,\n                headers: {\n                    'Authorization': 'Bearer ' + localStorage.getItem('token'),\n                }, transformResponse: function (data) {\n                    if (data.indexOf('errors') != -1) {\n                        data = JSON.parse(data);\n                        for (var item in data.errors) {\n                            message.error(data.errors[item][0]);\n                        }\n                    } else if (data.indexOf('Unauthenticated') != -1) {\n                        Router.push('/')\n                    } else {\n                        return data;\n                    }\n                }\n            }).then(\n                res => {\n                    console.log(res)\n                    Router.push('/')\n                }\n            ).catch(function (error) {\n                console.log(error)\n            });\n\n        } else {\n            let dataProps = {\n                'title': articleTitle,\n                'desc': introducehtml,\n                'category_id': selectedType,\n                'content': mdeValue,\n                'coin': coin,\n                'fmt': fmt,\n                'user_id': localStorage.getItem('user_id'),\n                'biaoqian': labValue,\n                'baiduyu_url': baiduurl,\n                'baiduyu_pwd': baidupwd,\n                'count': count,\n                'status': localStorage.getItem('user_id') == 1 ? 1 : 0,\n            }\n\n            axios({\n                method: 'post',\n                url: servicePath.addArticle,\n                data: dataProps,\n                headers: {\n                    'Authorization': 'Bearer ' + localStorage.getItem('token'),\n                }, transformResponse: function (data) {\n                    if (data.indexOf('errors') != -1) {\n                        data = JSON.parse(data);\n                        for (var item in data.errors) {\n                            message.error(data.errors[item][0]);\n                        }\n                    } else if (data.indexOf('Unauthenticated') != -1) {\n                        Router.push('/')\n                    } else {\n                        return data;\n                    }\n                }\n            }).then(\n                res => {\n                    console.log(res)\n                    Router.push('/')\n                }\n            ).catch(function (error) {\n                console.log(error)\n            });\n        }\n    }\n\n    const getcategory = () => {\n        const CancelToken = axios.CancelToken;\n        const source = CancelToken.source();\n        axios({\n            method: 'get',\n            url: servicePath.getCategories,\n            cancelToken: source.token,\n        }).then(\n            res => {\n                source.cancel('方法被取消');\n                let options = [];\n                for (let i = 0; i < res.data.length; i++) {\n                    options.push(<Option key={res.data[i].id} value={res.data[i].id.toString(36)}>{res.data[i].category_name}</Option>)\n                }\n                setOptions(options)\n            }\n        ).catch(function (error) {\n            console.log(error)\n        });\n    }\n\n    function handleChange2(value) {\n        getlabs(value)\n        setSelectType(value)\n    }\n    const handleCancel = e => {\n        setVisible(false)\n    };\n\n\n\n    marked.setOptions({\n        renderer: new marked.Renderer(),\n        gfm: true,\n        pedantic: false,\n        sanitize: false,\n        tables: true,\n        breaks: false,\n        smartLists: true,\n        smartypants: false,\n    });\n\n\n\n    const handleChange1 = value => {\n        setLabValue(value)\n    }\n\n\n\n    const changeIntroduce = (e) => {\n        setIntroducemd(e.target.value)\n        let html = marked(e.target.value)\n        setIntroducehtml(html)\n    }\n\n    const pr = {\n        uid: '-1',\n        name: 'file',\n        multiple: false,\n        action: servicePath.uploadArticleImage,\n        headers: {\n            'Authorization': 'Bearer ' + token,\n        },\n        onChange(info) {\n            console.log('info', info)\n            const { status } = info.file;\n\n            if (status !== 'uploading') {\n                console.log(info.file, info.fileList);\n            }\n            if (status === 'done') {\n                \n                let valuefile = mdeValue + `![file](${info.file.response.file_path})`;\n                console.log(valuefile)\n                setMdeValue(valuefile)\n                setVisible(false)\n                message.success(`${info.file.name} 上传成功.`);\n            } else if (status === 'error') {\n                message.error(`${info.file.name} file upload failed.`);\n            }\n        },\n    };\n\n    const detail=useMemo(()=>getdetail(id),[id])\n\n    useEffect(() => {\n        setToken(localStorage.getItem('token'))\n        if (isLoading) {\n            {detail}\n        }\n    },[mdeValue,isLoading])\n\n\n\n\n\n    return (\n        <Layout className=\"ly\">\n            <Head>\n                <title>博人堂 -- 编辑文章</title>\n            </Head>\n            <Content className=\"content\">\n                <Row gutter={5}>\n                    <Col span={18}>\n                        <Row gutter={10} >\n                            <Col span={20}>\n                                <Input\n                                    value={articleTitle}\n                                    onChange={(e) => { setArticleTitle(e.target.value) }}\n                                    placeholder=\"标题\"\n                                    size=\"large\" />\n                            </Col>\n                            <Col span={4}>\n                                &nbsp;\n                                <Select\n                                    onChange={handleChange2}\n                                    defaultValue={selectedType + ''}\n                                    size=\"large\">\n                                    {options}\n                                </Select>\n                            </Col>\n                        </Row>\n                        <br />\n                        <Row gutter={10} >\n                            <Col span={24}>\n                                <SimpleMDE options={{\n                                    autofocus: true,\n                                    autosave: { enabled: zancun, uniqueId: \"MyUniqueID\", delay: 1000, },\n                                    toolbar: ['bold', 'italic', 'heading',\n                                        \"code\", \"table\", \"clean-block\", 'quote',\n                                        'horizontal-rule', 'unordered-list',\n                                        'ordered-list', 'link',\n                                        {\n                                            name: 'image',\n                                            action: () => {\n                                                showModal()\n                                            },\n                                            className: 'fa fa-file-image-o',\n                                            title: '上传',\n                                        }, 'preview',\n                                        'side-by-side', 'fullscreen'],\n                                    spellChecker: false\n                                }}\n                                    onChange={handleChange}\n                                    value={mdeValue}\n                                />\n                            </Col>\n                        </Row>\n\n                    </Col>\n\n                    <Col span={6}>\n                        <Row>\n                            <Col span={24}>\n                                <Button type={zancun ? 'primary' : 'default'} size=\"large\" onClick={stopSave}>暂存文章</Button>&nbsp;\n                                <Button onClick={onSubmit} type=\"primary\" size=\"large\" >发布</Button>\n                                <br />\n                            </Col>\n\n                            <Col span={24}>\n                                <br />\n                                <TextArea\n                                    rows={4}\n                                    style={{ height: 154 }}\n                                    value={introducemd}\n                                    onChange={changeIntroduce}\n                                    onPressEnter={changeIntroduce}\n                                    placeholder=\"简介\"\n                                />\n                                <br /><br />\n                                <div\n                                    className=\"introduce-html\"\n                                    dangerouslySetInnerHTML={{ __html: '简介：' + introducehtml }} >\n                                </div>\n                            </Col>\n\n                            <Col span={24} style={{ marginTop: '20px' }}>\n                                <FmtContext.Provider value={{ fmt, setFmt }}>\n                                    <UploadImage />\n                                </FmtContext.Provider>\n                                {fmt && <img src={fmt} style={{ width: '100%', marginTop: 10 }} />}\n                            </Col>\n\n                            <Col span={24} style={{ marginTop: '20px' }}>\n                                <Select\n                                    mode=\"tags\"\n                                    type={{ isSelectOptGroup: false }}\n                                    style={{ width: '100%' }}\n                                    placeholder=\"标签\"\n                                    value={labValue}\n                                    onChange={handleChange1}\n                                >\n                                    {children}\n                                </Select>\n                            </Col>\n\n                            <Col span={24} style={{ marginTop: '20px' }}>\n                                <Input\n                                    value={coin}\n                                    onChange={(e) => { setCoin(e.target.value) }}\n                                    placeholder=\"支付积分\" />\n                            </Col>\n\n                            <Col span={17} style={{ marginTop: '20px' }}>\n                                <Input\n                                    value={baiduurl}\n                                    onChange={(e) => { setBaiduurl(e.target.value) }}\n                                    placeholder=\"百度云盘的链接地址\" />\n                            </Col>\n\n                            <Col span={1} style={{ marginTop: '20px' }}>\n                            </Col>\n\n\n                            <Col span={6} style={{ marginTop: '20px' }}>\n                                <Input\n                                    value={baidupwd}\n                                    onChange={(e) => { setBaidupwd(e.target.value) }}\n                                    placeholder=\"密码\" />\n                            </Col>\n\n                            <Col span={24} style={{ marginTop: '20px' }}>\n                                <Input\n                                    value={count}\n                                    onChange={(e) => { setCount(e.target.value) }}\n                                    placeholder=\"课程数/资源大小\" />\n                            </Col>\n                        </Row>\n                    </Col>\n                </Row>\n            </Content>\n            <BackTop />\n            <Modal\n                footer={null}\n                title=\"上传图片\"\n                visible={visible} onCancel={handleCancel}>\n\n                <Dragger {...pr}>\n                    <p className=\"ant-upload-drag-icon\">\n                        <Icon type=\"inbox\" />\n                    </p>\n                    <p className=\"ant-upload-text\">点击或拖拽上传图片</p>\n                    <p className=\"ant-upload-hint\">\n                        支持单次或批量上传。支持图片格式文件\n                    </p>\n                </Dragger>\n            </Modal>\n        </Layout>\n    )\n},[]})\n\nCreate.getInitialProps = async (context) => {\n    let id = context.ctx.query.id\n    console.log('id', typeof id != \"undefined\")\n    if (JSON.stringify(context.ctx.query) != \"{}\" && typeof id != \"undefined\") {\n        const promise = new Promise((resolve) => {\n            resolve({id:id})\n        })\n        return await promise\n    } else {\n        return await new Promise(resolve => {\n            resolve({})\n        })\n    }\n}\n\nexport default Create"]},"metadata":{},"sourceType":"module"}