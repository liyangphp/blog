{"ast":null,"code":"import _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _Card from \"antd/lib/card\";\nimport _Row from \"antd/lib/row\";\nimport _Col from \"antd/lib/col\";\nimport _Avatar from \"antd/lib/avatar\";\nimport _Divider from \"antd/lib/divider\";\nimport _Icon from \"antd/lib/icon\";\nimport _Tag from \"antd/lib/tag\";\nimport _message from \"antd/lib/message\";\nimport _Layout from \"antd/lib/layout\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport axios from \"axios\";\nimport CodeList from '../components/CodeList';\nimport ArticleList from '../components/ArticleList';\nimport servicePath from '../config/apiUrl';\nconst {\n  Content\n} = _Layout;\n\nconst Center = props => {\n  const {\n    0: token,\n    1: setToken\n  } = useState();\n  const {\n    0: user,\n    1: setUser\n  } = useState();\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState(true);\n  const {\n    0: dataLoading,\n    1: setDataLoading\n  } = useState(true);\n  const {\n    0: tabKey,\n    1: setTabKey\n  } = useState(\"articles\");\n  const {\n    0: data,\n    1: setData\n  } = useState([]);\n  const {\n    0: third,\n    1: setThird\n  } = useState();\n  const {\n    0: articleCount,\n    1: setArticleCount\n  } = useState(0);\n  const {\n    0: projectCount,\n    1: setProjectCount\n  } = useState(0);\n  const {\n    0: address,\n    1: setAddress\n  } = useState([]);\n  const {\n    0: tags,\n    1: setTags\n  } = useState([]);\n  const {\n    0: addr,\n    1: setAddr\n  } = useState();\n\n  const onTabChange = key => {\n    setTabKey(key);\n    getList(props.id, key);\n  };\n\n  const operationTabList = [{\n    key: 'articles',\n    tab: __jsx(\"span\", null, \"\\u6587\\u7AE0 \", __jsx(\"span\", {\n      style: {\n        fontSize: 14\n      }\n    }, \"(\", articleCount, \")\"))\n  }, {\n    key: 'applications',\n    tab: __jsx(\"span\", null, \"\\u6E90\\u7801 \", __jsx(\"span\", {\n      style: {\n        fontSize: 14\n      }\n    }, \"(\", projectCount, \")\"))\n  }];\n\n  const renderChildrenByTabKey = tabKey => {\n    if (tabKey === 'applications') {\n      return __jsx(CodeList, {\n        list: data\n      });\n    }\n\n    if (tabKey === 'articles') {\n      return __jsx(ArticleList, {\n        list: data\n      });\n    }\n\n    return null;\n  }; //获取会员数据\n\n\n  const checkLogin = () => {\n    const CancelToken = axios.CancelToken;\n    const source = CancelToken.source();\n\n    if (token != null) {\n      axios({\n        method: 'get',\n        url: '/api/v1/user/' + user_id,\n        withCredentials: false,\n        cancelToken: source.token,\n        transformResponse: function (data) {\n          if (data.indexOf('errors') != -1) {\n            data = JSON.parse(data);\n\n            for (var item in data.errors) {\n              _message.error(data.errors[item][0]);\n            }\n          } else if (data.indexOf('Unauthenticated') != -1) {\n            localStorage.removeItem('token');\n            localStorage.removeItem('user_id');\n            return data;\n          } else {\n            return data;\n          }\n        }\n      }).then(res => {\n        source.cancel('方法被取消');\n        setIsLoading(false);\n        res.data = eval('(' + res.data + ')');\n        setDataLoading(false);\n        getList(res.data.data.id, tabKey);\n        getThird(res.data.data.id);\n      }).catch(function (error) {\n        console.log(error);\n      });\n    } else {\n      console.log('asasdas3');\n    }\n  }; //获取用户第三方信息\n\n\n  const getThird = id => {\n    const CancelToken = axios.CancelToken;\n    const source = CancelToken.source();\n    axios({\n      method: 'get',\n      url: servicePath.getThird + '?user_id=' + id,\n      withCredentials: false,\n      headers: {\n        'Authorization': 'Bearer ' + token\n      },\n      cancelToken: source.token\n    }).then(res => {\n      source.cancel('方法被取消');\n      setArticleCount(res.data.data ? res.data.data.article_count : 0);\n      setProjectCount(res.data.data ? res.data.data.project_count : 0);\n      setThird(res.data.data);\n      setTags(res.data.data.tags.split(\",\"));\n      getName(res.data.data.province_id);\n      getName(res.data.data.city_id);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }; //获取地名\n\n\n  const getName = id => {\n    axios({\n      method: 'get',\n      url: servicePath.getAddressName + '?id=' + id,\n      withCredentials: false\n    }).then(res => {\n      console.log(res);\n      let arr = address;\n\n      if (arr.indexOf(res.data.data.name) == -1) {\n        arr.push(res.data.data.name);\n      }\n\n      setAddress(arr);\n      setAddr(address.join(' '));\n    });\n  }; //获取用户的文章，源码\n\n\n  const getList = (id, tabKey) => {\n    let category_id = 1;\n\n    if (tabKey === \"articles\") {\n      category_id = 1;\n    } else {\n      category_id = 4;\n    }\n\n    console.log('tabkey', tabKey);\n    axios({\n      method: 'get',\n      url: servicePath.getUserArticle + '?user_id=' + props.id + '&category_id=' + category_id,\n      withCredentials: false,\n      headers: {\n        'Authorization': 'Bearer ' + localStorage.getItem('token')\n      }\n    }).then(res => {\n      console.log(res);\n      setIsLoading(false);\n      setDataLoading(false);\n\n      for (let item in res.data.data) {\n        res.data.data[item].biaoqian = res.data.data[item].biaoqian.split(\",\");\n        res.data.data[item].labes = [];\n        res.data.data[item].href = \"/detail?id=\" + res.data.data[item].id;\n\n        for (let i = 0; i < res.data.data[item].biaoqian.length; i++) {\n          res.data.data[item].labes.push(__jsx(_Tag, {\n            key: i,\n            size: \"small\"\n          }, res.data.data[item].biaoqian[i]));\n        }\n      }\n\n      getThird(id);\n      setData(res.data.data);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  useEffect(() => {\n    if (isLoading) {\n      getList(props.id, tabKey); //getThird(props.id)\n    }\n  }, []);\n  return __jsx(Content, {\n    style: {\n      padding: '0 1rem',\n      margin: '1rem auto'\n    }\n  }, __jsx(_Row, {\n    gutter: 24\n  }, __jsx(_Col, {\n    lg: 7,\n    md: 24\n  }, __jsx(_Card, {\n    bordered: false,\n    style: {\n      marginBottom: 24\n    },\n    loading: dataLoading\n  }, !dataLoading && __jsx(\"div\", null, __jsx(\"div\", {\n    className: \"avatarHolder\"\n  }, __jsx(\"img\", {\n    alt: \"\",\n    src: props.avatar\n  }), __jsx(\"div\", {\n    className: \"name\"\n  }, props.name), __jsx(\"div\", null, props.introduction)), third && __jsx(\"div\", {\n    className: \"detail\"\n  }, __jsx(\"p\", null, __jsx(_Icon, {\n    type: \"deployment-unit\"\n  }), __jsx(\"span\", null, third.professional)), __jsx(\"p\", null, __jsx(_Icon, {\n    type: \"apartment\"\n  }), __jsx(\"span\", null, third.company)), __jsx(\"p\", null, __jsx(_Icon, {\n    type: \"environment\"\n  }), __jsx(\"span\", null, addr))), third && __jsx(_Divider, {\n    dashed: true\n  }), third && __jsx(\"div\", null, __jsx(\"div\", {\n    style: {\n      marginBottom: 12,\n      color: \"rgba(0,0,0,0.85)\"\n    }\n  }, \"\\u6807\\u7B7E\"), __jsx(\"div\", {\n    style: {\n      lineHeight: '30px'\n    }\n  }, tags && tags.map(item => __jsx(_Tag, {\n    key: item\n  }, item)))), third && __jsx(_Divider, {\n    style: {\n      marginTop: 26\n    },\n    dashed: true\n  }), third && __jsx(\"div\", {\n    className: \"team\"\n  }, __jsx(\"div\", {\n    style: {\n      marginBottom: 12,\n      color: \"rgba(0,0,0,0.85)\"\n    }\n  }, \"\\u793E\\u4EA4\\u8D26\\u53F7\"), __jsx(_Row, {\n    gutter: 36\n  }, __jsx(_Col, {\n    lg: 8,\n    xl: 8,\n    className: \"sjitem\"\n  }, __jsx(_Avatar, {\n    size: 28,\n    icon: \"github\",\n    className: \"account\"\n  }), __jsx(\"div\", {\n    className: \"mz\"\n  }, \"github\")), __jsx(_Col, {\n    lg: 8,\n    xl: 8,\n    className: \"sjitem\"\n  }, __jsx(_Avatar, {\n    size: 28,\n    icon: \"qq\",\n    className: \"account\"\n  }), __jsx(\"div\", {\n    className: \"mz\"\n  }, \"QQ\")), __jsx(_Col, {\n    lg: 8,\n    xl: 8,\n    className: \"sjitem\"\n  }, __jsx(_Avatar, {\n    size: 28,\n    icon: \"wechat\",\n    className: \"account\"\n  }), __jsx(\"div\", {\n    className: \"mz\"\n  }, \"\\u5FAE\\u4FE1\"))))))), __jsx(_Col, {\n    lg: 17,\n    md: 24\n  }, __jsx(_Card, {\n    className: \"tabsCard\",\n    bordered: false,\n    tabList: operationTabList,\n    activeTabKey: tabKey,\n    onTabChange: onTabChange\n  }, renderChildrenByTabKey(tabKey)))));\n};\n\nCenter.getInitialProps = async context => {\n  console.log('context', context);\n  let id = context.ctx.query.user_id;\n  const promise = new _Promise(resolve => {\n    axios(servicePath.getUser + id).then(res => {\n      console.log('user1', res);\n      resolve(res.data.data);\n    });\n  });\n  return await promise;\n};\n\nexport default Center;","map":{"version":3,"sources":["/Users/mac/Desktop/liy-blog/pages/center.js"],"names":["React","useState","useEffect","axios","CodeList","ArticleList","servicePath","Content","Center","props","token","setToken","user","setUser","isLoading","setIsLoading","dataLoading","setDataLoading","tabKey","setTabKey","data","setData","third","setThird","articleCount","setArticleCount","projectCount","setProjectCount","address","setAddress","tags","setTags","addr","setAddr","onTabChange","key","getList","id","operationTabList","tab","fontSize","renderChildrenByTabKey","checkLogin","CancelToken","source","method","url","user_id","withCredentials","cancelToken","transformResponse","indexOf","JSON","parse","item","errors","error","localStorage","removeItem","then","res","cancel","eval","getThird","catch","console","log","headers","article_count","project_count","split","getName","province_id","city_id","getAddressName","arr","name","push","join","category_id","getUserArticle","getItem","biaoqian","labes","href","i","length","padding","margin","marginBottom","avatar","introduction","professional","company","color","lineHeight","map","marginTop","getInitialProps","context","ctx","query","promise","resolve","getUser"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { Avatar, Button, Card, Col, Divider, Icon, Input, Layout, message, Row, Tag } from 'antd';\nimport axios from \"axios\";\nimport CodeList from '../components/CodeList'\nimport ArticleList from '../components/ArticleList'\nimport servicePath from '../config/apiUrl';\n\nconst { Content } = Layout;\n\nconst Center = (props) => {\n    const [token, setToken] = useState()\n    const [user, setUser] = useState()\n    const [isLoading, setIsLoading] = useState(true)\n    const [dataLoading, setDataLoading] = useState(true)\n    const [tabKey, setTabKey] = useState(\"articles\")\n    const [data, setData] = useState([])\n    const [third, setThird] = useState()\n    const [articleCount, setArticleCount] = useState(0)\n    const [projectCount, setProjectCount] = useState(0)\n    const [address, setAddress] = useState([])\n    const [tags, setTags] = useState([])\n    const [addr, setAddr] = useState()\n    const onTabChange = (key) => {\n        setTabKey(key)\n        getList(props.id, key)\n    };\n    const operationTabList = [\n        {\n            key: 'articles',\n            tab: (\n                <span>\n                    文章 <span style={{ fontSize: 14 }}>({articleCount})</span>\n                </span>\n            ),\n        },\n        {\n            key: 'applications',\n            tab: (\n                <span>\n                    源码 <span style={{ fontSize: 14 }}>({projectCount})</span>\n                </span>\n            ),\n        }\n    ];\n\n    const renderChildrenByTabKey = (tabKey) => {\n        if (tabKey === 'applications') {\n            return <CodeList list={data} />;\n            \n        }\n        if (tabKey === 'articles') {\n            return <ArticleList list={data} />;\n        }\n        return null;\n    };\n    //获取会员数据\n    const checkLogin = () => {\n        const CancelToken = axios.CancelToken;\n        const source = CancelToken.source();\n        if (token != null) {\n            axios({\n                method: 'get',\n                url: '/api/v1/user/'+user_id,\n                withCredentials: false,\n                cancelToken: source.token,\n                transformResponse: function (data) {\n                    if (data.indexOf('errors') != -1) {\n                        data = JSON.parse(data);\n                        for (var item in data.errors) {\n                            message.error(data.errors[item][0]);\n                        }\n                    } else if (data.indexOf('Unauthenticated') != -1) {\n                        localStorage.removeItem('token')\n                        localStorage.removeItem('user_id')\n                        return data;\n                    } else {\n                        return data;\n                    }\n                }\n            }).then(\n                res => {\n                    source.cancel('方法被取消');\n                    setIsLoading(false)\n                    res.data = eval('(' + res.data + ')');\n                    setDataLoading(false)\n                    getList(res.data.data.id,tabKey)\n                    getThird(res.data.data.id)\n                }\n            ).catch(function (error) {\n                console.log(error)\n            });\n        } else {\n            console.log('asasdas3')\n        }\n    }\n\n    //获取用户第三方信息\n    const getThird = (id) =>{\n        const CancelToken = axios.CancelToken;\n        const source = CancelToken.source();\n        axios({\n            method: 'get',\n            url: servicePath.getThird+'?user_id='+id,\n            withCredentials: false,\n            headers: {\n                'Authorization': 'Bearer ' + token,\n            },\n            cancelToken: source.token,\n        }).then(\n            res => {\n                source.cancel('方法被取消');\n                setArticleCount(res.data.data?res.data.data.article_count:0)\n\n                setProjectCount(res.data.data?res.data.data.project_count:0)\n\n                setThird(res.data.data)\n\n                setTags(res.data.data.tags.split(\",\"))\n\n                getName(res.data.data.province_id)\n\n                getName(res.data.data.city_id)\n            }\n        ).catch(function (error) {\n            console.log(error)\n        });\n    }\n\n    //获取地名\n\n    const getName=(id) =>{\n        axios({\n            method: 'get',\n            url: servicePath.getAddressName+'?id=' + id,\n            withCredentials: false,\n        }).then(\n            res => {\n                console.log(res)\n                let arr=address;\n                if(arr.indexOf(res.data.data.name)==-1){\n                    arr.push(res.data.data.name)\n                }\n\n                setAddress(arr)\n\n                setAddr(address.join(' '))\n            }\n        );\n    }\n\n    //获取用户的文章，源码\n    const getList = (id,tabKey) => {\n        let category_id =1;\n        if(tabKey===\"articles\"){\n            category_id =1\n        }else{\n            category_id =4\n        }\n        console.log('tabkey',tabKey)\n        axios({\n            method: 'get',\n            url: servicePath.getUserArticle+'?user_id=' + props.id+'&category_id='+category_id,\n            withCredentials: false,\n            headers: {\n                'Authorization': 'Bearer ' + localStorage.getItem('token'),\n            },\n        }).then(\n            res => {\n                console.log(res)\n                setIsLoading(false)\n                setDataLoading(false)\n                for (let item in res.data.data) {\n                    res.data.data[item].biaoqian = res.data.data[item].biaoqian.split(\",\");\n                    res.data.data[item].labes = [];\n                    res.data.data[item].href = \"/detail?id=\" + res.data.data[item].id\n                    for (let i = 0; i < res.data.data[item].biaoqian.length; i++) {\n                        res.data.data[item].labes.push(<Tag key={i}\n                                                            size=\"small\">{res.data.data[item].biaoqian[i]}</Tag>)\n                    }\n                }\n\n                getThird(id)\n                setData(res.data.data)\n            }\n        ).catch(function (error) {\n            console.log(error)\n        });\n    }\n\n\n    useEffect(() => {\n        if (isLoading) {\n            getList(props.id, tabKey)\n            //getThird(props.id)\n        }\n    },[])\n    return (\n        <Content style={{ padding: '0 1rem', margin:'1rem auto' }}>\n            <Row gutter={24}>\n                <Col lg={7} md={24}>\n                    <Card bordered={false} style={{ marginBottom: 24 }} loading={dataLoading}>\n                        {!dataLoading && (\n                            <div>\n                                <div className=\"avatarHolder\">\n                                    <img alt=\"\" src={props.avatar} />\n                                    <div className=\"name\">{props.name}</div>\n                                    <div>{props.introduction}</div>\n                                </div>\n                                {third && <div className=\"detail\">\n                                    <p>\n                                        <Icon type=\"deployment-unit\" />\n                                        <span>{third.professional}</span>\n                                    </p>\n                                    <p>\n                                        <Icon type=\"apartment\" />\n                                        <span>{third.company}</span>\n                                    </p>\n                                    <p>\n                                        <Icon type=\"environment\" />\n                                        <span>{addr}</span>\n                                    </p>\n                                </div>}\n                                {third && <Divider dashed />}\n                                {third && <div>\n                                    <div style={{ marginBottom: 12, color: \"rgba(0,0,0,0.85)\" }}>标签</div>\n                                    <div style={{ lineHeight: '30px' }}>\n                                        {tags && tags.map(item => (<Tag key={item}>{item}</Tag>))}\n                                    </div>\n                                </div>}\n\n                                {third && <Divider style={{ marginTop: 26 }} dashed />}\n                                {third && <div className=\"team\">\n                                    <div style={{ marginBottom: 12, color: \"rgba(0,0,0,0.85)\" }}>社交账号</div>\n                                    <Row gutter={36}>\n                                        <Col lg={8} xl={8} className=\"sjitem\">\n                                            <Avatar size={28} icon=\"github\" className=\"account\" />\n                                            <div className=\"mz\">github</div>\n                                        </Col>\n                                        <Col lg={8} xl={8} className=\"sjitem\">\n                                            <Avatar size={28} icon=\"qq\" className=\"account\" />\n                                            <div className=\"mz\">QQ</div>\n                                        </Col>\n                                        <Col lg={8} xl={8} className=\"sjitem\">\n                                            <Avatar size={28} icon=\"wechat\" className=\"account\" />\n                                            <div className=\"mz\">微信</div>\n                                        </Col>\n                                    </Row>\n\n                                </div>}\n                            </div>\n                        )}\n                    </Card>\n                </Col>\n                <Col lg={17} md={24}>\n                    <Card\n                        className=\"tabsCard\"\n                        bordered={false}\n                        tabList={operationTabList}\n                        activeTabKey={tabKey}\n                        onTabChange={onTabChange}>\n                        {renderChildrenByTabKey(tabKey)}\n                    </Card>\n                </Col>\n            </Row>\n        </Content>\n    )\n}\n\nCenter.getInitialProps = async (context) => {\n    console.log('context', context)\n    let id = context.ctx.query.user_id\n    const promise = new Promise((resolve) => {\n        axios(servicePath.getUser + id).then(\n            (res) => {\n                console.log('user1',res)\n                resolve(res.data.data)\n            }\n        )\n    })\n\n    return await promise\n}\n\nexport default Center"]},"metadata":{},"sourceType":"module"}