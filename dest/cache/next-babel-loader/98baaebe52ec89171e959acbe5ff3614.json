{"ast":null,"code":"import _BackTop from \"antd/lib/back-top\";\nimport _Spin from \"antd/lib/spin\";\nimport _Card from \"antd/lib/card\";\nimport _Button from \"antd/lib/button\";\nimport _Checkbox from \"antd/lib/checkbox\";\nimport _Input from \"antd/lib/input\";\nimport _Icon from \"antd/lib/icon\";\nimport _message from \"antd/lib/message\";\nimport _Layout from \"antd/lib/layout\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { connect } from 'react-redux';\nimport servicePath from '../config/apiUrl';\nimport Router from 'next/router';\nimport Link from 'next/link';\nimport Head from 'next/head';\nimport getConfig from 'next/config';\nconst {\n  Content\n} = _Layout;\nconst {\n  publicRuntimeConfig\n} = getConfig();\n\nconst Login = props => {\n  console.log('login', props);\n  const {\n    0: userName,\n    1: setUserName\n  } = useState('');\n  const {\n    0: password,\n    1: setPassword\n  } = useState('');\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState(false);\n  const {\n    0: autoLogin,\n    1: setAutoLogin\n  } = useState(false);\n\n  const github = () => {\n    console.log('luyou', publicRuntimeConfig.OAUTH_URL);\n    window.location.href = publicRuntimeConfig.OAUTH_URL;\n  };\n\n  const checkLogin = () => {\n    if (!userName) {\n      _message.error('用户名不能为空');\n\n      return false;\n    } else if (!password) {\n      _message.error('密码不能为空');\n\n      return false;\n    }\n\n    let dataProps = {\n      'username': userName,\n      'password': password\n    };\n    axios({\n      method: 'POST',\n      url: servicePath.goLogin,\n      data: dataProps\n    }).then(res => {\n      setIsLoading(false);\n\n      if (res.status === 201) {\n        localStorage.setItem('token', res.data.access_token);\n        console.log('logindata', props.add(res.data.access_token));\n        window.location.href = '/';\n      } else {\n        _message.error('用户名或密码错误');\n      }\n    }).catch(function (error) {\n      console.log(error);\n    });\n    setIsLoading(true);\n    setTimeout(() => {\n      setIsLoading(false);\n    }, 1000);\n  };\n\n  const changeAutoLogin = () => {\n    setAutoLogin(!autoLogin);\n  };\n\n  useEffect(() => {});\n  return __jsx(_Layout, {\n    className: \"ly\"\n  }, __jsx(Head, null, __jsx(\"title\", null, \"\\u535A\\u4EBA\\u5802 -- \\u767B\\u5F55\")), __jsx(Content, {\n    className: \"content\"\n  }, __jsx(\"div\", {\n    className: \"login-div\"\n  }, __jsx(_Spin, {\n    tip: \"Loading...\",\n    spinning: isLoading\n  }, __jsx(_Card, {\n    title: \"\\u535A\\u4EBA\\u5802--\\u767B\\u5F55\",\n    bordered: true,\n    style: {\n      width: 360,\n      margin: '20px auto'\n    }\n  }, __jsx(_Input, {\n    id: \"userName\",\n    size: \"large\",\n    placeholder: \"\\u8BF7\\u8F93\\u5165\\u4F60\\u7684\\u7528\\u6237\\u540D\",\n    prefix: __jsx(_Icon, {\n      type: \"user\",\n      style: {\n        color: 'rgba(0,0,0,.25)'\n      }\n    }),\n    onChange: e => {\n      setUserName(e.target.value);\n    }\n  }), __jsx(\"br\", null), __jsx(\"br\", null), __jsx(_Input.Password, {\n    id: \"password\",\n    size: \"large\",\n    placeholder: \"\\u8BF7\\u8F93\\u5165\\u4F60\\u7684\\u5BC6\\u7801\",\n    prefix: __jsx(_Icon, {\n      type: \"key\",\n      style: {\n        color: 'rgba(0,0,0,.25)'\n      }\n    }),\n    onChange: e => {\n      setPassword(e.target.value);\n    }\n  }), __jsx(\"br\", null), __jsx(\"br\", null), __jsx(\"div\", null, __jsx(_Checkbox, {\n    checked: autoLogin,\n    onChange: changeAutoLogin\n  }, \"\\u8BB0\\u4F4F\\u5BC6\\u7801\"), __jsx(\"a\", {\n    style: {\n      float: 'right'\n    }\n  }, \"\\u5FD8\\u8BB0\\u5BC6\\u7801\\uFF1F\")), __jsx(\"br\", null), __jsx(_Button, {\n    type: \"primary\",\n    size: \"large\",\n    block: true,\n    onClick: checkLogin\n  }, \" \\u767B\\u5F55 \"), __jsx(\"br\", null), __jsx(\"br\", null), __jsx(\"div\", null, \"\\u5176\\u4ED6\\u767B\\u5F55\\u65B9\\u5F0F\\uFF1A\", __jsx(\"a\", {\n    onClick: github\n  }, __jsx(_Icon, {\n    type: \"github\",\n    style: {\n      fontSize: 18\n    }\n  })), __jsx(Link, {\n    href: \"/register\"\n  }, __jsx(\"a\", {\n    style: {\n      float: 'right'\n    }\n  }, \"\\u6CE8\\u518C\"))))))), __jsx(_BackTop, null));\n};\n\nexport default connect(function mapStateToProps(state) {\n  return {\n    token: state.token\n  };\n}, function mapDispatchToProps(dispatch) {\n  return {\n    add: token => dispatch({\n      type: 'ADD',\n      token: token\n    })\n  };\n})(Login);","map":{"version":3,"sources":["/Users/mac/Desktop/liy-blog/pages/login.js"],"names":["React","useState","useEffect","axios","connect","servicePath","Router","Link","Head","getConfig","Content","publicRuntimeConfig","Login","props","console","log","userName","setUserName","password","setPassword","isLoading","setIsLoading","autoLogin","setAutoLogin","github","OAUTH_URL","window","location","href","checkLogin","error","dataProps","method","url","goLogin","data","then","res","status","localStorage","setItem","access_token","add","catch","setTimeout","changeAutoLogin","width","margin","color","e","target","value","float","fontSize","mapStateToProps","state","token","mapDispatchToProps","dispatch","type"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios'\nimport { Layout, Card, Input, Icon, Button, Spin, Checkbox, message, BackTop } from 'antd';\nimport { connect } from 'react-redux'\nimport servicePath from '../config/apiUrl';\nimport Router from 'next/router'\nimport Link from 'next/link'\nimport Head from 'next/head'\nimport getConfig from 'next/config'\n\nconst { Content } = Layout;\nconst { publicRuntimeConfig } = getConfig()\nconst Login = (props) => {\n    console.log('login',props)\n    \n    const [userName, setUserName] = useState('')\n    const [password, setPassword] = useState('')\n    const [isLoading, setIsLoading] = useState(false)\n    const [autoLogin, setAutoLogin] = useState(false)\n\n    const github = () => {\n        console.log('luyou',publicRuntimeConfig.OAUTH_URL)\n        \n        window.location.href=publicRuntimeConfig.OAUTH_URL\n    }\n\n    const checkLogin = () => {\n        if (!userName) {\n            message.error('用户名不能为空')\n            return false\n        } else if (!password) {\n            message.error('密码不能为空')\n            return false\n        }\n        let dataProps = {\n            'username': userName,\n            'password': password\n        }\n\n        axios({\n            method: 'POST',\n            url: servicePath.goLogin,\n            data: dataProps\n        }).then(\n            res => {\n                setIsLoading(false)\n                if (res.status === 201) {\n                    localStorage.setItem('token',res.data.access_token)\n                    console.log('logindata',props.add(res.data.access_token))\n                    window.location.href='/'\n                } else {\n                    message.error('用户名或密码错误')\n                }\n            }\n        ).catch(function (error) {\n            console.log(error)\n        });\n\n        setIsLoading(true)\n        setTimeout(() => {\n            setIsLoading(false)\n        }, 1000)\n    }\n\n    const changeAutoLogin = () => {\n        setAutoLogin(!autoLogin)\n    }\n\n    useEffect(() => {\n\n    })\n\n    return (\n        <Layout className=\"ly\">\n            <Head>\n                <title>博人堂 -- 登录</title>\n            </Head>\n            <Content className=\"content\">\n                <div className=\"login-div\">\n                    <Spin tip=\"Loading...\" spinning={isLoading}>\n                        <Card title=\"博人堂--登录\" bordered={true} style={{ width: 360, margin: '20px auto',}} >\n                            <Input\n                                id=\"userName\"\n                                size=\"large\"\n                                placeholder=\"请输入你的用户名\"\n                                prefix={<Icon type=\"user\" style={{ color: 'rgba(0,0,0,.25)' }} />}\n                                onChange={(e) => { setUserName(e.target.value) }}\n                            />\n                            <br /><br />\n\n                            <Input.Password\n                                id=\"password\"\n                                size=\"large\"\n                                placeholder=\"请输入你的密码\"\n                                prefix={<Icon type=\"key\" style={{ color: 'rgba(0,0,0,.25)' }} />}\n                                onChange={(e) => { setPassword(e.target.value) }}\n                            />\n                            <br /><br />\n                            <div>\n                                <Checkbox checked={autoLogin} onChange={changeAutoLogin}>\n                                    记住密码\n                            </Checkbox>\n                                <a style={{ float: 'right' }}>\n                                    忘记密码？\n                            </a>\n                            </div>\n                            <br />\n                            <Button type=\"primary\" \n                            size=\"large\" block\n                            onClick={checkLogin}\n                            > 登录 </Button>\n                            <br /><br />\n                            <div>\n                                其他登录方式：\n                            \n                                    <a onClick={github}>\n                                        <Icon type=\"github\" style={{ fontSize: 18, }} />\n                                    </a>\n                                \n                                {/*<Icon type=\"wechat\" style={{ fontSize: 18, }} />&nbsp;&nbsp;&nbsp;*/}\n                                {/*<Icon type=\"qq\" style={{ fontSize: 18, }} />*/}\n                                <Link href='/register'>\n                                    <a style={{ float: 'right' }}>\n                                        注册\n                            </a>\n                                </Link>\n                            </div>\n                        </Card>\n                    </Spin>\n                </div>\n            </Content>\n            <BackTop />\n        </Layout>\n    )\n}\n\nexport default connect(\n    function mapStateToProps(state) {\n        return {\n            token: state.token\n        }\n    },function mapDispatchToProps(dispatch){\n        return {\n            add: (token) => dispatch({type:'ADD',token:token})\n        }\n    }\n)(Login)"]},"metadata":{},"sourceType":"module"}