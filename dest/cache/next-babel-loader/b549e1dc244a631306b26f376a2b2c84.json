{"ast":null,"code":"import _Upload from \"antd/lib/upload\";\nimport _Button from \"antd/lib/button\";\nimport _Icon from \"antd/lib/icon\";\nimport _Tag from \"antd/lib/tag\";\nimport _Form from \"antd/lib/form\";\nimport _Input from \"antd/lib/input\";\nimport _parseInt from \"@babel/runtime-corejs2/core-js/parse-int\";\nimport _message from \"antd/lib/message\";\nimport _Select from \"antd/lib/select\";\nvar __jsx = React.createElement;\nimport React, { useEffect, useRef, useState } from 'react';\nimport axios from \"axios\";\nimport servicePath from '../config/apiUrl';\nimport { Router } from 'next/router';\nconst {\n  Option\n} = _Select;\n\nconst BaseView = () => {\n  const newTag = useRef(null);\n  const {\n    0: user,\n    1: setUser\n  } = useState();\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState(true);\n  const {\n    0: inputValue,\n    1: setinputValue\n  } = useState();\n  const {\n    0: inputVisible,\n    1: setInputVisible\n  } = useState(false);\n  const {\n    0: newTags,\n    1: setNewTags\n  } = useState([]);\n  const {\n    0: avatar,\n    1: setAvatar\n  } = useState();\n  const {\n    0: email,\n    1: setEmail\n  } = useState();\n  const {\n    0: nickname,\n    1: setNickname\n  } = useState();\n  const {\n    0: introduce,\n    1: setIntroduce\n  } = useState();\n  const {\n    0: professional,\n    1: setProfessional\n  } = useState();\n  const {\n    0: company,\n    1: setCompany\n  } = useState();\n  const {\n    0: provinceId,\n    1: setProvinceId\n  } = useState();\n  const {\n    0: cityId,\n    1: setCityId\n  } = useState();\n  const {\n    0: provinceData,\n    1: setProvinceData\n  } = useState();\n  const {\n    0: cityData,\n    1: setCityData\n  } = useState();\n  const {\n    0: cities,\n    1: setCities\n  } = useState();\n  const {\n    0: secondCity,\n    1: setSecondCity\n  } = useState();\n  const {\n    0: token,\n    1: setToken\n  } = useState();\n\n  const getProvinces = provinceId => {\n    const CancelToken = axios.CancelToken;\n    const source = CancelToken.source();\n    axios({\n      method: 'get',\n      url: servicePath.getProvinces,\n      withCredentials: false,\n      cancelToken: source.token\n    }).then(res => {\n      source.cancel('方法被取消');\n      console.log('qweqweqw', res.data);\n      let defualt = '';\n\n      for (let i = 0; i < res.data.length; i++) {\n        if (provinceId && res.data[i].id == provinceId) {\n          defualt = res.data[i].name;\n        }\n      }\n\n      if (res.data) {\n        setProvinceData(__jsx(_Select, {\n          defaultValue: defualt == '' ? res.data[0].name : defualt,\n          style: {\n            width: 120\n          },\n          onChange: handleProvinceChange\n        }, res.data.map(province => __jsx(Option, {\n          key: province.id\n        }, province.name))));\n      }\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  const getCity = (id, cityId) => {\n    const CancelToken = axios.CancelToken;\n    const source = CancelToken.source();\n    axios({\n      method: 'get',\n      url: servicePath.getCity + '?id=' + id,\n      withCredentials: false,\n      cancelToken: source.token\n    }).then(res => {\n      setCities(res.data[0].children);\n      setCityData(res.data[0].children.map(city => __jsx(Option, {\n        key: city.id\n      }, city.name)));\n      setSecondCity(res.data[0].children[0]);\n\n      for (let item in res.data[0].children) {\n        console.log('1', res.data[0].children[item].id);\n        console.log('2', cityId);\n\n        if (res.data[0].children[item].id == cityId) {\n          setSecondCity(res.data[0].children[item]);\n        }\n      }\n\n      source.cancel('方法被取消');\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }; //获取会员数据\n\n\n  const checkLogin = token => {\n    const CancelToken = axios.CancelToken;\n    const source = CancelToken.source();\n\n    if (token) {\n      axios({\n        method: 'get',\n        url: servicePath.getUserInfo,\n        headers: {\n          'Authorization': 'Bearer ' + token\n        },\n        withCredentials: false,\n        cancelToken: source.token,\n        transformResponse: function (data) {\n          if (data.indexOf('errors') != -1) {\n            data = JSON.parse(data);\n\n            for (var item in data.errors) {\n              _message.error(data.errors[item][0]);\n            }\n          } else if (data.indexOf('Unauthenticated') != -1) {\n            localStorage.removeItem('token');\n            localStorage.removeItem('user_id');\n\n            _message.error('登录已过期，请重新登录');\n\n            Router.push('/login');\n          } else {\n            return data;\n          }\n        }\n      }).then(res => {\n        source.cancel('方法被取消');\n        setIsLoading(false);\n        console.log('user123', res.data);\n        res.data = eval('(' + res.data + ')');\n        console.log('user1', res.data.data);\n\n        if (!localStorage.getItem('user_id') || localStorage.getItem('user_id') != res.data.data.id) {\n          Router.push('/login');\n        } else {\n          setUser(res.data.data);\n          setIntroduce(res.data.data.introduction);\n          setAvatar(res.data.data.avatar);\n          setNickname(res.data.data.name);\n          setEmail(res.data.data.email);\n          getThird(res.data.data.id);\n        }\n      }).catch(function (error) {\n        console.log(error);\n      });\n    } else {\n      console.log('asasdas3');\n    }\n  };\n\n  const handlerSubmit = () => {\n    let dataProps = {};\n    dataProps.email = email;\n    dataProps.nickname = nickname;\n    dataProps.introduction = introduce;\n    dataProps.avatar = avatar;\n    dataProps.tags = newTags.length > 0 ? newTags.join(',') : [];\n    dataProps.professional = professional;\n    dataProps.company = company;\n    dataProps.province_id = provinceId;\n    dataProps.city_id = cityId;\n    dataProps.user_id = user.id;\n    axios({\n      method: 'post',\n      url: servicePath.saveThird,\n      headers: {\n        'Authorization': 'Bearer ' + token\n      },\n      data: dataProps\n    }).then(res => {\n      console.log(res);\n\n      _message.success(res.data.msg);\n\n      window.location.href = \"/\";\n    });\n  };\n\n  const getThird = id => {\n    axios({\n      method: 'get',\n      url: servicePath.getThird + '?user_id=' + id,\n      headers: {\n        'Authorization': 'Bearer ' + token\n      }\n    }).then(res => {\n      if (res.data.data) {\n        console.log('third', res.data.data);\n        let arr = res.data.data.tags ? res.data.data.tags.split(\",\") : [];\n        console.log(arr);\n        setNewTags(arr);\n        setCompany(res.data.data.company);\n        setProfessional(res.data.data.professional);\n        setProvinceId(res.data.data.province_id);\n        setCityId(res.data.data.city_id);\n        console.log('province', provinceId);\n        getProvinces(res.data.data.province_id ? res.data.data.province_id : 1);\n        getCity(res.data.data.province_id ? res.data.data.province_id : 1, res.data.data.city_id ? res.data.data.city_id : 1);\n      }\n    });\n  };\n\n  const handleInputChange = e => {\n    setinputValue(e.target.value);\n  };\n\n  const handleInputConfirm = () => {\n    let arr = newTags;\n\n    if (inputValue && newTags.indexOf(inputValue) === -1) {\n      arr.push(inputValue);\n    }\n\n    setNewTags(arr);\n    setinputValue('');\n    setInputVisible(false);\n  };\n\n  const showInput = () => {\n    setInputVisible(true);\n  };\n\n  const handleProvinceChange = value => {\n    setProvinceId(value);\n    getProvinces(provinceId);\n    getCity(provinceId, value);\n  };\n\n  const onSecondCityChange = value => {\n    setCityId(value);\n\n    for (let item in cities) {\n      console.log(_parseInt(cities[item]['id']) == value);\n\n      if (_parseInt(cities[item]['id']) == value) {\n        console.log(cities[item]);\n        setSecondCity(cities[item]);\n      }\n    }\n  };\n\n  const handleUploadChange = ({\n    file\n  }) => {\n    console.log(file);\n\n    switch (file.status) {\n      case 'done':\n        _message.destroy();\n\n        _message.success('上传成功！'); // @ts-ignore\n\n\n        setAvatar(file.response.file_path);\n        break;\n\n      case 'error':\n        _message.destroy();\n\n        _message.error(file.response.message);\n\n        break;\n    }\n  };\n\n  useEffect(() => {\n    if (isLoading) {\n      checkLogin(localStorage.getItem('token'));\n    }\n\n    setToken(localStorage.getItem('token'));\n  }, []);\n  return __jsx(\"div\", {\n    className: \"baseView\"\n  }, __jsx(\"div\", {\n    className: \"left\"\n  }, __jsx(_Form, {\n    layout: \"vertical\",\n    hideRequiredMark: true\n  }, __jsx(_Form.Item, {\n    label: \"\\u90AE\\u7BB1\"\n  }, __jsx(_Input, {\n    onChange: e => {\n      setEmail(e.target.value);\n    },\n    value: email\n  })), __jsx(_Form.Item, {\n    label: \"\\u6635\\u79F0\"\n  }, __jsx(_Input, {\n    onChange: e => {\n      setNickname(e.target.value);\n    },\n    value: nickname\n  })), __jsx(_Form.Item, {\n    label: \"\\u4E2A\\u4EBA\\u7B80\\u4ECB\"\n  }, __jsx(_Input.TextArea, {\n    placeholder: \"\\u4E2A\\u4EBA\\u7B80\\u4ECB\",\n    rows: 4,\n    onChange: e => {\n      setIntroduce(e.target.value);\n    },\n    value: introduce\n  })), __jsx(_Form.Item, {\n    label: \"\\u6807\\u7B7E\"\n  }, __jsx(\"div\", {\n    className: \"tags\",\n    style: {\n      lineHeight: '30px'\n    }\n  }, newTags && newTags.map(item => __jsx(_Tag, {\n    key: item\n  }, item)), inputVisible && __jsx(_Input, {\n    ref: newTag,\n    type: \"text\",\n    size: \"small\",\n    style: {\n      width: 78\n    },\n    value: inputValue,\n    onChange: handleInputChange,\n    onBlur: handleInputConfirm,\n    onPressEnter: handleInputConfirm\n  }), !inputVisible && __jsx(_Tag, {\n    onClick: showInput,\n    style: {\n      background: '#fff',\n      borderStyle: 'dashed'\n    }\n  }, __jsx(_Icon, {\n    type: \"plus\"\n  })))), __jsx(_Form.Item, {\n    label: \"\\u804C\\u79F0\"\n  }, __jsx(_Input, {\n    onChange: e => {\n      setProfessional(e.target.value);\n    },\n    value: professional\n  })), __jsx(_Form.Item, {\n    label: \"\\u516C\\u53F8\"\n  }, __jsx(_Input, {\n    onChange: e => {\n      setCompany(e.target.value);\n    },\n    value: company\n  })), __jsx(_Form.Item, {\n    label: \"\\u6240\\u5728\\u57CE\\u5E02\"\n  }, provinceData, __jsx(_Select, {\n    style: {\n      width: 120,\n      marginLeft: 10\n    },\n    value: secondCity ? secondCity.name : '',\n    onChange: onSecondCityChange\n  }, cityData)), __jsx(_Button, {\n    type: \"primary\",\n    onClick: handlerSubmit\n  }, \"\\u66F4\\u65B0\\u4FE1\\u606F\"))), __jsx(\"div\", {\n    className: \"right\"\n  }, __jsx(\"div\", {\n    className: \"avatar_title\"\n  }, \"\\u7528\\u6237\\u5934\\u50CF\"), __jsx(\"div\", {\n    className: \"avatar\"\n  }, __jsx(\"img\", {\n    style: {\n      borderRadius: '50%'\n    },\n    src: avatar,\n    alt: \"avatar\"\n  })), __jsx(_Upload, {\n    accept: \"image/*\",\n    name: \"file\",\n    className: \"upload\",\n    action: servicePath.uploadArticleImage,\n    showUploadList: false,\n    headers: {\n      Authorization: 'Bearer ' + token\n    },\n    onChange: handleUploadChange\n  }, __jsx(\"div\", {\n    className: \"button_view\"\n  }, __jsx(_Button, {\n    icon: \"upload\"\n  }, \"\\u4E0A\\u4F20\\u5934\\u50CF\")))));\n};\n\nexport default BaseView;","map":{"version":3,"sources":["/Users/mac/Desktop/liy-blog/components/BaseView.jsx"],"names":["React","useEffect","useRef","useState","axios","servicePath","Router","Option","BaseView","newTag","user","setUser","isLoading","setIsLoading","inputValue","setinputValue","inputVisible","setInputVisible","newTags","setNewTags","avatar","setAvatar","email","setEmail","nickname","setNickname","introduce","setIntroduce","professional","setProfessional","company","setCompany","provinceId","setProvinceId","cityId","setCityId","provinceData","setProvinceData","cityData","setCityData","cities","setCities","secondCity","setSecondCity","token","setToken","getProvinces","CancelToken","source","method","url","withCredentials","cancelToken","then","res","cancel","console","log","data","defualt","i","length","id","name","width","handleProvinceChange","map","province","catch","error","getCity","children","city","item","checkLogin","getUserInfo","headers","transformResponse","indexOf","JSON","parse","errors","localStorage","removeItem","push","eval","getItem","introduction","getThird","handlerSubmit","dataProps","tags","join","province_id","city_id","user_id","saveThird","success","msg","window","location","href","arr","split","handleInputChange","e","target","value","handleInputConfirm","showInput","onSecondCityChange","handleUploadChange","file","status","destroy","response","file_path","message","lineHeight","background","borderStyle","marginLeft","borderRadius","uploadArticleImage","Authorization"],"mappings":"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","sourcesContent":["import React, {useEffect, useRef, useState} from 'react';\nimport {Button, Form, Input, Select, Upload, message, Tag, Icon, Modal} from 'antd';\nimport axios from \"axios\";\nimport servicePath from '../config/apiUrl';\nimport { Router } from 'next/router';\nconst {Option} = Select;\n\n\nconst BaseView = () => {\n    const newTag = useRef(null)\n    const [user, setUser] = useState()\n    const [isLoading, setIsLoading] = useState(true)\n    const [inputValue, setinputValue] = useState()\n    const [inputVisible, setInputVisible] = useState(false)\n    const [newTags, setNewTags] = useState([])\n    const [avatar, setAvatar] = useState()\n    const [email, setEmail] = useState()\n    const [nickname, setNickname] = useState()\n    const [introduce, setIntroduce] = useState()\n    const [professional, setProfessional] = useState()\n    const [company, setCompany] = useState()\n    const [provinceId, setProvinceId] = useState()\n    const [cityId, setCityId] = useState()\n\n    const [provinceData, setProvinceData] = useState();\n\n    const [cityData, setCityData] = useState();\n\n    const [cities, setCities] = useState();\n\n    const [secondCity, setSecondCity] = useState()\n\n    const [token, setToken] = useState()\n\n\n    const getProvinces = (provinceId) => {\n        const CancelToken = axios.CancelToken;\n        const source = CancelToken.source();\n        axios({\n            method: 'get',\n            url: servicePath.getProvinces,\n            withCredentials: false,\n            cancelToken: source.token,\n        }).then(\n            res => {\n                source.cancel('方法被取消');\n                console.log('qweqweqw', res.data);\n                let defualt='';\n                for(let i=0;i<res.data.length;i++){\n                    if(provinceId && res.data[i].id==provinceId){\n                        defualt=res.data[i].name\n                    }\n                }\n\n\n\n                if (res.data) {\n                    setProvinceData(\n                        <Select\n                            defaultValue={defualt==''?res.data[0].name:defualt}\n                            style={{width: 120}}\n                            onChange={handleProvinceChange}\n                        >\n                            {res.data.map(province => (\n                                <Option key={province.id}>{province.name}</Option>\n                            ))}\n                        </Select>\n                    );\n\n\n                }\n\n            }\n        ).catch(function (error) {\n            console.log(error)\n        });\n\n    }\n\n    const getCity = (id,cityId) => {\n        const CancelToken = axios.CancelToken;\n        const source = CancelToken.source();\n        axios({\n            method: 'get',\n            url: servicePath.getCity+'?id=' + id,\n            withCredentials: false,\n            cancelToken: source.token,\n        }).then(\n            res => {\n                setCities(res.data[0].children)\n                setCityData(res.data[0].children.map(city => (\n                    <Option key={city.id}>{city.name}</Option>\n                )));\n\n                setSecondCity(res.data[0].children[0])\n\n                for (let item in res.data[0].children) {\n                    console.log('1',res.data[0].children[item].id)\n                    console.log('2',cityId)\n                    if (res.data[0].children[item].id == cityId) {\n                        setSecondCity(res.data[0].children[item])\n                    }\n                }\n\n\n\n                source.cancel('方法被取消');\n            }\n        ).catch(function (error) {\n            console.log(error)\n        });\n    }\n\n    //获取会员数据\n    const checkLogin = (token) => {\n        const CancelToken = axios.CancelToken;\n        const source = CancelToken.source();\n        if (token) {\n            axios({\n                method: 'get',\n                url: servicePath.getUserInfo,\n                headers: {\n                    'Authorization': 'Bearer ' + token,\n                },\n                withCredentials: false,\n                cancelToken: source.token,\n                transformResponse: function (data) {\n                    if (data.indexOf('errors') != -1) {\n                        data = JSON.parse(data);\n                        for (var item in data.errors) {\n                            message.error(data.errors[item][0]);\n                        }\n                    } else if (data.indexOf('Unauthenticated') != -1) {\n                        localStorage.removeItem('token')\n                        localStorage.removeItem('user_id')\n                        message.error('登录已过期，请重新登录');\n                        Router.push('/login')\n                    } else {\n                        return data;\n                    }\n                }\n            }).then(\n                res => {\n                    source.cancel('方法被取消');\n                    setIsLoading(false)\n                    console.log('user123',res.data)\n                    res.data = eval('(' + res.data + ')');\n                    console.log('user1',res.data.data)\n                    if(!localStorage.getItem('user_id') || localStorage.getItem('user_id')!= res.data.data.id){\n                        Router.push('/login');\n                    }else{\n                        setUser(res.data.data);\n                        setIntroduce(res.data.data.introduction)\n                        setAvatar(res.data.data.avatar)\n                        setNickname(res.data.data.name)\n                        setEmail(res.data.data.email)\n                        getThird(res.data.data.id)\n                    }\n                    \n                }\n            ).catch(function (error) {\n                console.log(error)\n            });\n        } else {\n            console.log('asasdas3')\n        }\n    }\n\n    const handlerSubmit = () => {\n        let dataProps = {}\n        dataProps.email = email;\n        dataProps.nickname = nickname;\n        dataProps.introduction = introduce;\n        dataProps.avatar = avatar;\n        dataProps.tags = newTags.length>0 ? newTags.join(',') : [];\n        dataProps.professional = professional;\n        dataProps.company = company;\n        dataProps.province_id = provinceId;\n        dataProps.city_id = cityId;\n        dataProps.user_id=user.id;\n        axios({\n            method: 'post',\n            url: servicePath.saveThird,\n            headers: {\n                'Authorization': 'Bearer ' + token,\n            },\n            data: dataProps\n        }).then(res => {\n            console.log(res);\n            message.success(res.data.msg)\n            window.location.href=\"/\"\n        })\n    }\n\n    const getThird = (id) =>{\n        axios({\n            method: 'get',\n            url: servicePath.getThird+'?user_id='+id,\n            headers: {\n                'Authorization': 'Bearer ' + token,\n            },\n        }).then(res => {\n            if (res.data.data) {\n                console.log('third',res.data.data)\n                let arr = res.data.data.tags?res.data.data.tags.split(\",\"):[];\n                console.log(arr)\n                setNewTags(arr)\n                setCompany(res.data.data.company)\n                setProfessional(res.data.data.professional)\n                setProvinceId(res.data.data.province_id)\n                setCityId(res.data.data.city_id)\n                console.log('province',provinceId)\n                getProvinces(res.data.data.province_id?res.data.data.province_id:1)\n                getCity(res.data.data.province_id?res.data.data.province_id:1,res.data.data.city_id?res.data.data.city_id:1)\n\n            }\n        })\n    }\n\n    const handleInputChange = (e) => {\n        setinputValue(e.target.value)\n    }\n\n    const handleInputConfirm = () => {\n        let arr = newTags;\n        if (inputValue && newTags.indexOf(inputValue) === -1) {\n            arr.push(inputValue)\n        }\n        setNewTags(arr);\n        setinputValue('');\n        setInputVisible(false)\n    }\n\n    const showInput = () => {\n        setInputVisible(true)\n    }\n\n    const handleProvinceChange = value => {\n        setProvinceId(value);\n\n        getProvinces(provinceId)\n        getCity(provinceId,value)\n    };\n\n    const onSecondCityChange = value => {\n        setCityId(value)\n        for (let item in cities) {\n            console.log(parseInt(cities[item]['id']) == value)\n            if (parseInt(cities[item]['id']) == value) {\n                console.log(cities[item])\n                setSecondCity(cities[item])\n            }\n        }\n    };\n\n    const handleUploadChange = ({ file }) => {\n        console.log(file)\n        switch (file.status) {\n            case 'done':\n                message.destroy();\n                message.success('上传成功！');\n                // @ts-ignore\n                setAvatar(file.response.file_path)\n                break;\n            case 'error':\n                message.destroy();\n                message.error(file.response.message);\n                break;\n        }\n    };\n\n\n    useEffect(() => {\n        if (isLoading) {\n            checkLogin(localStorage.getItem('token'))\n        }\n        setToken(localStorage.getItem('token'))\n    },[])\n\n    return (\n        <div className=\"baseView\">\n            <div className=\"left\">\n                <Form layout=\"vertical\" hideRequiredMark>\n                    <Form.Item label=\"邮箱\">\n                        <Input onChange={(e) => {\n                            setEmail(e.target.value)\n                        }} value={email}/>\n                    </Form.Item>\n\n                    <Form.Item label=\"昵称\">\n                        <Input onChange={(e) => {\n                            setNickname(e.target.value)\n                        }} value={nickname}/>\n                    </Form.Item>\n\n                    <Form.Item label=\"个人简介\">\n                        <Input.TextArea\n                            placeholder=\"个人简介\"\n                            rows={4}\n                            onChange={(e) => {\n                                setIntroduce(e.target.value)\n                            }}\n                            value={introduce}\n                        />\n                    </Form.Item>\n\n                    <Form.Item label=\"标签\">\n                        <div className=\"tags\" style={{lineHeight:'30px'}}>\n                            {newTags && newTags.map(item => (<Tag key={item}>{item}</Tag>))}\n                            {inputVisible && (\n                                <Input\n                                    ref={newTag}\n                                    type=\"text\"\n                                    size=\"small\"\n                                    style={{width: 78}}\n                                    value={inputValue}\n                                    onChange={handleInputChange}\n                                    onBlur={handleInputConfirm}\n                                    onPressEnter={handleInputConfirm}\n                                />\n                            )}\n                            {!inputVisible && (<Tag\n                                    onClick={showInput}\n                                    style={{background: '#fff', borderStyle: 'dashed'}}>\n                                    <Icon type=\"plus\"/>\n                                </Tag>\n                            )}\n                        </div>\n                    </Form.Item>\n\n                    <Form.Item label=\"职称\">\n                        <Input onChange={(e) => {\n                            setProfessional(e.target.value)\n                        }} value={professional}/>\n                    </Form.Item>\n\n                    <Form.Item label=\"公司\">\n                        <Input onChange={(e) => {\n                            setCompany(e.target.value)\n                        }} value={company}/>\n                    </Form.Item>\n\n                    <Form.Item label=\"所在城市\">\n                        {provinceData}\n                        <Select\n                            style={{width: 120, marginLeft: 10}}\n                            value={secondCity ? secondCity.name : ''}\n                            onChange={onSecondCityChange}>\n                            {cityData}\n                        </Select>\n                    </Form.Item>\n\n                    <Button type=\"primary\" onClick={handlerSubmit}>\n                        更新信息\n                    </Button>\n\n                </Form>\n            </div>\n            <div className=\"right\">\n                <div className=\"avatar_title\">\n                    用户头像\n                </div>\n\n                <div className=\"avatar\">\n                    <img style={{borderRadius:'50%'}} src={avatar} alt=\"avatar\"/>\n                </div>\n\n\n                <Upload\n                    accept=\"image/*\"\n                    name=\"file\"\n                    className=\"upload\"\n                    action={servicePath.uploadArticleImage}\n                    showUploadList={false}\n                    headers={{Authorization: 'Bearer ' + token}}\n                    onChange={handleUploadChange}\n                >\n\n                    <div className=\"button_view\">\n                        <Button icon=\"upload\">\n                            上传头像\n                        </Button>\n                    </div>\n\n                </Upload>\n            </div>\n        </div>\n    )\n}\nexport default BaseView\n"]},"metadata":{},"sourceType":"module"}