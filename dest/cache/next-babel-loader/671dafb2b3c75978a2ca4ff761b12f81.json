{"ast":null,"code":"import _message from \"antd/lib/message\";\nvar __jsx = React.createElement;\nimport React, { useEffect, useState } from 'react';\nimport NoticeIcon from 'ant-design-pro/lib/NoticeIcon';\nimport axios from \"axios\";\nimport servicePath from '../config/apiUrl';\nimport Router from 'next/router';\n\nconst NoticeView = () => {\n  const {\n    0: data,\n    1: setData\n  } = useState([]);\n  const {\n    0: user,\n    1: setUser\n  } = useState(); //获取会员数据\n\n  const checkLogin = () => {\n    const CancelToken = axios.CancelToken;\n    const source = CancelToken.source();\n\n    if (localStorage.getItem('token') != null) {\n      axios({\n        method: 'get',\n        url: servicePath.getUserInfo,\n        headers: {\n          'Authorization': 'Bearer ' + localStorage.getItem('token')\n        },\n        withCredentials: false,\n        cancelToken: source.token,\n        transformResponse: function (data) {\n          if (data.indexOf('errors') != -1) {\n            data = JSON.parse(data);\n\n            for (var item in data.errors) {\n              _message.error(data.errors[item][0]);\n            }\n          } else if (data.indexOf('Unauthenticated') != -1) {\n            localStorage.removeItem('token');\n            Router.push('/');\n          } else {\n            return data;\n          }\n        }\n      }).then(res => {\n        source.cancel('方法被取消');\n        setIsLoading(false);\n        res.data = eval('(' + res.data + ')');\n        setUser(res.data.data);\n        getNotification();\n        getNoread();\n      }).catch(function (error) {\n        console.log(error);\n      });\n    } else {\n      console.log('asasdas3');\n    }\n  };\n\n  const getNotification = () => {\n    axios({\n      method: 'get',\n      url: servicePath.getNotifications,\n      headers: {\n        'Authorization': 'Bearer ' + localStorage.getItem('token')\n      },\n      withCredentials: false\n    }).then(res => {\n      console.log(res);\n      setData(res.data.data);\n    });\n  };\n\n  useEffect(() => {\n    if (localStorage.getItem('token')) {\n      checkLogin();\n    } else {\n      Router.push('/login');\n    }\n  }, []);\n  return __jsx(React.Fragment, null);\n};\n\nexport default NoticeView;","map":{"version":3,"sources":["/Users/mac/Desktop/liy-blog/components/NoticeView.jsx"],"names":["React","useEffect","useState","NoticeIcon","axios","servicePath","Router","NoticeView","data","setData","user","setUser","checkLogin","CancelToken","source","localStorage","getItem","method","url","getUserInfo","headers","withCredentials","cancelToken","token","transformResponse","indexOf","JSON","parse","item","errors","error","removeItem","push","then","res","cancel","setIsLoading","eval","getNotification","getNoread","catch","console","log","getNotifications"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport NoticeIcon from 'ant-design-pro/lib/NoticeIcon';\nimport { Row, Col, Menu, Icon, Button, Dropdown, Avatar, message } from 'antd';\nimport axios from \"axios\";\nimport servicePath from '../config/apiUrl';\nimport Router from 'next/router'\n\nconst NoticeView = () => {\n    const [data, setData] = useState([])\n    const [user, setUser] = useState()\n    //获取会员数据\n    const checkLogin = () => {\n        const CancelToken = axios.CancelToken;\n        const source = CancelToken.source();\n        if (localStorage.getItem('token') != null) {\n            axios({\n                method: 'get',\n                url: servicePath.getUserInfo,\n                headers: {\n                    'Authorization': 'Bearer ' + localStorage.getItem('token'),\n                },\n                withCredentials: false,\n                cancelToken: source.token,\n                transformResponse: function (data) {\n                    if (data.indexOf('errors') != -1) {\n                        data = JSON.parse(data);\n                        for (var item in data.errors) {\n                            message.error(data.errors[item][0]);\n                        }\n                    } else if (data.indexOf('Unauthenticated') != -1) {\n                        localStorage.removeItem('token')\n                        Router.push('/')\n                    } else {\n                        return data;\n                    }\n                }\n            }).then(\n                res => {\n                    source.cancel('方法被取消');\n                    setIsLoading(false)\n                    res.data = eval('(' + res.data + ')');\n                    setUser(res.data.data);\n                    getNotification();\n                    getNoread()\n                }\n            ).catch(function (error) {\n                console.log(error)\n            });\n        } else {\n            console.log('asasdas3')\n        }\n    }\n\n    const getNotification = () => {\n        axios({\n            method: 'get',\n            url: servicePath.getNotifications,\n            headers: {\n                'Authorization': 'Bearer ' + localStorage.getItem('token'),\n            },\n            withCredentials: false,\n        }).then(res => {\n            console.log(res)\n            setData(res.data.data);\n        }\n        )\n    }\n\n\n\n\n\n    \n\n    useEffect(() => {\n        if (localStorage.getItem('token')) {\n            checkLogin()\n        } else {\n            Router.push('/login')\n        }\n    },[])\n\n    return (\n        <>\n            \n        </>\n    )\n}\n\nexport default NoticeView"]},"metadata":{},"sourceType":"module"}