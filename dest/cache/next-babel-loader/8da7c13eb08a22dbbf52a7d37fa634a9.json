{"ast":null,"code":"import _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _Card from \"antd/lib/card\";\nimport _Row from \"antd/lib/row\";\nimport _Col from \"antd/lib/col\";\nimport _Avatar from \"antd/lib/avatar\";\nimport _Divider from \"antd/lib/divider\";\nimport _Icon from \"antd/lib/icon\";\nimport _Tag from \"antd/lib/tag\";\nimport _Layout from \"antd/lib/layout\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport axios from \"axios\";\nimport UserCodeList from '../components/UserCodeList';\nimport UserArticleList from '../components/UserArticleList';\nimport servicePath from '../config/apiUrl';\nimport '../public/style/center.css';\nconst {\n  Content\n} = _Layout;\n\nconst Center = props => {\n  const {\n    0: token,\n    1: setToken\n  } = useState();\n  const {\n    0: user,\n    1: setUser\n  } = useState();\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState(true);\n  const {\n    0: dataLoading,\n    1: setDataLoading\n  } = useState(true);\n  const {\n    0: tabKey,\n    1: setTabKey\n  } = useState(\"articles\");\n  const {\n    0: data,\n    1: setData\n  } = useState([]);\n  const {\n    0: third,\n    1: setThird\n  } = useState();\n  const {\n    0: articleCount,\n    1: setArticleCount\n  } = useState(0);\n  const {\n    0: projectCount,\n    1: setProjectCount\n  } = useState(0);\n  const {\n    0: address,\n    1: setAddress\n  } = useState([]);\n  const {\n    0: tags,\n    1: setTags\n  } = useState([]);\n  const {\n    0: addr,\n    1: setAddr\n  } = useState();\n\n  const onTabChange = key => {\n    setTabKey(key);\n    getList(props.id, key);\n  };\n\n  const operationTabList = [{\n    key: 'articles',\n    tab: __jsx(\"span\", null, \"\\u6587\\u7AE0 \", __jsx(\"span\", {\n      style: {\n        fontSize: 14\n      }\n    }, \"(\", articleCount, \")\"))\n  }, {\n    key: 'applications',\n    tab: __jsx(\"span\", null, \"\\u6E90\\u7801 \", __jsx(\"span\", {\n      style: {\n        fontSize: 14\n      }\n    }, \"(\", projectCount, \")\"))\n  }];\n\n  const renderChildrenByTabKey = tabKey => {\n    if (tabKey === 'applications') {\n      return __jsx(UserCodeList, {\n        userId: props.id\n      });\n    }\n\n    if (tabKey === 'articles') {\n      return __jsx(UserArticleList, {\n        userId: props.id\n      });\n    }\n\n    return null;\n  }; //获取用户第三方信息\n\n\n  const getThird = id => {\n    const CancelToken = axios.CancelToken;\n    const source = CancelToken.source();\n    axios({\n      method: 'get',\n      url: servicePath.getThird + '?user_id=' + id,\n      withCredentials: false,\n      cancelToken: source.token\n    }).then(res => {\n      source.cancel('方法被取消');\n      setArticleCount(res.data.data ? res.data.data.article_count : 0);\n      setProjectCount(res.data.data ? res.data.data.project_count : 0);\n      setThird(res.data.data);\n      setTags(res.data.data.tags.split(\",\"));\n      getName(res.data.data.province_id);\n      getName(res.data.data.city_id);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }; //获取地名\n\n\n  const getName = id => {\n    axios({\n      method: 'get',\n      url: servicePath.getAddressName + '?id=' + id,\n      withCredentials: false\n    }).then(res => {\n      console.log(res);\n      let arr = address;\n\n      if (arr.indexOf(res.data.data.name) == -1) {\n        arr.push(res.data.data.name);\n      }\n\n      setAddress(arr);\n      setAddr(address.join(' '));\n    });\n  }; //获取用户的文章，源码\n\n\n  const getList = (id, tabKey) => {\n    let category_id = 1;\n\n    if (tabKey === \"articles\") {\n      category_id = 1;\n    } else {\n      category_id = 4;\n    }\n\n    console.log('tabkey', tabKey);\n    axios({\n      method: 'get',\n      url: servicePath.getUserArticle + '?user_id=' + props.id + '&category_id=' + category_id,\n      withCredentials: false\n    }).then(res => {\n      console.log(res);\n      setIsLoading(false);\n      setDataLoading(false);\n\n      for (let item in res.data.data) {\n        res.data.data[item].biaoqian = res.data.data[item].biaoqian.split(\",\");\n        res.data.data[item].labes = [];\n        res.data.data[item].href = \"/detail?id=\" + res.data.data[item].id;\n\n        for (let i = 0; i < res.data.data[item].biaoqian.length; i++) {\n          res.data.data[item].labes.push(__jsx(_Tag, {\n            key: i,\n            size: \"small\"\n          }, res.data.data[item].biaoqian[i]));\n        }\n      }\n\n      getThird(id);\n      setData(res.data.data);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  useEffect(() => {\n    if (isLoading) {\n      getList(props.id, tabKey); //getThird(props.id)\n    }\n  }, []);\n  return __jsx(Content, {\n    style: {\n      padding: '0 1rem',\n      margin: '1rem auto'\n    }\n  }, __jsx(_Row, {\n    gutter: 24\n  }, __jsx(_Col, {\n    lg: 7,\n    md: 24\n  }, __jsx(_Card, {\n    bordered: false,\n    style: {\n      marginBottom: 24\n    },\n    loading: dataLoading\n  }, !dataLoading && __jsx(\"div\", null, __jsx(\"div\", {\n    className: \"avatarHolder\"\n  }, __jsx(\"img\", {\n    alt: \"\",\n    src: props.avatar\n  }), __jsx(\"div\", {\n    className: \"name\"\n  }, props.name), __jsx(\"div\", null, props.introduction)), third && __jsx(\"div\", {\n    className: \"detail\"\n  }, __jsx(\"p\", null, __jsx(_Icon, {\n    type: \"deployment-unit\"\n  }), __jsx(\"span\", null, third.professional)), __jsx(\"p\", null, __jsx(_Icon, {\n    type: \"apartment\"\n  }), __jsx(\"span\", null, third.company)), __jsx(\"p\", null, __jsx(_Icon, {\n    type: \"environment\"\n  }), __jsx(\"span\", null, addr))), third && __jsx(_Divider, {\n    dashed: true\n  }), third && __jsx(\"div\", null, __jsx(\"div\", {\n    style: {\n      marginBottom: 12,\n      color: \"rgba(0,0,0,0.85)\"\n    }\n  }, \"\\u6807\\u7B7E\"), __jsx(\"div\", {\n    style: {\n      lineHeight: '30px'\n    }\n  }, tags && tags.map(item => __jsx(_Tag, {\n    key: item\n  }, item)))), third && __jsx(_Divider, {\n    style: {\n      marginTop: 26\n    },\n    dashed: true\n  }), third && __jsx(\"div\", {\n    className: \"team\"\n  }, __jsx(\"div\", {\n    style: {\n      marginBottom: 12,\n      color: \"rgba(0,0,0,0.85)\"\n    }\n  }, \"\\u793E\\u4EA4\\u8D26\\u53F7\"), __jsx(_Row, {\n    gutter: 36\n  }, __jsx(_Col, {\n    lg: 8,\n    xl: 8,\n    className: \"sjitem\"\n  }, __jsx(_Avatar, {\n    size: 28,\n    icon: \"github\",\n    className: \"account\"\n  }), __jsx(\"div\", {\n    className: \"mz\"\n  }, \"github\")), __jsx(_Col, {\n    lg: 8,\n    xl: 8,\n    className: \"sjitem\"\n  }, __jsx(_Avatar, {\n    size: 28,\n    icon: \"qq\",\n    className: \"account\"\n  }), __jsx(\"div\", {\n    className: \"mz\"\n  }, \"QQ\")), __jsx(_Col, {\n    lg: 8,\n    xl: 8,\n    className: \"sjitem\"\n  }, __jsx(_Avatar, {\n    size: 28,\n    icon: \"wechat\",\n    className: \"account\"\n  }), __jsx(\"div\", {\n    className: \"mz\"\n  }, \"\\u5FAE\\u4FE1\"))))))), __jsx(_Col, {\n    lg: 17,\n    md: 24\n  }, __jsx(_Card, {\n    className: \"tabsCard\",\n    bordered: false,\n    tabList: operationTabList,\n    activeTabKey: tabKey,\n    onTabChange: onTabChange\n  }, renderChildrenByTabKey(tabKey)))));\n};\n\nCenter.getInitialProps = async context => {\n  console.log('context', context);\n  let id = context.ctx.query.user_id;\n  const promise = new _Promise(resolve => {\n    axios(servicePath.getUser + id).then(res => {\n      console.log('user1', res);\n      resolve(res.data.data);\n    });\n  });\n  return await promise;\n};\n\nexport default Center;","map":{"version":3,"sources":["/Users/mac/Desktop/liy-blog/pages/center.js"],"names":["React","useState","useEffect","axios","UserCodeList","UserArticleList","servicePath","Content","Center","props","token","setToken","user","setUser","isLoading","setIsLoading","dataLoading","setDataLoading","tabKey","setTabKey","data","setData","third","setThird","articleCount","setArticleCount","projectCount","setProjectCount","address","setAddress","tags","setTags","addr","setAddr","onTabChange","key","getList","id","operationTabList","tab","fontSize","renderChildrenByTabKey","getThird","CancelToken","source","method","url","withCredentials","cancelToken","then","res","cancel","article_count","project_count","split","getName","province_id","city_id","catch","error","console","log","getAddressName","arr","indexOf","name","push","join","category_id","getUserArticle","item","biaoqian","labes","href","i","length","padding","margin","marginBottom","avatar","introduction","professional","company","color","lineHeight","map","marginTop","getInitialProps","context","ctx","query","user_id","promise","resolve","getUser"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { Avatar, Card, Col, Divider, Icon, Layout, message, Row, Tag } from 'antd';\nimport axios from \"axios\";\nimport UserCodeList from '../components/UserCodeList'\nimport UserArticleList from '../components/UserArticleList'\nimport servicePath from '../config/apiUrl';\nimport '../public/style/center.css'\n\nconst { Content } = Layout;\n\nconst Center = (props) => {\n    const [token, setToken] = useState()\n    const [user, setUser] = useState()\n    const [isLoading, setIsLoading] = useState(true)\n    const [dataLoading, setDataLoading] = useState(true)\n    const [tabKey, setTabKey] = useState(\"articles\")\n    const [data, setData] = useState([])\n    const [third, setThird] = useState()\n    const [articleCount, setArticleCount] = useState(0)\n    const [projectCount, setProjectCount] = useState(0)\n    const [address, setAddress] = useState([])\n    const [tags, setTags] = useState([])\n    const [addr, setAddr] = useState()\n    const onTabChange = (key) => {\n        setTabKey(key)\n        getList(props.id, key)\n    };\n    const operationTabList = [\n        {\n            key: 'articles',\n            tab: (\n                <span>\n                    文章 <span style={{ fontSize: 14 }}>({articleCount})</span>\n                </span>\n            ),\n        },\n        {\n            key: 'applications',\n            tab: (\n                <span>\n                    源码 <span style={{ fontSize: 14 }}>({projectCount})</span>\n                </span>\n            ),\n        }\n    ];\n\n    const renderChildrenByTabKey = (tabKey) => {\n        if (tabKey === 'applications') {\n            return <UserCodeList userId={props.id} />;\n\n        }\n        if (tabKey === 'articles') {\n            return <UserArticleList userId={props.id} />;\n        }\n        return null;\n    };\n\n    //获取用户第三方信息\n    const getThird = (id) => {\n        const CancelToken = axios.CancelToken;\n        const source = CancelToken.source();\n        axios({\n            method: 'get',\n            url: servicePath.getThird + '?user_id=' + id,\n            withCredentials: false,\n            cancelToken: source.token,\n        }).then(\n            res => {\n                source.cancel('方法被取消');\n                setArticleCount(res.data.data ? res.data.data.article_count : 0)\n\n                setProjectCount(res.data.data ? res.data.data.project_count : 0)\n\n                setThird(res.data.data)\n\n                setTags(res.data.data.tags.split(\",\"))\n\n                getName(res.data.data.province_id)\n\n                getName(res.data.data.city_id)\n            }\n        ).catch(function (error) {\n            console.log(error)\n        });\n    }\n\n    //获取地名\n    const getName = (id) => {\n        axios({\n            method: 'get',\n            url: servicePath.getAddressName + '?id=' + id,\n            withCredentials: false,\n        }).then(\n            res => {\n                console.log(res)\n                let arr = address;\n                if (arr.indexOf(res.data.data.name) == -1) {\n                    arr.push(res.data.data.name)\n                }\n\n                setAddress(arr)\n\n                setAddr(address.join(' '))\n            }\n        );\n    }\n\n    //获取用户的文章，源码\n    const getList = (id, tabKey) => {\n        let category_id = 1;\n        if (tabKey === \"articles\") {\n            category_id = 1\n        } else {\n            category_id = 4\n        }\n        console.log('tabkey', tabKey)\n        axios({\n            method: 'get',\n            url: servicePath.getUserArticle + '?user_id=' + props.id + '&category_id=' + category_id,\n            withCredentials: false,\n        }).then(\n            res => {\n                console.log(res)\n                setIsLoading(false)\n                setDataLoading(false)\n                for (let item in res.data.data) {\n                    res.data.data[item].biaoqian = res.data.data[item].biaoqian.split(\",\");\n                    res.data.data[item].labes = [];\n                    res.data.data[item].href = \"/detail?id=\" + res.data.data[item].id\n                    for (let i = 0; i < res.data.data[item].biaoqian.length; i++) {\n                        res.data.data[item].labes.push(<Tag key={i}\n                            size=\"small\">{res.data.data[item].biaoqian[i]}</Tag>)\n                    }\n                }\n\n                getThird(id)\n                setData(res.data.data)\n            }\n        ).catch(function (error) {\n            console.log(error)\n        });\n    }\n\n\n    useEffect(() => {\n        if (isLoading) {\n            getList(props.id, tabKey)\n            //getThird(props.id)\n        }\n    }, [])\n    return (\n        <Content style={{ padding: '0 1rem', margin: '1rem auto' }}>\n            <Row gutter={24}>\n                <Col lg={7} md={24}>\n                    <Card bordered={false} style={{ marginBottom: 24 }} loading={dataLoading}>\n                        {!dataLoading && (\n                            <div>\n                                <div className=\"avatarHolder\">\n                                    <img alt=\"\" src={props.avatar} />\n                                    <div className=\"name\">{props.name}</div>\n                                    <div>{props.introduction}</div>\n                                </div>\n                                {third && <div className=\"detail\">\n                                    <p>\n                                        <Icon type=\"deployment-unit\" />\n                                        <span>{third.professional}</span>\n                                    </p>\n                                    <p>\n                                        <Icon type=\"apartment\" />\n                                        <span>{third.company}</span>\n                                    </p>\n                                    <p>\n                                        <Icon type=\"environment\" />\n                                        <span>{addr}</span>\n                                    </p>\n                                </div>}\n                                {third && <Divider dashed />}\n                                {third && <div>\n                                    <div style={{ marginBottom: 12, color: \"rgba(0,0,0,0.85)\" }}>标签</div>\n                                    <div style={{ lineHeight: '30px' }}>\n                                        {tags && tags.map(item => (<Tag key={item}>{item}</Tag>))}\n                                    </div>\n                                </div>}\n\n                                {third && <Divider style={{ marginTop: 26 }} dashed />}\n                                {third && <div className=\"team\">\n                                    <div style={{ marginBottom: 12, color: \"rgba(0,0,0,0.85)\" }}>社交账号</div>\n                                    <Row gutter={36}>\n                                        <Col lg={8} xl={8} className=\"sjitem\">\n                                            <Avatar size={28} icon=\"github\" className=\"account\" />\n                                            <div className=\"mz\">github</div>\n                                        </Col>\n                                        <Col lg={8} xl={8} className=\"sjitem\">\n                                            <Avatar size={28} icon=\"qq\" className=\"account\" />\n                                            <div className=\"mz\">QQ</div>\n                                        </Col>\n                                        <Col lg={8} xl={8} className=\"sjitem\">\n                                            <Avatar size={28} icon=\"wechat\" className=\"account\" />\n                                            <div className=\"mz\">微信</div>\n                                        </Col>\n                                    </Row>\n\n                                </div>}\n                            </div>\n                        )}\n                    </Card>\n                </Col>\n                <Col lg={17} md={24}>\n                    <Card\n                        className=\"tabsCard\"\n                        bordered={false}\n                        tabList={operationTabList}\n                        activeTabKey={tabKey}\n                        onTabChange={onTabChange}>\n                        {renderChildrenByTabKey(tabKey)}\n                    </Card>\n                </Col>\n            </Row>\n        </Content>\n    )\n}\n\nCenter.getInitialProps = async (context) => {\n    console.log('context', context)\n    let id = context.ctx.query.user_id\n    const promise = new Promise((resolve) => {\n        axios(servicePath.getUser + id).then(\n            (res) => {\n                console.log('user1', res)\n                resolve(res.data.data)\n            }\n        )\n    })\n\n    return await promise\n}\n\nexport default Center"]},"metadata":{},"sourceType":"module"}