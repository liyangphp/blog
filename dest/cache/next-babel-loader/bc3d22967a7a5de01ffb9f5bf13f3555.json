{"ast":null,"code":"import _Modal from \"antd/lib/modal\";\nimport _Form from \"antd/lib/form\";\nimport _Input from \"antd/lib/input\";\nimport _List from \"antd/lib/list\";\nimport _message from \"antd/lib/message\";\nvar __jsx = React.createElement;\nimport React, { useEffect, useState } from 'react';\nimport axios from \"axios\";\nimport servicePath from '../config/apiUrl';\n\nvar Security = function Security() {\n  var _useState = useState(false),\n      visiable = _useState[0],\n      setVisiable = _useState[1];\n\n  var _useState2 = useState(),\n      origin = _useState2[0],\n      setOrigin = _useState2[1];\n\n  var _useState3 = useState(),\n      pwd = _useState3[0],\n      setPwd = _useState3[1];\n\n  var _useState4 = useState(),\n      confirmPwd = _useState4[0],\n      setConfirmPwd = _useState4[1];\n\n  var _useState5 = useState(),\n      user = _useState5[0],\n      setUser = _useState5[1];\n\n  var _useState6 = useState(true),\n      isLoading = _useState6[0],\n      setIsLoading = _useState6[1]; //获取会员数据\n\n\n  var checkLogin = function checkLogin() {\n    var CancelToken = axios.CancelToken;\n    var source = CancelToken.source();\n\n    if (localStorage.getItem('token') != null) {\n      axios({\n        method: 'get',\n        url: servicePath.getUserInfo,\n        headers: {\n          'Authorization': 'Bearer ' + localStorage.getItem('token')\n        },\n        withCredentials: false,\n        cancelToken: source.token,\n        transformResponse: function transformResponse(data) {\n          if (data.indexOf('errors') != -1) {\n            data = JSON.parse(data);\n\n            for (var item in data.errors) {\n              _message.error(data.errors[item][0]);\n            }\n          } else if (data.indexOf('Unauthenticated') != -1) {\n            localStorage.removeItem('token');\n            return data;\n          } else {\n            return data;\n          }\n        }\n      }).then(function (res) {\n        source.cancel('方法被取消');\n        setIsLoading(false);\n        res.data = eval('(' + res.data + ')');\n        setUser(res.data.data);\n      })[\"catch\"](function (error) {\n        console.log(error);\n      });\n    } else {\n      console.log('asasdas3');\n    }\n  };\n\n  var getData = function getData() {\n    return [{\n      title: '账户密码',\n      description: '修改密码需要提供原来的密码',\n      actions: [__jsx(\"a\", {\n        key: \"Modify\"\n      }, \"\\u4FEE\\u6539\")]\n    }];\n  };\n\n  var showModel = function showModel() {\n    setVisiable(true);\n  };\n\n  useEffect(function () {\n    if (isLoading) {\n      checkLogin();\n    }\n  });\n  var data = getData();\n\n  var handleCancel = function handleCancel() {\n    setVisiable(false);\n  };\n\n  var handleOk = function handleOk() {\n    var dataProps = {};\n    dataProps.origin = origin;\n    dataProps.pwd = pwd;\n    dataProps.confirm_pwd = confirmPwd;\n    dataProps.user_id = user.id;\n    axios({\n      method: 'post',\n      url: servicePath.RepairPassword,\n      headers: {\n        'Authorization': 'Bearer ' + localStorage.getItem('token')\n      },\n      data: dataProps\n    }).then(function (res) {\n      console.log(res);\n\n      _message.success(res.data.msg);\n\n      setVisiable(false);\n    });\n  };\n\n  return __jsx(\"div\", null, __jsx(_List, {\n    itemLayout: \"horizontal\",\n    dataSource: data,\n    renderItem: function renderItem(item) {\n      return __jsx(_List.Item, {\n        actions: item.actions,\n        onClick: showModel\n      }, __jsx(_List.Item.Meta, {\n        title: item.title,\n        description: item.description\n      }));\n    }\n  }), __jsx(_Modal, {\n    title: \"\\u4FEE\\u6539\\u5BC6\\u7801\",\n    visible: visiable,\n    onOk: handleOk,\n    onCancel: handleCancel\n  }, __jsx(_Form, {\n    layout: \"vertical\",\n    hideRequiredMark: true\n  }, __jsx(_Form.Item, {\n    label: \"\\u539F\\u5BC6\\u7801\"\n  }, __jsx(_Input.Password, {\n    onChange: function onChange(e) {\n      setOrigin(e.target.value);\n    },\n    value: origin,\n    placeholder: \"\\u8BF7\\u8F93\\u5165\\u539F\\u5BC6\\u7801\"\n  })), __jsx(_Form.Item, {\n    label: \"\\u65B0\\u5BC6\\u7801\"\n  }, __jsx(_Input.Password, {\n    onChange: function onChange(e) {\n      setPwd(e.target.value);\n    },\n    value: pwd,\n    placeholder: \"\\u8BF7\\u8F93\\u5165\\u65B0\\u5BC6\\u7801,\\u5BC6\\u7801\\u4E0D\\u80FD\\u5E26\\u7279\\u6B8A\\u5B57\\u7B26\"\n  })), __jsx(_Form.Item, {\n    label: \"\\u786E\\u8BA4\\u5BC6\\u7801\"\n  }, __jsx(_Input.Password, {\n    onChange: function onChange(e) {\n      setConfirmPwd(e.target.value);\n    },\n    value: confirmPwd,\n    placeholder: \"\\u8BF7\\u8F93\\u5165\\u786E\\u8BA4\\u5BC6\\u7801\"\n  })))));\n};\n\nexport default Security;","map":{"version":3,"sources":["/Users/mac/Desktop/liy-blog/components/Security.jsx"],"names":["React","useEffect","useState","axios","servicePath","Security","visiable","setVisiable","origin","setOrigin","pwd","setPwd","confirmPwd","setConfirmPwd","user","setUser","isLoading","setIsLoading","checkLogin","CancelToken","source","localStorage","getItem","method","url","getUserInfo","headers","withCredentials","cancelToken","token","transformResponse","data","indexOf","JSON","parse","item","errors","error","removeItem","then","res","cancel","eval","console","log","getData","title","description","actions","showModel","handleCancel","handleOk","dataProps","confirm_pwd","user_id","id","RepairPassword","success","msg","e","target","value"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react';\n\nimport {Form, Icon, Input, List, Modal, message} from 'antd';\nimport axios from \"axios\";\nimport servicePath from '../config/apiUrl';\n\nconst Security = () => {\n\n    const [visiable, setVisiable] = useState(false)\n    const [origin, setOrigin] = useState()\n    const [pwd, setPwd] = useState()\n    const [confirmPwd, setConfirmPwd] = useState()\n    const [user, setUser] = useState()\n    const [isLoading, setIsLoading] = useState(true)\n\n    //获取会员数据\n    const checkLogin = () => {\n        const CancelToken = axios.CancelToken;\n        const source = CancelToken.source();\n        if (localStorage.getItem('token') != null) {\n            axios({\n                method: 'get',\n                url: servicePath.getUserInfo,\n                headers: {\n                    'Authorization': 'Bearer ' + localStorage.getItem('token'),\n                },\n                withCredentials: false,\n                cancelToken: source.token,\n                transformResponse: function (data) {\n                    if (data.indexOf('errors') != -1) {\n                        data = JSON.parse(data);\n                        for (var item in data.errors) {\n                            message.error(data.errors[item][0]);\n                        }\n                    } else if (data.indexOf('Unauthenticated') != -1) {\n                        localStorage.removeItem('token')\n                        return data;\n                    } else {\n                        return data;\n                    }\n                }\n            }).then(\n                res => {\n                    source.cancel('方法被取消');\n                    setIsLoading(false)\n                    res.data = eval('(' + res.data + ')');\n                    setUser(res.data.data);\n                }\n            ).catch(function (error) {\n                console.log(error)\n            });\n        } else {\n            console.log('asasdas3')\n        }\n    }\n\n    const getData = () => [\n        {\n            title: '账户密码',\n            description: '修改密码需要提供原来的密码',\n            actions: [\n                <a key=\"Modify\">\n                    修改\n                </a>,\n            ],\n        }\n    ];\n\n    const showModel = () =>{\n        setVisiable(true)\n    }\n\n    useEffect(() => {\n        if (isLoading) {\n            checkLogin()\n        }\n    })\n\n\n\n    const data = getData();\n\n    const handleCancel = () => {\n        setVisiable(false)\n    };\n\n    const handleOk = () =>{\n        let dataProps = {}\n        dataProps.origin = origin;\n        dataProps.pwd = pwd;\n        dataProps.confirm_pwd=confirmPwd\n        dataProps.user_id =user.id\n        axios({\n            method: 'post',\n            url: servicePath.RepairPassword,\n            headers: {\n                'Authorization': 'Bearer ' + localStorage.getItem('token'),\n            },\n            data:dataProps,\n        }).then(res => {\n            console.log(res)\n            message.success(res.data.msg)\n            setVisiable(false)\n        })\n    }\n\n    return (\n        <div>\n            <List\n                itemLayout=\"horizontal\"\n                dataSource={data}\n                renderItem={item => (\n                    <List.Item actions={item.actions} onClick={showModel}>\n                        <List.Item.Meta title={item.title} description={item.description}/>\n                    </List.Item>\n                )}\n            />\n\n            <Modal\n                title=\"修改密码\"\n                visible={visiable}\n                onOk={handleOk}\n                onCancel={handleCancel}>\n                <Form layout=\"vertical\" hideRequiredMark>\n                    <Form.Item label=\"原密码\">\n                        <Input.Password onChange={(e) => {\n                            setOrigin(e.target.value)\n                        }} value={origin} placeholder=\"请输入原密码\"/>\n                    </Form.Item>\n                    <Form.Item label=\"新密码\">\n                        <Input.Password onChange={(e) => {\n                            setPwd(e.target.value)\n                        }} value={pwd} placeholder=\"请输入新密码,密码不能带特殊字符\"/>\n                    </Form.Item>\n                    <Form.Item label=\"确认密码\">\n                        <Input.Password onChange={(e) => {\n                            setConfirmPwd(e.target.value)\n                        }} value={confirmPwd}  placeholder=\"请输入确认密码\"/>\n                    </Form.Item>\n                </Form>\n            </Modal>\n        </div>\n\n    );\n}\n\nexport default Security"]},"metadata":{},"sourceType":"module"}