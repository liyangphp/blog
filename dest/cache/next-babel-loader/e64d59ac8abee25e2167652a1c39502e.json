{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _Card from \"antd/lib/card\";\nimport _Row from \"antd/lib/row\";\nimport _Col from \"antd/lib/col\";\nimport _Avatar from \"antd/lib/avatar\";\nimport _Divider from \"antd/lib/divider\";\nimport _Icon from \"antd/lib/icon\";\nimport _Tag from \"antd/lib/tag\";\nimport _message from \"antd/lib/message\";\nimport _Layout from \"antd/lib/layout\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport axios from \"axios\";\nimport CodeList from '../components/CodeList';\nimport ArticleList from '../components/ArticleList';\nimport servicePath from '../config/apiUrl';\nvar Content = _Layout.Content;\n\nvar Center = function Center(props) {\n  var _useState = useState(),\n      token = _useState[0],\n      setToken = _useState[1];\n\n  var _useState2 = useState(),\n      user = _useState2[0],\n      setUser = _useState2[1];\n\n  var _useState3 = useState(true),\n      isLoading = _useState3[0],\n      setIsLoading = _useState3[1];\n\n  var _useState4 = useState(true),\n      dataLoading = _useState4[0],\n      setDataLoading = _useState4[1];\n\n  var _useState5 = useState(\"articles\"),\n      tabKey = _useState5[0],\n      setTabKey = _useState5[1];\n\n  var _useState6 = useState([]),\n      data = _useState6[0],\n      setData = _useState6[1];\n\n  var _useState7 = useState(),\n      third = _useState7[0],\n      setThird = _useState7[1];\n\n  var _useState8 = useState(0),\n      articleCount = _useState8[0],\n      setArticleCount = _useState8[1];\n\n  var _useState9 = useState(0),\n      projectCount = _useState9[0],\n      setProjectCount = _useState9[1];\n\n  var _useState10 = useState([]),\n      address = _useState10[0],\n      setAddress = _useState10[1];\n\n  var _useState11 = useState([]),\n      tags = _useState11[0],\n      setTags = _useState11[1];\n\n  var _useState12 = useState(),\n      addr = _useState12[0],\n      setAddr = _useState12[1];\n\n  var onTabChange = function onTabChange(key) {\n    setTabKey(key);\n    getList(props.id, key);\n  };\n\n  var operationTabList = [{\n    key: 'articles',\n    tab: __jsx(\"span\", null, \"\\u6587\\u7AE0 \", __jsx(\"span\", {\n      style: {\n        fontSize: 14\n      }\n    }, \"(\", articleCount, \")\"))\n  }, {\n    key: 'applications',\n    tab: __jsx(\"span\", null, \"\\u6E90\\u7801 \", __jsx(\"span\", {\n      style: {\n        fontSize: 14\n      }\n    }, \"(\", projectCount, \")\"))\n  }];\n\n  var renderChildrenByTabKey = function renderChildrenByTabKey(tabKey) {\n    if (tabKey === 'applications') {\n      return __jsx(CodeList, {\n        list: data\n      });\n    }\n\n    if (tabKey === 'articles') {\n      return __jsx(ArticleList, {\n        list: data\n      });\n    }\n\n    return null;\n  }; //获取会员数据\n\n\n  var checkLogin = function checkLogin() {\n    var CancelToken = axios.CancelToken;\n    var source = CancelToken.source();\n\n    if (token != null) {\n      axios({\n        method: 'get',\n        url: '/api/v1/user/' + user_id,\n        withCredentials: false,\n        cancelToken: source.token,\n        transformResponse: function transformResponse(data) {\n          if (data.indexOf('errors') != -1) {\n            data = JSON.parse(data);\n\n            for (var item in data.errors) {\n              _message.error(data.errors[item][0]);\n            }\n          } else if (data.indexOf('Unauthenticated') != -1) {\n            localStorage.removeItem('token');\n            localStorage.removeItem('user_id');\n            return data;\n          } else {\n            return data;\n          }\n        }\n      }).then(function (res) {\n        source.cancel('方法被取消');\n        setIsLoading(false);\n        res.data = eval('(' + res.data + ')');\n        setDataLoading(false);\n        getList(res.data.data.id, tabKey);\n        getThird(res.data.data.id);\n      })[\"catch\"](function (error) {\n        console.log(error);\n      });\n    } else {\n      console.log('asasdas3');\n    }\n  }; //获取用户第三方信息\n\n\n  var getThird = function getThird(id) {\n    var CancelToken = axios.CancelToken;\n    var source = CancelToken.source();\n    axios({\n      method: 'get',\n      url: servicePath.getThird + '?user_id=' + id,\n      withCredentials: true,\n      headers: {\n        'Authorization': 'Bearer ' + token\n      },\n      cancelToken: source.token\n    }).then(function (res) {\n      source.cancel('方法被取消');\n      setArticleCount(res.data.data ? res.data.data.article_count : 0);\n      setProjectCount(res.data.data ? res.data.data.project_count : 0);\n      setThird(res.data.data);\n      setTags(res.data.data.tags.split(\",\"));\n      getName(res.data.data.province_id);\n      getName(res.data.data.city_id);\n    })[\"catch\"](function (error) {\n      console.log(error);\n    });\n  }; //获取地名\n\n\n  var getName = function getName(id) {\n    axios({\n      method: 'get',\n      url: '/api/v1/get/name?id=' + id,\n      withCredentials: true\n    }).then(function (res) {\n      console.log(res);\n      var arr = address;\n\n      if (arr.indexOf(res.data.data.name) == -1) {\n        arr.push(res.data.data.name);\n      }\n\n      setAddress(arr);\n      setAddr(address.join(' '));\n    });\n  }; //获取用户的文章，源码\n\n\n  var getList = function getList(id, tabKey) {\n    var category_id = 1;\n\n    if (tabKey === \"articles\") {\n      category_id = 1;\n    } else {\n      category_id = 4;\n    }\n\n    console.log('tabkey', tabKey);\n    axios({\n      method: 'get',\n      url: '/api/v1/user/article?user_id=' + props.id + '&category_id=' + category_id,\n      withCredentials: true,\n      headers: {\n        'Authorization': 'Bearer ' + localStorage.getItem('token')\n      }\n    }).then(function (res) {\n      console.log(res);\n      setIsLoading(false);\n      setDataLoading(false);\n\n      for (var item in res.data.data) {\n        res.data.data[item].biaoqian = res.data.data[item].biaoqian.split(\",\");\n        res.data.data[item].labes = [];\n        res.data.data[item].href = \"/detail?id=\" + res.data.data[item].id;\n\n        for (var i = 0; i < res.data.data[item].biaoqian.length; i++) {\n          res.data.data[item].labes.push(__jsx(_Tag, {\n            key: i,\n            size: \"small\"\n          }, res.data.data[item].biaoqian[i]));\n        }\n      }\n\n      getThird(id);\n      setData(res.data.data);\n    })[\"catch\"](function (error) {\n      console.log(error);\n    });\n  };\n\n  useEffect(function () {\n    if (isLoading) {\n      getList(props.id, tabKey); //getThird(props.id)\n    }\n  }, []);\n  return __jsx(Content, {\n    style: {\n      padding: '0 1rem',\n      margin: '1rem auto'\n    }\n  }, __jsx(_Row, {\n    gutter: 24\n  }, __jsx(_Col, {\n    lg: 7,\n    md: 24\n  }, __jsx(_Card, {\n    bordered: false,\n    style: {\n      marginBottom: 24\n    },\n    loading: dataLoading\n  }, !dataLoading && __jsx(\"div\", null, __jsx(\"div\", {\n    className: \"avatarHolder\"\n  }, __jsx(\"img\", {\n    alt: \"\",\n    src: user.avatar\n  }), __jsx(\"div\", {\n    className: \"name\"\n  }, user.name), __jsx(\"div\", null, user.introduction)), third && __jsx(\"div\", {\n    className: \"detail\"\n  }, __jsx(\"p\", null, __jsx(_Icon, {\n    type: \"deployment-unit\"\n  }), __jsx(\"span\", null, third.professional)), __jsx(\"p\", null, __jsx(_Icon, {\n    type: \"apartment\"\n  }), __jsx(\"span\", null, third.company)), __jsx(\"p\", null, __jsx(_Icon, {\n    type: \"environment\"\n  }), __jsx(\"span\", null, addr))), third && __jsx(_Divider, {\n    dashed: true\n  }), third && __jsx(\"div\", null, __jsx(\"div\", {\n    style: {\n      marginBottom: 12,\n      color: \"rgba(0,0,0,0.85)\"\n    }\n  }, \"\\u6807\\u7B7E\"), __jsx(\"div\", {\n    style: {\n      lineHeight: '30px'\n    }\n  }, tags && tags.map(function (item) {\n    return __jsx(_Tag, {\n      key: item\n    }, item);\n  }))), third && __jsx(_Divider, {\n    style: {\n      marginTop: 26\n    },\n    dashed: true\n  }), third && __jsx(\"div\", {\n    className: \"team\"\n  }, __jsx(\"div\", {\n    style: {\n      marginBottom: 12,\n      color: \"rgba(0,0,0,0.85)\"\n    }\n  }, \"\\u793E\\u4EA4\\u8D26\\u53F7\"), __jsx(_Row, {\n    gutter: 36\n  }, __jsx(_Col, {\n    lg: 8,\n    xl: 8,\n    className: \"sjitem\"\n  }, __jsx(_Avatar, {\n    size: 28,\n    icon: \"github\",\n    className: \"account\"\n  }), __jsx(\"div\", {\n    className: \"mz\"\n  }, \"github\")), __jsx(_Col, {\n    lg: 8,\n    xl: 8,\n    className: \"sjitem\"\n  }, __jsx(_Avatar, {\n    size: 28,\n    icon: \"qq\",\n    className: \"account\"\n  }), __jsx(\"div\", {\n    className: \"mz\"\n  }, \"QQ\")), __jsx(_Col, {\n    lg: 8,\n    xl: 8,\n    className: \"sjitem\"\n  }, __jsx(_Avatar, {\n    size: 28,\n    icon: \"wechat\",\n    className: \"account\"\n  }), __jsx(\"div\", {\n    className: \"mz\"\n  }, \"\\u5FAE\\u4FE1\"))))))), __jsx(_Col, {\n    lg: 17,\n    md: 24\n  }, __jsx(_Card, {\n    className: \"tabsCard\",\n    bordered: false,\n    tabList: operationTabList,\n    activeTabKey: tabKey,\n    onTabChange: onTabChange\n  }, renderChildrenByTabKey(tabKey)))));\n};\n\nCenter.getInitialProps = function _callee(context) {\n  var id, promise;\n  return _regeneratorRuntime.async(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          console.log('context', context);\n          id = context.ctx.query.user_id;\n          promise = new _Promise(function (resolve) {\n            axios(servicePath.getUser + id).then(function (res) {\n              console.log('user1', res);\n              resolve(res.data.data);\n            });\n          });\n          _context.next = 5;\n          return _regeneratorRuntime.awrap(promise);\n\n        case 5:\n          return _context.abrupt(\"return\", _context.sent);\n\n        case 6:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  });\n};\n\nexport default Center;","map":{"version":3,"sources":["/Users/mac/Desktop/liy-blog/pages/center.js"],"names":["React","useState","useEffect","axios","CodeList","ArticleList","servicePath","Content","Center","props","token","setToken","user","setUser","isLoading","setIsLoading","dataLoading","setDataLoading","tabKey","setTabKey","data","setData","third","setThird","articleCount","setArticleCount","projectCount","setProjectCount","address","setAddress","tags","setTags","addr","setAddr","onTabChange","key","getList","id","operationTabList","tab","fontSize","renderChildrenByTabKey","checkLogin","CancelToken","source","method","url","user_id","withCredentials","cancelToken","transformResponse","indexOf","JSON","parse","item","errors","error","localStorage","removeItem","then","res","cancel","eval","getThird","console","log","headers","article_count","project_count","split","getName","province_id","city_id","arr","name","push","join","category_id","getItem","biaoqian","labes","href","i","length","padding","margin","marginBottom","avatar","introduction","professional","company","color","lineHeight","map","marginTop","getInitialProps","context","ctx","query","promise","resolve","getUser"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { Avatar, Button, Card, Col, Divider, Icon, Input, Layout, message, Row, Tag } from 'antd';\nimport axios from \"axios\";\nimport CodeList from '../components/CodeList'\nimport ArticleList from '../components/ArticleList'\nimport servicePath from '../config/apiUrl';\n\nconst { Content } = Layout;\n\nconst Center = (props) => {\n    const [token, setToken] = useState()\n    const [user, setUser] = useState()\n    const [isLoading, setIsLoading] = useState(true)\n    const [dataLoading, setDataLoading] = useState(true)\n    const [tabKey, setTabKey] = useState(\"articles\")\n    const [data, setData] = useState([])\n    const [third, setThird] = useState()\n    const [articleCount, setArticleCount] = useState(0)\n    const [projectCount, setProjectCount] = useState(0)\n    const [address, setAddress] = useState([])\n    const [tags, setTags] = useState([])\n    const [addr, setAddr] = useState()\n    const onTabChange = (key) => {\n        setTabKey(key)\n        getList(props.id, key)\n    };\n    const operationTabList = [\n        {\n            key: 'articles',\n            tab: (\n                <span>\n                    文章 <span style={{ fontSize: 14 }}>({articleCount})</span>\n                </span>\n            ),\n        },\n        {\n            key: 'applications',\n            tab: (\n                <span>\n                    源码 <span style={{ fontSize: 14 }}>({projectCount})</span>\n                </span>\n            ),\n        }\n    ];\n\n    const renderChildrenByTabKey = (tabKey) => {\n        if (tabKey === 'applications') {\n            return <CodeList list={data} />;\n            \n        }\n        if (tabKey === 'articles') {\n            return <ArticleList list={data} />;\n        }\n        return null;\n    };\n    //获取会员数据\n    const checkLogin = () => {\n        const CancelToken = axios.CancelToken;\n        const source = CancelToken.source();\n        if (token != null) {\n            axios({\n                method: 'get',\n                url: '/api/v1/user/'+user_id,\n                withCredentials: false,\n                cancelToken: source.token,\n                transformResponse: function (data) {\n                    if (data.indexOf('errors') != -1) {\n                        data = JSON.parse(data);\n                        for (var item in data.errors) {\n                            message.error(data.errors[item][0]);\n                        }\n                    } else if (data.indexOf('Unauthenticated') != -1) {\n                        localStorage.removeItem('token')\n                        localStorage.removeItem('user_id')\n                        return data;\n                    } else {\n                        return data;\n                    }\n                }\n            }).then(\n                res => {\n                    source.cancel('方法被取消');\n                    setIsLoading(false)\n                    res.data = eval('(' + res.data + ')');\n                    setDataLoading(false)\n                    getList(res.data.data.id,tabKey)\n                    getThird(res.data.data.id)\n                }\n            ).catch(function (error) {\n                console.log(error)\n            });\n        } else {\n            console.log('asasdas3')\n        }\n    }\n\n    //获取用户第三方信息\n    const getThird = (id) =>{\n        const CancelToken = axios.CancelToken;\n        const source = CancelToken.source();\n        axios({\n            method: 'get',\n            url: servicePath.getThird+'?user_id='+id,\n            withCredentials: true,\n            headers: {\n                'Authorization': 'Bearer ' + token,\n            },\n            cancelToken: source.token,\n        }).then(\n            res => {\n                source.cancel('方法被取消');\n                setArticleCount(res.data.data?res.data.data.article_count:0)\n\n                setProjectCount(res.data.data?res.data.data.project_count:0)\n\n                setThird(res.data.data)\n\n                setTags(res.data.data.tags.split(\",\"))\n\n                getName(res.data.data.province_id)\n\n                getName(res.data.data.city_id)\n            }\n        ).catch(function (error) {\n            console.log(error)\n        });\n    }\n\n    //获取地名\n\n    const getName=(id) =>{\n        axios({\n            method: 'get',\n            url: '/api/v1/get/name?id=' + id,\n            withCredentials: true,\n        }).then(\n            res => {\n                console.log(res)\n                let arr=address;\n                if(arr.indexOf(res.data.data.name)==-1){\n                    arr.push(res.data.data.name)\n                }\n\n                setAddress(arr)\n\n                setAddr(address.join(' '))\n            }\n        );\n    }\n\n    //获取用户的文章，源码\n    const getList = (id,tabKey) => {\n        let category_id =1;\n        if(tabKey===\"articles\"){\n            category_id =1\n        }else{\n            category_id =4\n        }\n        console.log('tabkey',tabKey)\n        axios({\n            method: 'get',\n            url: '/api/v1/user/article?user_id=' + props.id+'&category_id='+category_id,\n            withCredentials: true,\n            headers: {\n                'Authorization': 'Bearer ' + localStorage.getItem('token'),\n            },\n        }).then(\n            res => {\n                console.log(res)\n                setIsLoading(false)\n                setDataLoading(false)\n                for (let item in res.data.data) {\n                    res.data.data[item].biaoqian = res.data.data[item].biaoqian.split(\",\");\n                    res.data.data[item].labes = [];\n                    res.data.data[item].href = \"/detail?id=\" + res.data.data[item].id\n                    for (let i = 0; i < res.data.data[item].biaoqian.length; i++) {\n                        res.data.data[item].labes.push(<Tag key={i}\n                                                            size=\"small\">{res.data.data[item].biaoqian[i]}</Tag>)\n                    }\n                }\n\n                getThird(id)\n                setData(res.data.data)\n            }\n        ).catch(function (error) {\n            console.log(error)\n        });\n    }\n\n\n    useEffect(() => {\n        if (isLoading) {\n            getList(props.id, tabKey)\n            //getThird(props.id)\n        }\n    },[])\n    return (\n        <Content style={{ padding: '0 1rem', margin:'1rem auto' }}>\n            <Row gutter={24}>\n                \n                <Col lg={7} md={24}>\n                    <Card bordered={false} style={{ marginBottom: 24 }} loading={dataLoading}>\n                        {!dataLoading && (\n                            <div>\n                                <div className=\"avatarHolder\">\n                                    <img alt=\"\" src={user.avatar} />\n                                    <div className=\"name\">{user.name}</div>\n                                    <div>{user.introduction}</div>\n                                </div>\n                                {third && <div className=\"detail\">\n                                    <p>\n                                        <Icon type=\"deployment-unit\" />\n                                        <span>{third.professional}</span>\n                                    </p>\n                                    <p>\n                                        <Icon type=\"apartment\" />\n                                        <span>{third.company}</span>\n                                    </p>\n                                    <p>\n                                        <Icon type=\"environment\" />\n                                        <span>{addr}</span>\n                                    </p>\n                                </div>}\n                                {third && <Divider dashed />}\n                                {third && <div>\n                                    <div style={{ marginBottom: 12, color: \"rgba(0,0,0,0.85)\" }}>标签</div>\n                                    <div style={{ lineHeight: '30px' }}>\n                                        {tags && tags.map(item => (<Tag key={item}>{item}</Tag>))}\n                                    </div>\n                                </div>}\n\n                                {third && <Divider style={{ marginTop: 26 }} dashed />}\n                                {third && <div className=\"team\">\n                                    <div style={{ marginBottom: 12, color: \"rgba(0,0,0,0.85)\" }}>社交账号</div>\n                                    <Row gutter={36}>\n                                        <Col lg={8} xl={8} className=\"sjitem\">\n                                            <Avatar size={28} icon=\"github\" className=\"account\" />\n                                            <div className=\"mz\">github</div>\n                                        </Col>\n                                        <Col lg={8} xl={8} className=\"sjitem\">\n                                            <Avatar size={28} icon=\"qq\" className=\"account\" />\n                                            <div className=\"mz\">QQ</div>\n                                        </Col>\n                                        <Col lg={8} xl={8} className=\"sjitem\">\n                                            <Avatar size={28} icon=\"wechat\" className=\"account\" />\n                                            <div className=\"mz\">微信</div>\n                                        </Col>\n                                    </Row>\n\n                                </div>}\n                            </div>\n                        )}\n                    </Card>\n                </Col>\n                <Col lg={17} md={24}>\n                    <Card\n                        className=\"tabsCard\"\n                        bordered={false}\n                        tabList={operationTabList}\n                        activeTabKey={tabKey}\n                        onTabChange={onTabChange}>\n                        {renderChildrenByTabKey(tabKey)}\n                    </Card>\n                </Col>\n            </Row>\n        </Content>\n    )\n}\n\nCenter.getInitialProps = async (context) => {\n    console.log('context', context)\n    let id = context.ctx.query.user_id\n    const promise = new Promise((resolve) => {\n        axios(servicePath.getUser + id).then(\n            (res) => {\n                console.log('user1',res)\n                resolve(res.data.data)\n            }\n        )\n    })\n\n    return await promise\n}\n\nexport default Center"]},"metadata":{},"sourceType":"module"}