{"ast":null,"code":"import _Button from \"antd/lib/button\";\nimport _Upload from \"antd/lib/upload\";\nimport _Icon from \"antd/lib/icon\";\nimport _Avatar from \"antd/lib/avatar\";\nimport _Form from \"antd/lib/form\";\nimport _message from \"antd/lib/message\";\nimport _Input from \"antd/lib/input\";\nvar __jsx = React.createElement;\nimport React, { useState, useContext, useEffect } from 'react';\nimport { ItemContext, ParentIdContext } from './Comments';\nconst {\n  TextArea\n} = _Input;\n\nconst Editor = ({\n  articleId\n}) => {\n  const {\n    0: submitting,\n    1: setSubmitting\n  } = useState(false);\n  const {\n    0: value,\n    1: setValue\n  } = useState('');\n  let {\n    parentId,\n    setParentId,\n    auth,\n    getcomments\n  } = useContext(ParentIdContext);\n\n  const handleChange = e => {\n    setValue(e.target.value);\n  };\n\n  const handleSubmit = () => {\n    if (!value) {\n      return;\n    }\n\n    setSubmitting(true);\n    setTimeout(() => {\n      axios({\n        method: 'post',\n        url: '/api/v1/article/' + articleId + '/replies',\n        headers: {\n          'Authorization': 'Bearer ' + localStorage.getItem('token')\n        },\n        data: {\n          parent_id: parentId,\n          rcontent: value\n        },\n        withCredentials: true\n      }).then(res => {\n        console.log(res);\n        setSubmitting(false);\n        setValue('');\n        setParentId(0);\n        getcomments();\n      }).catch(function (error) {\n        console.log(error);\n\n        _message.error(error.status);\n      });\n    }, 1000);\n  };\n\n  const handleUploadChange = ({\n    file\n  }) => {\n    let newValue = '';\n    console.log(file);\n\n    switch (file.status) {\n      case 'done':\n        _message.destroy();\n\n        _message.success('上传成功！'); // @ts-ignore\n\n\n        newValue = value + `![file](${file.response.file_path})`;\n        setValue(newValue);\n        break;\n\n      case 'error':\n        _message.destroy();\n\n        _message.error(file.response.message);\n\n        break;\n    }\n  };\n\n  useEffect(() => {});\n  return __jsx(\"div\", {\n    className: \"editor\"\n  }, __jsx(_Form.Item, null, __jsx(TextArea, {\n    rows: 4,\n    onChange: handleChange,\n    value: value\n  })), __jsx(_Form.Item, null, __jsx(\"div\", {\n    className: \"toolbar\"\n  }, __jsx(\"div\", {\n    className: \"info\"\n  }, auth ? __jsx(\"div\", null, __jsx(_Avatar, {\n    className: \"avatar\",\n    src: auth.avatar,\n    alt: auth.name,\n    icon: \"user\"\n  }), __jsx(\"div\", {\n    style: {\n      paddingLeft: 10,\n      display: 'inline-block'\n    }\n  }, auth.name)) : __jsx(\"div\", null, \"\\u60A8\\u9700\\u8981 \", __jsx(\"a\", null, \"\\u767B\\u5F55\"), \" \\u624D\\u80FD\\u53D1\\u8868\\u8BC4\\u8BBA\")), __jsx(\"div\", {\n    className: \"actionss\"\n  }, __jsx(\"div\", {\n    className: \"action\"\n  }, __jsx(_Upload, {\n    accept: \"image/*\",\n    name: \"file\",\n    className: \"upload\",\n    action: \"/api/v1/upload/image\",\n    showUploadList: false,\n    headers: {\n      Authorization: 'Bearer ' + localStorage.getItem('token')\n    },\n    onChange: handleUploadChange\n  }, __jsx(_Icon, {\n    type: \"picture\"\n  }))), __jsx(\"div\", {\n    className: \"action\"\n  }, __jsx(_Button, {\n    htmlType: \"submit\",\n    loading: submitting,\n    onClick: handleSubmit,\n    disabled: !auth,\n    type: \"primary\",\n    icon: \"message\"\n  }, \"\\u8BC4\\u8BBA\"))))));\n};\n\nexport default Editor;","map":{"version":3,"sources":["/Users/mac/Desktop/liy-blog/components/Editor.jsx"],"names":["React","useState","useContext","useEffect","ItemContext","ParentIdContext","TextArea","Editor","articleId","submitting","setSubmitting","value","setValue","parentId","setParentId","auth","getcomments","handleChange","e","target","handleSubmit","setTimeout","axios","method","url","headers","localStorage","getItem","data","parent_id","rcontent","withCredentials","then","res","console","log","catch","error","status","handleUploadChange","file","newValue","destroy","success","response","file_path","message","avatar","name","paddingLeft","display","Authorization"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from 'react'\nimport {Icon, Button, Upload, Avatar, Form, Input, message, Comment, Tooltip} from 'antd'\n\nimport {ItemContext, ParentIdContext} from './Comments'\nconst { TextArea } = Input;\n\n\n\nconst Editor = ({articleId}) => {\n    const [submitting, setSubmitting] = useState(false)\n\n    const [value, setValue] = useState('')\n    let {parentId, setParentId, auth, getcomments} = useContext(ParentIdContext)\n\n    const handleChange = e => {        \n        setValue(e.target.value)\n    };\n\n\n\n\n\n    const handleSubmit = () => {\n        if (!value) {\n            return;\n        }\n        setSubmitting(true)\n        setTimeout(() => {\n            axios({\n                method: 'post',\n                url: '/api/v1/article/' + articleId + '/replies',\n                headers: {\n                    'Authorization': 'Bearer ' + localStorage.getItem('token'),\n                },\n                data: {\n                    parent_id: parentId,\n                    rcontent: value\n                },\n                withCredentials: true,\n            }).then(\n                res => {\n                    console.log(res)\n                    setSubmitting(false)\n                    setValue('');\n                    setParentId(0)\n                    getcomments()\n                }\n            ).catch(function (error) {\n                console.log(error)\n                message.error(error.status)\n            });\n\n        }, 1000);\n    };\n\n    const handleUploadChange = ({ file }) => {\n        let newValue = '';\n        console.log(file)\n        switch (file.status) {\n            case 'done':\n                message.destroy();\n                message.success('上传成功！');\n                // @ts-ignore\n                newValue = value + `![file](${file.response.file_path})`;\n                setValue(newValue)\n                break;\n            case 'error':\n                message.destroy();\n                message.error(file.response.message);\n                break;\n        }\n    };\n\n    useEffect(() => {\n\n    })\n\n\n\n    return (\n        <div className=\"editor\">\n            <Form.Item>\n                <TextArea rows={4} onChange={handleChange} value={value} />\n            </Form.Item>\n            <Form.Item>\n                <div className=\"toolbar\">\n                    <div className=\"info\">\n                        {\n                            auth ?\n                                (\n                                    <div>\n                                        <Avatar\n                                            className=\"avatar\"\n                                            src={auth.avatar}\n                                            alt={auth.name}\n                                            icon=\"user\"\n                                        />\n                                        <div style={{ paddingLeft: 10, display: 'inline-block' }}>{auth.name}</div>\n                                    </div>\n                                ) :\n                                (\n                                    <div>您需要 <a>登录</a> 才能发表评论</div>\n                                )\n                        }\n                    </div>\n                    <div className=\"actionss\">\n                        <div className=\"action\">\n                            <Upload\n                                accept=\"image/*\"\n                                name=\"file\"\n                                className=\"upload\"\n                                action='/api/v1/upload/image'\n                                showUploadList={false}\n                                headers={{ Authorization: 'Bearer ' + localStorage.getItem('token') }}\n                                onChange={handleUploadChange}\n                            >\n                                <Icon type=\"picture\" />\n                            </Upload>\n                        </div>\n                        <div className=\"action\">\n                            <Button\n                                htmlType=\"submit\"\n                                loading={submitting}\n                                onClick={handleSubmit}\n                                disabled={!auth}\n                                type=\"primary\"\n                                icon=\"message\"\n                            >\n                                评论\n                        </Button>\n                        </div>\n                    </div>\n                </div>\n            </Form.Item>\n            </div>\n\n    )\n}\n\nexport default Editor"]},"metadata":{},"sourceType":"module"}