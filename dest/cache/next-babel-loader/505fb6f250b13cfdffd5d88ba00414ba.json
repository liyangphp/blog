{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _message from \"antd/lib/message\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from 'react';\nimport NoticeIcon from 'ant-design-pro/lib/NoticeIcon';\nimport axios from \"axios\";\nimport servicePath from '../config/apiUrl';\nimport Router from 'next/router';\n\nconst NoticeView = () => {\n  const {\n    0: data,\n    1: setData\n  } = useState([]);\n  const {\n    0: user,\n    1: setUser\n  } = useState();\n  const {\n    0: unreadCount,\n    1: setUnreadCount\n  } = useState(); //获取会员数据\n\n  const checkLogin = () => {\n    const CancelToken = axios.CancelToken;\n    const source = CancelToken.source();\n\n    if (localStorage.getItem('token') != null) {\n      axios({\n        method: 'get',\n        url: servicePath.getUserInfo,\n        headers: {\n          'Authorization': 'Bearer ' + localStorage.getItem('token')\n        },\n        withCredentials: false,\n        cancelToken: source.token,\n        transformResponse: function (data) {\n          if (data.indexOf('errors') != -1) {\n            data = JSON.parse(data);\n\n            for (var item in data.errors) {\n              _message.error(data.errors[item][0]);\n            }\n          } else if (data.indexOf('Unauthenticated') != -1) {\n            localStorage.removeItem('token');\n            Router.push('/');\n          } else {\n            return data;\n          }\n        }\n      }).then(res => {\n        source.cancel('方法被取消');\n        setIsLoading(false);\n        res.data = eval('(' + res.data + ')');\n        setUser(res.data.data);\n        getNotification();\n        getNoread();\n      }).catch(function (error) {\n        console.log(error);\n      });\n    } else {\n      console.log('asasdas3');\n    }\n  };\n\n  const getNotification = () => {\n    axios({\n      method: 'get',\n      url: servicePath.getNotifications,\n      headers: {\n        'Authorization': 'Bearer ' + localStorage.getItem('token')\n      },\n      withCredentials: false\n    }).then(res => {\n      console.log(res);\n      setData(res.data.data);\n    });\n  };\n\n  const getNoticeData = notices => {\n    if (notices.length === 0) {\n      return {};\n    }\n\n    const newNotices = notices.map(notice => {\n      const newNotice = _objectSpread({}, notice); // transform id to item key\n\n\n      if (newNotice.id) {\n        newNotice.key = newNotice.id;\n      }\n\n      if (newNotice.extra && newNotice.status) {\n        const color = {\n          todo: '',\n          processing: 'blue',\n          urgent: 'red',\n          doing: 'gold'\n        }[newNotice.status];\n        newNotice.extra = __jsx(Tag, {\n          color: color,\n          style: {\n            marginRight: 0\n          }\n        }, newNotice.extra);\n      }\n\n      return newNotice;\n    });\n    return newNotices.reduce((pre, data) => {\n      if (!pre[data.type]) {\n        pre[data.type] = [];\n      }\n\n      pre[data.type].push(data);\n      return pre;\n    }, {});\n  };\n\n  const noticeData = getNoticeData(data);\n\n  const onItemClick = (item, tabProps) => {\n    console.log('item', item);\n    axios({\n      method: 'patch',\n      url: servicePath.getNotificationStatus,\n      headers: {\n        'Authorization': 'Bearer ' + localStorage.getItem('token')\n      },\n      transformResponse: function (data) {\n        console.log('article_link', data);\n      }\n    }).catch(function (error) {\n      console.log(error);\n    });\n    Router.push(item.data['article_link']);\n  };\n\n  const getNoread = () => {\n    const CancelToken = axios.CancelToken;\n    const source = CancelToken.source();\n    axios({\n      method: 'get',\n      url: servicePath.getNotificationStatus,\n      headers: {\n        'Authorization': 'Bearer ' + localStorage.getItem('token')\n      },\n      cancelToken: source.token,\n      transformResponse: function (data) {\n        source.cancel('方法被取消');\n        data = eval('(' + data + ')');\n        console.log('123', data);\n        setUnreadCount(data.unread_count);\n      }\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  const onClear = tabTitle => {\n    axios({\n      method: 'patch',\n      url: servicePath.getNotificationStatus,\n      headers: {\n        'Authorization': 'Bearer ' + localStorage.getItem('token')\n      },\n      transformResponse: function (data) {\n        console.log(data);\n      }\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  useEffect(() => {\n    if (localStorage.getItem('token')) {\n      checkLogin();\n    } else {\n      Router.push('/login');\n    }\n  }, []);\n  return __jsx(React.Fragment, null, __jsx(NoticeIcon, {\n    className: \"notice-icon\",\n    count: unreadCount,\n    onItemClick: onItemClick,\n    onClear: onClear\n  }, __jsx(NoticeIcon.Tab, {\n    list: noticeData.message,\n    title: \"\\u901A\\u77E5\",\n    emptyText: \"\\u60A8\\u5DF2\\u8BFB\\u5B8C\\u6240\\u6709\\u6D88\\u606F\",\n    emptyImage: \"https://gw.alipayobjects.com/zos/rmsportal/sAuJeJzSKbUmHfBQRzmZ.svg\"\n  }), __jsx(NoticeIcon.Tab, {\n    list: noticeData.notification,\n    title: \"\\u79C1\\u4FE1\",\n    emptyText: \"\\u4F60\\u5DF2\\u67E5\\u770B\\u6240\\u6709\\u901A\\u77E5\",\n    emptyImage: \"https://gw.alipayobjects.com/zos/rmsportal/wAhyIChODzsoKIOBHcBk.svg\"\n  }), __jsx(NoticeIcon.Tab, {\n    list: noticeData.event,\n    title: \"\\u7CFB\\u7EDF\",\n    emptyText: \"\\u4F60\\u5DF2\\u5B8C\\u6210\\u6240\\u6709\\u5F85\\u529E\",\n    emptyImage: \"https://gw.alipayobjects.com/zos/rmsportal/HsIsxMZiWKrNUavQUXqx.svg\"\n  })));\n};\n\nexport default NoticeView;","map":{"version":3,"sources":["/Users/mac/Desktop/liy-blog/components/NoticeView.jsx"],"names":["React","useEffect","useState","NoticeIcon","axios","servicePath","Router","NoticeView","data","setData","user","setUser","unreadCount","setUnreadCount","checkLogin","CancelToken","source","localStorage","getItem","method","url","getUserInfo","headers","withCredentials","cancelToken","token","transformResponse","indexOf","JSON","parse","item","errors","error","removeItem","push","then","res","cancel","setIsLoading","eval","getNotification","getNoread","catch","console","log","getNotifications","getNoticeData","notices","length","newNotices","map","notice","newNotice","id","key","extra","status","color","todo","processing","urgent","doing","marginRight","reduce","pre","type","noticeData","onItemClick","tabProps","getNotificationStatus","unread_count","onClear","tabTitle","message","notification","event"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport NoticeIcon from 'ant-design-pro/lib/NoticeIcon';\nimport { Row, Col, Menu, Icon, Button, Dropdown, Avatar, message } from 'antd';\nimport axios from \"axios\";\nimport servicePath from '../config/apiUrl';\nimport Router from 'next/router'\n\nconst NoticeView = () => {\n    const [data, setData] = useState([])\n    const [user, setUser] = useState()\n    const [unreadCount, setUnreadCount] = useState()\n    //获取会员数据\n    const checkLogin = () => {\n        const CancelToken = axios.CancelToken;\n        const source = CancelToken.source();\n        if (localStorage.getItem('token') != null) {\n            axios({\n                method: 'get',\n                url: servicePath.getUserInfo,\n                headers: {\n                    'Authorization': 'Bearer ' + localStorage.getItem('token'),\n                },\n                withCredentials: false,\n                cancelToken: source.token,\n                transformResponse: function (data) {\n                    if (data.indexOf('errors') != -1) {\n                        data = JSON.parse(data);\n                        for (var item in data.errors) {\n                            message.error(data.errors[item][0]);\n                        }\n                    } else if (data.indexOf('Unauthenticated') != -1) {\n                        localStorage.removeItem('token')\n                        Router.push('/')\n                    } else {\n                        return data;\n                    }\n                }\n            }).then(\n                res => {\n                    source.cancel('方法被取消');\n                    setIsLoading(false)\n                    res.data = eval('(' + res.data + ')');\n                    setUser(res.data.data);\n                    getNotification();\n                    getNoread()\n                }\n            ).catch(function (error) {\n                console.log(error)\n            });\n        } else {\n            console.log('asasdas3')\n        }\n    }\n\n    const getNotification = () => {\n        axios({\n            method: 'get',\n            url: servicePath.getNotifications,\n            headers: {\n                'Authorization': 'Bearer ' + localStorage.getItem('token'),\n            },\n            withCredentials: false,\n        }).then(res => {\n            console.log(res)\n            setData(res.data.data);\n        }\n        )\n    }\n\n    const getNoticeData = (notices) => {\n        if (notices.length === 0) {\n            return {};\n        }\n        const newNotices = notices.map(notice => {\n            const newNotice = { ...notice };\n            // transform id to item key\n            if (newNotice.id) {\n                newNotice.key = newNotice.id;\n            }\n            if (newNotice.extra && newNotice.status) {\n                const color = {\n                    todo: '',\n                    processing: 'blue',\n                    urgent: 'red',\n                    doing: 'gold',\n                }[newNotice.status];\n                newNotice.extra = (\n                    <Tag color={color} style={{ marginRight: 0 }}>\n                        {newNotice.extra}\n                    </Tag>\n                );\n            }\n            return newNotice;\n        });\n        return newNotices.reduce((pre, data) => {\n            if (!pre[data.type]) {\n                pre[data.type] = [];\n            }\n            pre[data.type].push(data);\n            return pre;\n        }, {});\n    }\n\n    const noticeData = getNoticeData(data);\n\n    const onItemClick = (item, tabProps) => {\n        console.log('item', item)\n        axios({\n            method: 'patch',\n            url: servicePath.getNotificationStatus,\n            headers: {\n                'Authorization': 'Bearer ' + localStorage.getItem('token'),\n            },\n            transformResponse: function (data) {\n                console.log('article_link', data)\n            }\n        }).catch(function (error) {\n            console.log(error)\n        });\n        Router.push(item.data['article_link']);\n    }\n\n    const getNoread = () => {\n        const CancelToken = axios.CancelToken;\n        const source = CancelToken.source();\n        axios({\n            method: 'get',\n            url: servicePath.getNotificationStatus,\n            headers: {\n                'Authorization': 'Bearer ' + localStorage.getItem('token'),\n            },\n            cancelToken: source.token,\n            transformResponse: function (data) {\n                source.cancel('方法被取消');\n                data = eval('(' + data + ')');\n                console.log('123', data)\n                setUnreadCount(data.unread_count)\n            }\n        }).catch(function (error) {\n            console.log(error)\n        });\n    }\n\n    const onClear = (tabTitle) => {\n        axios({\n            method: 'patch',\n            url: servicePath.getNotificationStatus,\n            headers: {\n                'Authorization': 'Bearer ' + localStorage.getItem('token'),\n            },\n            transformResponse: function (data) {\n                console.log(data)\n            }\n        }).catch(function (error) {\n            console.log(error)\n        });\n    }\n\n    useEffect(() => {\n        if (localStorage.getItem('token')) {\n            checkLogin()\n        } else {\n            Router.push('/login')\n        }\n    },[])\n\n    return (\n        <>\n            <NoticeIcon className=\"notice-icon\" count={unreadCount} onItemClick={onItemClick} onClear={onClear}>\n                <NoticeIcon.Tab\n                    list={noticeData.message}\n                    title=\"通知\"\n                    emptyText=\"您已读完所有消息\"\n                    emptyImage=\"https://gw.alipayobjects.com/zos/rmsportal/sAuJeJzSKbUmHfBQRzmZ.svg\"\n                />\n                <NoticeIcon.Tab\n                    list={noticeData.notification}\n                    title=\"私信\"\n                    emptyText=\"你已查看所有通知\"\n                    emptyImage=\"https://gw.alipayobjects.com/zos/rmsportal/wAhyIChODzsoKIOBHcBk.svg\"\n                />\n                <NoticeIcon.Tab\n                    list={noticeData.event}\n                    title=\"系统\"\n                    emptyText=\"你已完成所有待办\"\n                    emptyImage=\"https://gw.alipayobjects.com/zos/rmsportal/HsIsxMZiWKrNUavQUXqx.svg\"\n                />\n            </NoticeIcon>\n        </>\n    )\n}\n\nexport default NoticeView"]},"metadata":{},"sourceType":"module"}