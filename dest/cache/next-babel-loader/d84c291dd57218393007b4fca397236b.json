{"ast":null,"code":"import _List from \"antd/lib/list\";\nimport _Icon from \"antd/lib/icon\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport Router from 'next/router';\nimport { withRouter } from 'next/router';\nimport servicePath from '../config/apiUrl';\nimport { ArticleData } from '../components/ArticleHook';\n\nvar ArticleList = function ArticleList(_ref) {\n  var keywords = _ref.keywords,\n      labels = _ref.labels;\n\n  var _useState = useState([]),\n      listData = _useState[0],\n      setListData = _useState[1];\n\n  var _useState2 = useState(1),\n      page = _useState2[0],\n      setPage = _useState2[1];\n\n  var _useState3 = useState(9),\n      pageSize = _useState3[0],\n      setPageSize = _useState3[1];\n\n  var _useState4 = useState(0),\n      total = _useState4[0],\n      setTotal = _useState4[1];\n\n  var _useState5 = useState(true),\n      dataLoading = _useState5[0],\n      setDataLoading = _useState5[1];\n\n  ArticleData(page, pageSize, keywords, labels, category_id);\n\n  var getArticles = function getArticles(page) {\n    var CancelToken = axios.CancelToken;\n    var source = CancelToken.source();\n    var dataProps = '?category_id=1';\n    dataProps += '&pageSize=' + pageSize;\n    dataProps += '&page=' + page;\n    console.log('label', labels);\n\n    if (keywords != '') {\n      dataProps += '&p=' + keywords;\n    }\n\n    if (labels != null) {\n      console.log('234', labels);\n      var str = '';\n\n      for (var i = 0; i < labels.length; i++) {\n        str += labels[i];\n      }\n\n      dataProps += '&p=' + str;\n    }\n\n    axios({\n      method: 'get',\n      url: servicePath.getArticleList + dataProps,\n      cancelToken: source.token\n    }).then(function (res) {\n      setDataLoading(false);\n      source.cancel('方法被取消');\n\n      for (var item in res.data.data) {\n        res.data.data[item].biaoqian = res.data.data[item].biaoqian.split(\",\");\n        res.data.data[item].labes = res.data.data[item].biaoqian[0];\n        res.data.data[item].href = \"/detail?id=\" + res.data.data[item].id;\n      }\n\n      setListData(res.data.data);\n      setTotal(res.data.meta.total);\n    })[\"catch\"](function (error) {\n      console.log(error);\n    });\n  };\n\n  var IconText = function IconText(_ref2) {\n    var type = _ref2.type,\n        text = _ref2.text;\n    return __jsx(\"span\", null, __jsx(_Icon, {\n      type: type,\n      style: {\n        marginRight: 8\n      }\n    }), text);\n  };\n\n  useEffect(function () {\n    if (dataLoading) {\n      getArticles(page);\n    }\n  }, []);\n  return __jsx(_List, {\n    className: \"list\",\n    loading: dataLoading,\n    itemLayout: \"vertical\",\n    size: \"large\",\n    pagination: {\n      onChange: function onChange(page) {\n        setPage(page);\n        getArticles(page);\n      },\n      pageSize: pageSize,\n      total: total\n    },\n    dataSource: listData,\n    renderItem: function renderItem(item) {\n      return __jsx(_List.Item, {\n        className: \"list-item1\",\n        onClick: function onClick() {\n          Router.push({\n            pathname: '/detail',\n            query: {\n              id: item.id\n            }\n          }, '/detail/' + item.id);\n        },\n        key: item.title,\n        actions: [__jsx(IconText, {\n          type: \"fire\",\n          text: item.watches,\n          key: \"list-vertical-fire\"\n        }), __jsx(IconText, {\n          type: \"like-o\",\n          text: item.stars,\n          key: \"list-vertical-like-o\"\n        }), __jsx(IconText, {\n          type: \"message\",\n          text: item.replies.length,\n          key: \"list-vertical-message\"\n        })],\n        extra: __jsx(\"img\", {\n          className: \"img\",\n          alt: item.title,\n          src: item.fmt\n        })\n      }, __jsx(_List.Item.Meta, {\n        style: {\n          marginTop: 42\n        },\n        title: __jsx(\"a\", null, item.title),\n        description: __jsx(\"div\", {\n          className: \"remark\"\n        }, __jsx(\"img\", {\n          className: \"avatar\",\n          style: {\n            borderRadius: '50%'\n          },\n          src: item.user.avatar\n        }), __jsx(\"div\", {\n          className: \"member\"\n        }, item.user.name), __jsx(\"div\", {\n          className: \"title\"\n        }, \"\\u53D1\\u5E03\\u65F6\\u95F4\"), __jsx(\"div\", {\n          className: \"time\"\n        }, item.created_at))\n      }), __jsx(\"div\", {\n        className: \"classifybox\"\n      }, __jsx(\"div\", {\n        className: \"classify\"\n      }, item.labes)), __jsx(\"div\", {\n        className: \"neirong\"\n      }, item.content));\n    }\n  });\n};\n\nexport default withRouter(ArticleList);","map":{"version":3,"sources":["/Users/mac/Desktop/liy-blog/components/ArticleList.jsx"],"names":["React","useState","useEffect","axios","Router","withRouter","servicePath","ArticleData","ArticleList","keywords","labels","listData","setListData","page","setPage","pageSize","setPageSize","total","setTotal","dataLoading","setDataLoading","category_id","getArticles","CancelToken","source","dataProps","console","log","str","i","length","method","url","getArticleList","cancelToken","token","then","res","cancel","item","data","biaoqian","split","labes","href","id","meta","error","IconText","type","text","marginRight","onChange","push","pathname","query","title","watches","stars","replies","fmt","marginTop","borderRadius","user","avatar","name","created_at","content"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport axios from 'axios'\nimport { List, Icon } from 'antd'\nimport Router from 'next/router'\nimport { withRouter} from 'next/router'\nimport servicePath from '../config/apiUrl';\n\nimport {ArticleData} from '../components/ArticleHook'\nconst ArticleList = ({keywords,labels}) => {\n    const [listData, setListData ]= useState([]);\n    const [page, setPage] = useState(1)\n    const [pageSize, setPageSize] = useState(9)\n    const [total, setTotal] = useState(0)\n    const [dataLoading, setDataLoading] = useState(true)\n    ArticleData (page, pageSize, keywords, labels, category_id)\n    const getArticles = (page) => {\n        const CancelToken = axios.CancelToken;\n        const source = CancelToken.source();\n        let dataProps='?category_id=1';\n        dataProps+='&pageSize='+pageSize;\n        dataProps+='&page='+page;\n        console.log('label',labels)\n        if(keywords!=''){\n            dataProps+='&p='+keywords\n        }\n\n        if(labels != null){\n            console.log('234',labels)\n            let str='';\n            for(let i=0;i<labels.length;i++){\n                str+=labels[i]\n            }\n            dataProps+='&p='+str\n        }\n\n        axios({\n            method: 'get',\n            url: servicePath.getArticleList+dataProps,\n            cancelToken: source.token,\n        }).then(\n            res => {\n                setDataLoading(false)\n                source.cancel('方法被取消');\n                for(let item in res.data.data){\n                    res.data.data[item].biaoqian=res.data.data[item].biaoqian.split(\",\");\n                    res.data.data[item].labes = res.data.data[item].biaoqian[0];\n                    res.data.data[item].href=\"/detail?id=\"+res.data.data[item].id\n                }\n                setListData(res.data.data)\n                setTotal(res.data.meta.total)\n            }\n        ).catch(function (error) {\n            console.log(error)\n        });\n    }\n\n\n\n    const IconText = ({ type, text }) => (\n        <span>\n            <Icon type={type} style={{ marginRight: 8 }} />\n            {text}\n        </span>\n    );\n\n    useEffect(() => {\n        if (dataLoading) {\n            getArticles(page)\n        }\n    },[])\n\n    return (\n        <List className=\"list\"\n            loading = {dataLoading}\n            itemLayout=\"vertical\"\n            size=\"large\"\n            pagination={{\n                onChange: page => {\n                    setPage(page)\n                    getArticles(page)\n                },\n                pageSize: pageSize,\n                total: total\n            }}\n            dataSource={listData}\n            renderItem={item => (\n                <List.Item className=\"list-item1\" onClick={() => { Router.push({pathname:'/detail',query:{id:item.id},},'/detail/'+item.id)  }} \n                    key={item.title}\n                    actions={[\n                        <IconText type=\"fire\" text={item.watches} key=\"list-vertical-fire\" />,\n                        <IconText type=\"like-o\" text={item.stars} key=\"list-vertical-like-o\" />,\n                        <IconText type=\"message\" text={item.replies.length} key=\"list-vertical-message\" />,\n                    ]}\n                    extra={\n                        <img\n                            className=\"img\"\n                            alt={item.title}\n                            src={item.fmt}\n                        />\n                    }\n                >\n                    <List.Item.Meta style={{ marginTop: 42 }}\n                        title={<a>{item.title}</a>}\n                        description={<div className=\"remark\">\n                            <img className=\"avatar\" style={{ borderRadius: '50%' }} src={item.user.avatar} />\n                            <div className=\"member\">{item.user.name}</div>\n                            <div className=\"title\">发布时间</div>\n                            <div className=\"time\">{item.created_at}</div>\n                        </div>}\n                    />\n                    <div className=\"classifybox\">\n                        <div className=\"classify\">{item.labes}</div>\n                    </div>\n\n\n                    <div className=\"neirong\">\n                        {item.content}\n                    </div>\n\n                </List.Item>\n            )}\n        />\n    )\n}\n\nexport default withRouter(ArticleList)"]},"metadata":{},"sourceType":"module"}