{"version":3,"sources":["../src/dropdown_item.js"],"names":["CLASS_NAME","ACTIVE_CLASS_NAME","CALLBACK_METHODS","DropdownItem","searchResult","active","forEach","method","bind","el","removeEventListener","onClick","onMouseover","_el","dropdown","siblings","items","index","length","activeItem","getActiveItem","deactivate","className","e","preventDefault","select","_","activate","li","document","createElement","a","innerHTML","render","appendChild","addEventListener","nextIndex","rotate"],"mappings":"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","file":"dropdown_item.js","sourcesContent":["// @flow\n\nimport Dropdown from './dropdown';\nimport SearchResult from './search_result';\n\nexport const CLASS_NAME = 'textcomplete-item';\nconst ACTIVE_CLASS_NAME = `${CLASS_NAME} active`;\nconst CALLBACK_METHODS = ['onClick', 'onMouseover'];\n\n/**\n * Encapsulate an item of dropdown.\n */\nexport default class DropdownItem {\n  searchResult: SearchResult;\n  active: boolean;\n  siblings: DropdownItem[];\n  dropdown: Dropdown;\n  index: number;\n  _el: ?HTMLLIElement;\n\n  constructor(searchResult: SearchResult) {\n    this.searchResult = searchResult;\n    this.active = false;\n\n    CALLBACK_METHODS.forEach((method) => {\n      (this: any)[method] = (this: any)[method].bind(this);\n    });\n  }\n\n  get el(): HTMLLIElement {\n    if (this._el) {\n      return this._el;\n    }\n    const li = document.createElement('li');\n    li.className = this.active ? ACTIVE_CLASS_NAME : CLASS_NAME;\n    const a = document.createElement('a');\n    a.innerHTML = this.searchResult.render();\n    li.appendChild(a);\n    this._el = li;\n    li.addEventListener('mousedown', this.onClick);\n    li.addEventListener('mouseover', this.onMouseover);\n    li.addEventListener('touchstart', this.onClick);\n    return li;\n  }\n\n  /**\n   * Try to free resources and perform other cleanup operations.\n   */\n  destroy() {\n    this.el.removeEventListener('mousedown', this.onClick, false);\n    this.el.removeEventListener('mouseover', this.onMouseover, false);\n    this.el.removeEventListener('touchstart', this.onClick, false);\n    // This element has already been removed by {@link Dropdown#clear}.\n    this._el = null;\n  }\n\n  /**\n   * Callbacked when it is appended to a dropdown.\n   *\n   * @see Dropdown#append\n   */\n  appended(dropdown: Dropdown) {\n    this.dropdown = dropdown;\n    this.siblings = dropdown.items;\n    this.index = this.siblings.length - 1;\n  }\n\n  /**\n   * Deactivate active item then activate itself.\n   *\n   * @return {this}\n   */\n  activate() {\n    if (!this.active) {\n      const activeItem = this.dropdown.getActiveItem();\n      if (activeItem) {\n        activeItem.deactivate();\n      }\n      this.active = true;\n      this.el.className = ACTIVE_CLASS_NAME;\n    }\n    return this;\n  }\n\n  /**\n   * Get the next sibling.\n   */\n  get next(): ?DropdownItem {\n    let nextIndex;\n    if (this.index === this.siblings.length - 1) {\n      if (!this.dropdown.rotate) {\n        return null;\n      }\n      nextIndex = 0;\n    } else {\n      nextIndex = this.index + 1;\n    }\n    return this.siblings[nextIndex];\n  }\n\n  /**\n   * Get the previous sibling.\n   */\n  get prev(): ?DropdownItem {\n    let nextIndex;\n    if (this.index === 0) {\n      if (!this.dropdown.rotate) {\n        return null;\n      }\n      nextIndex = this.siblings.length - 1;\n    } else {\n      nextIndex = this.index - 1;\n    }\n    return this.siblings[nextIndex];\n  }\n\n  /** @private */\n  deactivate() {\n    if (this.active) {\n      this.active = false;\n      this.el.className = CLASS_NAME;\n    }\n    return this;\n  }\n\n  /** @private */\n  onClick(e: Event) {\n    e.preventDefault(); // Prevent blur event\n    this.dropdown.select(this);\n  }\n\n  /** @private */\n  onMouseover(_: MouseEvent) {\n    this.activate();\n  }\n}\n"]}